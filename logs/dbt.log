2021-11-25 11:08:26.248307 (MainThread): Running with dbt=0.21.0
2021-11-25 11:08:26.303315 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-25 11:08:26.305025 (MainThread): Tracking: tracking
2021-11-25 11:08:26.326980 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823ac27160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823ac352e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823ac2f220>]}
2021-11-25 11:08:26.336262 (MainThread): Partial parsing not enabled
2021-11-25 11:08:26.345487 (MainThread): Parsing macros/catalog.sql
2021-11-25 11:08:26.348482 (MainThread): Parsing macros/relations.sql
2021-11-25 11:08:26.349582 (MainThread): Parsing macros/adapters.sql
2021-11-25 11:08:26.366142 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-25 11:08:26.367312 (MainThread): Parsing macros/core.sql
2021-11-25 11:08:26.369872 (MainThread): Parsing macros/materializations/test.sql
2021-11-25 11:08:26.374738 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-25 11:08:26.381519 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-25 11:08:26.382675 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-25 11:08:26.394720 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-25 11:08:26.421607 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-25 11:08:26.438422 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-25 11:08:26.439614 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-25 11:08:26.447058 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-25 11:08:26.462415 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-25 11:08:26.472810 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-25 11:08:26.478755 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-25 11:08:26.484235 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-25 11:08:26.486863 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-25 11:08:26.487842 (MainThread): Parsing macros/etc/query.sql
2021-11-25 11:08:26.488469 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-25 11:08:26.489500 (MainThread): Parsing macros/etc/datetime.sql
2021-11-25 11:08:26.495549 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-25 11:08:26.496727 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-25 11:08:26.498346 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-25 11:08:26.499386 (MainThread): Parsing macros/adapters/common.sql
2021-11-25 11:08:26.540507 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-25 11:08:26.541634 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-25 11:08:26.542398 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-25 11:08:26.543269 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-25 11:08:26.656296 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-25 11:08:26.664648 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-25 11:08:26.694803 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ae43903-50ac-40df-b8c5-ebdeef40fd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8228017850>]}
2021-11-25 11:08:26.698649 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ae43903-50ac-40df-b8c5-ebdeef40fd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823ad50550>]}
2021-11-25 11:08:26.698881 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-25 11:08:26.699784 (MainThread): 
2021-11-25 11:08:26.700012 (MainThread): Acquiring new postgres connection "master".
2021-11-25 11:08:26.700726 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-25 11:08:26.707785 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-25 11:08:26.707966 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-25 11:08:26.708069 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-25 11:08:26.733618 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.03 seconds
2021-11-25 11:08:26.735123 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-25 11:08:26.735877 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-25 11:08:26.740173 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-25 11:08:26.740437 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-25 11:08:26.740541 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-25 11:08:26.749820 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-25 11:08:26.750016 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-25 11:08:26.750113 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-25 11:08:26.765534 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-11-25 11:08:26.766421 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-25 11:08:26.766666 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-25 11:08:26.769848 (MainThread): Using postgres connection "master".
2021-11-25 11:08:26.769971 (MainThread): On master: BEGIN
2021-11-25 11:08:26.770077 (MainThread): Opening a new connection, currently in state init
2021-11-25 11:08:26.774173 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-25 11:08:26.774297 (MainThread): Using postgres connection "master".
2021-11-25 11:08:26.774389 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-25 11:08:26.784343 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-11-25 11:08:26.785186 (MainThread): On master: ROLLBACK
2021-11-25 11:08:26.785577 (MainThread): Using postgres connection "master".
2021-11-25 11:08:26.785686 (MainThread): On master: BEGIN
2021-11-25 11:08:26.786153 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-25 11:08:26.786274 (MainThread): On master: COMMIT
2021-11-25 11:08:26.786375 (MainThread): Using postgres connection "master".
2021-11-25 11:08:26.786469 (MainThread): On master: COMMIT
2021-11-25 11:08:26.786738 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-25 11:08:26.786852 (MainThread): On master: Close
2021-11-25 11:08:26.787080 (MainThread): 12:08:26 | Concurrency: 10 threads (target='dev')
2021-11-25 11:08:26.787214 (MainThread): 12:08:26 | 
2021-11-25 11:08:26.790729 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-25 11:08:26.791023 (Thread-1): 12:08:26 | 1 of 2 START table model public.my_first_dbt_model................... [RUN]
2021-11-25 11:08:26.791290 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-25 11:08:26.791422 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-25 11:08:26.793793 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-25 11:08:26.794577 (Thread-1): finished collecting timing info
2021-11-25 11:08:26.813128 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-25 11:08:26.813683 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-25 11:08:26.813781 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-25 11:08:26.813870 (Thread-1): Opening a new connection, currently in state closed
2021-11-25 11:08:26.818201 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-25 11:08:26.818299 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-25 11:08:26.818382 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-25 11:08:26.837437 (Thread-1): SQL status: SELECT 2 in 0.02 seconds
2021-11-25 11:08:26.842265 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-25 11:08:26.842428 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-25 11:08:26.843529 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-25 11:08:26.851054 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-25 11:08:26.851177 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-25 11:08:26.851269 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-25 11:08:26.852494 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-25 11:08:26.855480 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-25 11:08:26.855592 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-25 11:08:26.856182 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-25 11:08:26.856959 (Thread-1): finished collecting timing info
2021-11-25 11:08:26.857089 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-25 11:08:26.857363 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae43903-50ac-40df-b8c5-ebdeef40fd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823ad98430>]}
2021-11-25 11:08:26.857605 (Thread-1): 12:08:26 | 1 of 2 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2021-11-25 11:08:26.857722 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-25 11:08:26.858142 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-11-25 11:08:26.858352 (Thread-3): 12:08:26 | 2 of 2 START view model public.my_second_dbt_model................... [RUN]
2021-11-25 11:08:26.858550 (Thread-3): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-25 11:08:26.858650 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-11-25 11:08:26.860129 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-25 11:08:26.860443 (Thread-3): finished collecting timing info
2021-11-25 11:08:26.872693 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-25 11:08:26.873173 (Thread-3): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-25 11:08:26.873274 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-25 11:08:26.873364 (Thread-3): Opening a new connection, currently in state init
2021-11-25 11:08:26.882141 (Thread-3): SQL status: BEGIN in 0.01 seconds
2021-11-25 11:08:26.882291 (Thread-3): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-25 11:08:26.882377 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-25 11:08:26.890318 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-25 11:08:26.891752 (Thread-3): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-25 11:08:26.891852 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-25 11:08:26.893716 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-25 11:08:26.894319 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-25 11:08:26.894411 (Thread-3): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-25 11:08:26.894489 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-25 11:08:26.895080 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-25 11:08:26.895883 (Thread-3): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-25 11:08:26.895974 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-25 11:08:26.896213 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-25 11:08:26.896789 (Thread-3): finished collecting timing info
2021-11-25 11:08:26.896899 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-11-25 11:08:26.897124 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae43903-50ac-40df-b8c5-ebdeef40fd91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823adb5d60>]}
2021-11-25 11:08:26.897335 (Thread-3): 12:08:26 | 2 of 2 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.04s]
2021-11-25 11:08:26.897440 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-25 11:08:26.898214 (MainThread): Acquiring new postgres connection "master".
2021-11-25 11:08:26.898330 (MainThread): Using postgres connection "master".
2021-11-25 11:08:26.898414 (MainThread): On master: BEGIN
2021-11-25 11:08:26.898498 (MainThread): Opening a new connection, currently in state closed
2021-11-25 11:08:26.902930 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-25 11:08:26.903042 (MainThread): On master: COMMIT
2021-11-25 11:08:26.903124 (MainThread): Using postgres connection "master".
2021-11-25 11:08:26.903201 (MainThread): On master: COMMIT
2021-11-25 11:08:26.903368 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-25 11:08:26.903467 (MainThread): On master: Close
2021-11-25 11:08:26.903668 (MainThread): 12:08:26 | 
2021-11-25 11:08:26.903774 (MainThread): 12:08:26 | Finished running 1 table model, 1 view model in 0.20s.
2021-11-25 11:08:26.903871 (MainThread): Connection 'master' was properly closed.
2021-11-25 11:08:26.903954 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-25 11:08:26.904034 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-25 11:08:26.907102 (MainThread): 
2021-11-25 11:08:26.907345 (MainThread): Completed successfully
2021-11-25 11:08:26.907451 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-25 11:08:26.907663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8228079fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822807fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f823ada3d60>]}
2021-11-25 11:08:26.907919 (MainThread): Flushing usage events
2021-11-26 09:50:00.734713 (MainThread): Running with dbt=0.21.0
2021-11-26 09:50:00.859145 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 09:50:00.861540 (MainThread): Tracking: tracking
2021-11-26 09:50:00.897256 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aac9fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a81adac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aaca6a90>]}
2021-11-26 09:50:00.906282 (MainThread): Partial parsing not enabled
2021-11-26 09:50:00.915739 (MainThread): Parsing macros/catalog.sql
2021-11-26 09:50:00.918777 (MainThread): Parsing macros/relations.sql
2021-11-26 09:50:00.919817 (MainThread): Parsing macros/adapters.sql
2021-11-26 09:50:00.936195 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 09:50:00.937356 (MainThread): Parsing macros/core.sql
2021-11-26 09:50:00.939918 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 09:50:00.944784 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 09:50:00.951544 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 09:50:00.952692 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 09:50:00.964733 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 09:50:00.990946 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 09:50:01.007617 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 09:50:01.008798 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 09:50:01.016235 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 09:50:01.031313 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 09:50:01.041646 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 09:50:01.047579 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 09:50:01.053081 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 09:50:01.055692 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 09:50:01.056675 (MainThread): Parsing macros/etc/query.sql
2021-11-26 09:50:01.057295 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 09:50:01.058324 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 09:50:01.064401 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 09:50:01.065574 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 09:50:01.067206 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 09:50:01.068248 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 09:50:01.109247 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 09:50:01.110358 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 09:50:01.111116 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 09:50:01.111982 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 09:50:01.227597 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:50:01.235444 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:50:01.237702 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 09:50:01.268369 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac71fb7c-5404-48f7-acda-7f591a6da391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0986e9c10>]}
2021-11-26 09:50:01.271225 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac71fb7c-5404-48f7-acda-7f591a6da391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aad7b400>]}
2021-11-26 09:50:01.271395 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 09:50:01.272195 (MainThread): 
2021-11-26 09:50:01.272395 (MainThread): Acquiring new postgres connection "master".
2021-11-26 09:50:01.273063 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 09:50:01.279765 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 09:50:01.279965 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 09:50:01.280063 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 09:50:01.411207 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.13 seconds
2021-11-26 09:50:01.413387 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 09:50:01.414455 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 09:50:01.419753 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 09:50:01.419897 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 09:50:01.420018 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 09:50:01.426077 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 09:50:01.426209 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 09:50:01.426312 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 09:50:01.442565 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.02 seconds
2021-11-26 09:50:01.443676 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 09:50:01.444316 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 09:50:01.449007 (MainThread): Using postgres connection "master".
2021-11-26 09:50:01.449193 (MainThread): On master: BEGIN
2021-11-26 09:50:01.449346 (MainThread): Opening a new connection, currently in state init
2021-11-26 09:50:01.454763 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 09:50:01.454921 (MainThread): Using postgres connection "master".
2021-11-26 09:50:01.455044 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 09:50:01.483141 (MainThread): SQL status: SELECT 1 in 0.03 seconds
2021-11-26 09:50:01.484531 (MainThread): On master: ROLLBACK
2021-11-26 09:50:01.485073 (MainThread): Using postgres connection "master".
2021-11-26 09:50:01.485230 (MainThread): On master: BEGIN
2021-11-26 09:50:01.485845 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:50:01.486005 (MainThread): On master: COMMIT
2021-11-26 09:50:01.486150 (MainThread): Using postgres connection "master".
2021-11-26 09:50:01.486281 (MainThread): On master: COMMIT
2021-11-26 09:50:01.486672 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 09:50:01.486833 (MainThread): On master: Close
2021-11-26 09:50:01.487171 (MainThread): 10:50:01 | Concurrency: 10 threads (target='dev')
2021-11-26 09:50:01.487358 (MainThread): 10:50:01 | 
2021-11-26 09:50:01.490975 (Thread-1): Began running node model.demo_dbt.dim_customers
2021-11-26 09:50:01.491242 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 09:50:01.491553 (Thread-1): 10:50:01 | 1 of 3 START view model public.dim_customers......................... [RUN]
2021-11-26 09:50:01.491819 (Thread-2): 10:50:01 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 09:50:01.492233 (Thread-1): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:50:01.492558 (Thread-2): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:50:01.492846 (Thread-1): Compiling model.demo_dbt.dim_customers
2021-11-26 09:50:01.493057 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 09:50:01.494626 (Thread-1): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 09:50:01.497164 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 09:50:01.497907 (Thread-1): finished collecting timing info
2021-11-26 09:50:01.498109 (Thread-2): finished collecting timing info
2021-11-26 09:50:01.531773 (Thread-1): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 09:50:01.533809 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 09:50:01.534173 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:50:01.534285 (Thread-1): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 09:50:01.534415 (Thread-2): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:50:01.534515 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 09:50:01.534608 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 09:50:01.534801 (Thread-2): Opening a new connection, currently in state init
2021-11-26 09:50:01.538712 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:50:01.538885 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:50:01.539002 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:50:01.539105 (Thread-2): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:50:01.539207 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */

  create view "demo_dbt"."public"."dim_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
),

orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
),

customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );

2021-11-26 09:50:01.539310 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 09:50:01.550577 (Thread-2): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 09:50:01.555149 (Thread-2): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:50:01.555303 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-11-26 09:50:01.555419 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 09:50:01.556898 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:50:01.557068 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 09:50:01.558033 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 09:50:01.562766 (Thread-1): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 09:50:01.562903 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 09:50:01.563011 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:50:01.564348 (Thread-2): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:50:01.564465 (Thread-1): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 09:50:01.564557 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 09:50:01.565039 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 09:50:01.568395 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 09:50:01.568516 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 09:50:01.568608 (Thread-2): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:50:01.571615 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:50:01.571738 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 09:50:01.571838 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop view if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 09:50:01.572279 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 09:50:01.573129 (Thread-2): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:50:01.573318 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 09:50:01.573409 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 09:50:01.574098 (Thread-1): finished collecting timing info
2021-11-26 09:50:01.574259 (Thread-1): On model.demo_dbt.dim_customers: Close
2021-11-26 09:50:01.574531 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac71fb7c-5404-48f7-acda-7f591a6da391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aadfb430>]}
2021-11-26 09:50:01.574777 (Thread-1): 10:50:01 | 1 of 3 OK created view model public.dim_customers.................... [CREATE VIEW in 0.08s]
2021-11-26 09:50:01.574907 (Thread-1): Finished running node model.demo_dbt.dim_customers
2021-11-26 09:50:01.585214 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-11-26 09:50:01.586091 (Thread-2): finished collecting timing info
2021-11-26 09:50:01.586236 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 09:50:01.586505 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac71fb7c-5404-48f7-acda-7f591a6da391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa098698c70>]}
2021-11-26 09:50:01.586765 (Thread-2): 10:50:01 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 09:50:01.586893 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 09:50:01.587604 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 09:50:01.587921 (Thread-4): 10:50:01 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 09:50:01.588168 (Thread-4): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 09:50:01.588282 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 09:50:01.589960 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 09:50:01.590319 (Thread-4): finished collecting timing info
2021-11-26 09:50:01.592716 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 09:50:01.593272 (Thread-4): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 09:50:01.593376 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 09:50:01.593474 (Thread-4): Opening a new connection, currently in state init
2021-11-26 09:50:01.597192 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:50:01.597350 (Thread-4): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 09:50:01.597443 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 09:50:01.599523 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 09:50:01.600987 (Thread-4): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 09:50:01.601099 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 09:50:01.601452 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 09:50:01.602107 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 09:50:01.602205 (Thread-4): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 09:50:01.602288 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 09:50:01.602649 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 09:50:01.603527 (Thread-4): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 09:50:01.603628 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 09:50:01.603967 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 09:50:01.604585 (Thread-4): finished collecting timing info
2021-11-26 09:50:01.604709 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 09:50:01.604945 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac71fb7c-5404-48f7-acda-7f591a6da391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aaea24f0>]}
2021-11-26 09:50:01.605180 (Thread-4): 10:50:01 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 09:50:01.605303 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 09:50:01.606142 (MainThread): Acquiring new postgres connection "master".
2021-11-26 09:50:01.606302 (MainThread): Using postgres connection "master".
2021-11-26 09:50:01.606398 (MainThread): On master: BEGIN
2021-11-26 09:50:01.606494 (MainThread): Opening a new connection, currently in state closed
2021-11-26 09:50:01.610812 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:50:01.611021 (MainThread): On master: COMMIT
2021-11-26 09:50:01.611123 (MainThread): Using postgres connection "master".
2021-11-26 09:50:01.611218 (MainThread): On master: COMMIT
2021-11-26 09:50:01.611395 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 09:50:01.611498 (MainThread): On master: Close
2021-11-26 09:50:01.611790 (MainThread): 10:50:01 | 
2021-11-26 09:50:01.611931 (MainThread): 10:50:01 | Finished running 2 view models, 1 table model in 0.34s.
2021-11-26 09:50:01.612038 (MainThread): Connection 'master' was properly closed.
2021-11-26 09:50:01.612177 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 09:50:01.612273 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 09:50:01.612362 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 09:50:01.615601 (MainThread): 
2021-11-26 09:50:01.615756 (MainThread): Completed successfully
2021-11-26 09:50:01.615871 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-11-26 09:50:01.616025 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aad965e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aadb2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a81adac0>]}
2021-11-26 09:50:01.616190 (MainThread): Flushing usage events
2021-11-26 09:54:28.079861 (MainThread): Running with dbt=0.21.0
2021-11-26 09:54:28.145268 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['dim_customers'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 09:54:28.147058 (MainThread): Tracking: tracking
2021-11-26 09:54:28.177092 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb02adfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead004dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb02ae6a90>]}
2021-11-26 09:54:28.186401 (MainThread): Partial parsing not enabled
2021-11-26 09:54:28.195576 (MainThread): Parsing macros/catalog.sql
2021-11-26 09:54:28.198254 (MainThread): Parsing macros/relations.sql
2021-11-26 09:54:28.199309 (MainThread): Parsing macros/adapters.sql
2021-11-26 09:54:28.216385 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 09:54:28.217555 (MainThread): Parsing macros/core.sql
2021-11-26 09:54:28.220141 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 09:54:28.225106 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 09:54:28.232065 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 09:54:28.233219 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 09:54:28.245436 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 09:54:28.273372 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 09:54:28.290638 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 09:54:28.291829 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 09:54:28.299433 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 09:54:28.315210 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 09:54:28.326015 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 09:54:28.332146 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 09:54:28.337786 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 09:54:28.340441 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 09:54:28.341423 (MainThread): Parsing macros/etc/query.sql
2021-11-26 09:54:28.342042 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 09:54:28.343073 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 09:54:28.349277 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 09:54:28.350461 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 09:54:28.352096 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 09:54:28.353150 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 09:54:28.396413 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 09:54:28.397540 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 09:54:28.398307 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 09:54:28.399205 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 09:54:28.512356 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:54:28.520798 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 09:54:28.522974 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 09:54:28.553988 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e80b235f-3d34-477f-a511-fbdfa134fc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf09a4a30>]}
2021-11-26 09:54:28.557012 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e80b235f-3d34-477f-a511-fbdfa134fc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf0916730>]}
2021-11-26 09:54:28.557192 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 09:54:28.557908 (MainThread): 
2021-11-26 09:54:28.558113 (MainThread): Acquiring new postgres connection "master".
2021-11-26 09:54:28.558706 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 09:54:28.564306 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 09:54:28.564459 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 09:54:28.564551 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 09:54:28.620627 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.06 seconds
2021-11-26 09:54:28.622403 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 09:54:28.623285 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 09:54:28.627752 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 09:54:28.627878 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 09:54:28.627986 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 09:54:28.633551 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 09:54:28.633689 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 09:54:28.633792 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 09:54:28.641636 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-11-26 09:54:28.642532 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 09:54:28.642847 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 09:54:28.646589 (MainThread): Using postgres connection "master".
2021-11-26 09:54:28.646728 (MainThread): On master: BEGIN
2021-11-26 09:54:28.646844 (MainThread): Opening a new connection, currently in state init
2021-11-26 09:54:28.651570 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:54:28.651703 (MainThread): Using postgres connection "master".
2021-11-26 09:54:28.651807 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 09:54:28.691012 (MainThread): SQL status: SELECT 3 in 0.04 seconds
2021-11-26 09:54:28.692170 (MainThread): On master: ROLLBACK
2021-11-26 09:54:28.692617 (MainThread): Using postgres connection "master".
2021-11-26 09:54:28.692750 (MainThread): On master: BEGIN
2021-11-26 09:54:28.693459 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:54:28.693599 (MainThread): On master: COMMIT
2021-11-26 09:54:28.693726 (MainThread): Using postgres connection "master".
2021-11-26 09:54:28.693842 (MainThread): On master: COMMIT
2021-11-26 09:54:28.694103 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 09:54:28.694246 (MainThread): On master: Close
2021-11-26 09:54:28.694530 (MainThread): 10:54:28 | Concurrency: 10 threads (target='dev')
2021-11-26 09:54:28.694709 (MainThread): 10:54:28 | 
2021-11-26 09:54:28.697812 (Thread-1): Began running node model.demo_dbt.dim_customers
2021-11-26 09:54:28.698122 (Thread-1): 10:54:28 | 1 of 1 START table model public.dim_customers........................ [RUN]
2021-11-26 09:54:28.698439 (Thread-1): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:54:28.698616 (Thread-1): Compiling model.demo_dbt.dim_customers
2021-11-26 09:54:28.701104 (Thread-1): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 09:54:28.701825 (Thread-1): finished collecting timing info
2021-11-26 09:54:28.722910 (Thread-1): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 09:54:28.723387 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:54:28.723498 (Thread-1): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 09:54:28.723601 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 09:54:28.727735 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:54:28.727899 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:54:28.728000 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    

with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
),

orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
),

customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 09:54:28.732595 (Thread-1): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 09:54:28.737337 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:54:28.737481 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 09:54:28.738336 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 09:54:28.739990 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:54:28.740120 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 09:54:28.740599 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 09:54:28.747918 (Thread-1): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 09:54:28.748031 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:54:28.748120 (Thread-1): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 09:54:28.748866 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 09:54:28.751896 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 09:54:28.752030 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop view if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 09:54:28.753645 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 09:54:28.754412 (Thread-1): finished collecting timing info
2021-11-26 09:54:28.754548 (Thread-1): On model.demo_dbt.dim_customers: Close
2021-11-26 09:54:28.754816 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e80b235f-3d34-477f-a511-fbdfa134fc50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf0a152b0>]}
2021-11-26 09:54:28.755064 (Thread-1): 10:54:28 | 1 of 1 OK created table model public.dim_customers................... [SELECT 100 in 0.06s]
2021-11-26 09:54:28.755193 (Thread-1): Finished running node model.demo_dbt.dim_customers
2021-11-26 09:54:28.756041 (MainThread): Acquiring new postgres connection "master".
2021-11-26 09:54:28.756169 (MainThread): Using postgres connection "master".
2021-11-26 09:54:28.756257 (MainThread): On master: BEGIN
2021-11-26 09:54:28.756349 (MainThread): Opening a new connection, currently in state closed
2021-11-26 09:54:28.761270 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 09:54:28.761563 (MainThread): On master: COMMIT
2021-11-26 09:54:28.761654 (MainThread): Using postgres connection "master".
2021-11-26 09:54:28.761747 (MainThread): On master: COMMIT
2021-11-26 09:54:28.761939 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 09:54:28.762074 (MainThread): On master: Close
2021-11-26 09:54:28.762452 (MainThread): 10:54:28 | 
2021-11-26 09:54:28.762583 (MainThread): 10:54:28 | Finished running 1 table model in 0.20s.
2021-11-26 09:54:28.762682 (MainThread): Connection 'master' was properly closed.
2021-11-26 09:54:28.762763 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 09:54:28.766016 (MainThread): 
2021-11-26 09:54:28.766165 (MainThread): Completed successfully
2021-11-26 09:54:28.766273 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-26 09:54:28.766432 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf0a01880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf09d6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf09f89d0>]}
2021-11-26 09:54:28.766591 (MainThread): Flushing usage events
2021-11-26 10:31:02.561346 (MainThread): Running with dbt=0.21.0
2021-11-26 10:31:02.643774 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 10:31:02.645174 (MainThread): Tracking: tracking
2021-11-26 10:31:02.678295 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c0757310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c0766250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c0760190>]}
2021-11-26 10:31:02.687257 (MainThread): Partial parsing not enabled
2021-11-26 10:31:02.696888 (MainThread): Parsing macros/catalog.sql
2021-11-26 10:31:02.699693 (MainThread): Parsing macros/relations.sql
2021-11-26 10:31:02.700726 (MainThread): Parsing macros/adapters.sql
2021-11-26 10:31:02.717086 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 10:31:02.718240 (MainThread): Parsing macros/core.sql
2021-11-26 10:31:02.720824 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 10:31:02.725697 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 10:31:02.732433 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 10:31:02.733569 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 10:31:02.745585 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 10:31:02.771786 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 10:31:02.788475 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 10:31:02.789664 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 10:31:02.797080 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 10:31:02.812124 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 10:31:02.822444 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 10:31:02.828364 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 10:31:02.833839 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 10:31:02.836442 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 10:31:02.837426 (MainThread): Parsing macros/etc/query.sql
2021-11-26 10:31:02.838052 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 10:31:02.839080 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 10:31:02.845144 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 10:31:02.846319 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 10:31:02.847943 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 10:31:02.848983 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 10:31:02.889845 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 10:31:02.890964 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 10:31:02.891720 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 10:31:02.892586 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 10:31:03.006076 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:31:03.013793 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:31:03.015369 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d279fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d2803d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d27f28b0>]}
2021-11-26 10:31:03.015551 (MainThread): Flushing usage events
2021-11-26 10:31:03.557317 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 10:31:03.558138 (MainThread): Encountered an error:
2021-11-26 10:31:03.558701 (MainThread): Compilation Error in model dim_customers (models/dim_customers.sql)
  expected token 'end of print statement', got ':'
    line 6
      select * from {{ref:'stg_customers'}}
2021-11-26 10:31:03.567731 (MainThread): Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 6, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got ':'
  line 6
    select * from {{ref:'stg_customers'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 301, in load
    self.parse_project(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 410, in parse_project
    parser.parse_file(block)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/models.py", line 81, in render_update
    super().render_update(node, config)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 380, in render_update
    context = self.render_with_context(node, config)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/base.py", line 271, in render_with_context
    get_rendered(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 591, in get_rendered
    template = get_template(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 520, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model dim_customers (models/dim_customers.sql)
  expected token 'end of print statement', got ':'
    line 6
      select * from {{ref:'stg_customers'}}

2021-11-26 10:32:06.955544 (MainThread): Running with dbt=0.21.0
2021-11-26 10:32:07.018757 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 10:32:07.020343 (MainThread): Tracking: tracking
2021-11-26 10:32:07.045022 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b20e4ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b20e5e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b20e57250>]}
2021-11-26 10:32:07.053907 (MainThread): Partial parsing not enabled
2021-11-26 10:32:07.063083 (MainThread): Parsing macros/catalog.sql
2021-11-26 10:32:07.065842 (MainThread): Parsing macros/relations.sql
2021-11-26 10:32:07.066981 (MainThread): Parsing macros/adapters.sql
2021-11-26 10:32:07.085024 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 10:32:07.086241 (MainThread): Parsing macros/core.sql
2021-11-26 10:32:07.088897 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 10:32:07.094051 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 10:32:07.101404 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 10:32:07.102590 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 10:32:07.115204 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 10:32:07.144483 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 10:32:07.162632 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 10:32:07.163885 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 10:32:07.171690 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 10:32:07.188542 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 10:32:07.200250 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 10:32:07.206567 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 10:32:07.212404 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 10:32:07.215113 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 10:32:07.216122 (MainThread): Parsing macros/etc/query.sql
2021-11-26 10:32:07.216755 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 10:32:07.217818 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 10:32:07.224354 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 10:32:07.225574 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 10:32:07.227255 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 10:32:07.228323 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 10:32:07.274387 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 10:32:07.275544 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 10:32:07.276321 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 10:32:07.277218 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 10:32:07.392172 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:07.399977 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:07.402673 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:07.404339 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:07.406569 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:07.438069 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82579d9b-3677-4658-af88-640301dbefa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b100e7640>]}
2021-11-26 10:32:07.441852 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82579d9b-3677-4658-af88-640301dbefa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4261ad90>]}
2021-11-26 10:32:07.442037 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 10:32:07.442972 (MainThread): 
2021-11-26 10:32:07.443191 (MainThread): Acquiring new postgres connection "master".
2021-11-26 10:32:07.444055 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 10:32:07.450806 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 10:32:07.459212 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 10:32:07.459601 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 10:32:07.521005 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.06 seconds
2021-11-26 10:32:07.522946 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 10:32:07.524053 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 10:32:07.529483 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 10:32:07.529629 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 10:32:07.529750 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 10:32:07.535734 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 10:32:07.535868 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 10:32:07.535974 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 10:32:07.548288 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-11-26 10:32:07.549310 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 10:32:07.549609 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 10:32:07.553439 (MainThread): Using postgres connection "master".
2021-11-26 10:32:07.553601 (MainThread): On master: BEGIN
2021-11-26 10:32:07.553729 (MainThread): Opening a new connection, currently in state init
2021-11-26 10:32:07.557948 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:07.558101 (MainThread): Using postgres connection "master".
2021-11-26 10:32:07.558217 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 10:32:07.587621 (MainThread): SQL status: SELECT 1 in 0.03 seconds
2021-11-26 10:32:07.588911 (MainThread): On master: ROLLBACK
2021-11-26 10:32:07.589450 (MainThread): Using postgres connection "master".
2021-11-26 10:32:07.589593 (MainThread): On master: BEGIN
2021-11-26 10:32:07.590152 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:07.590298 (MainThread): On master: COMMIT
2021-11-26 10:32:07.590425 (MainThread): Using postgres connection "master".
2021-11-26 10:32:07.590543 (MainThread): On master: COMMIT
2021-11-26 10:32:07.590875 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:07.591029 (MainThread): On master: Close
2021-11-26 10:32:07.591352 (MainThread): 11:32:07 | Concurrency: 10 threads (target='dev')
2021-11-26 10:32:07.591522 (MainThread): 11:32:07 | 
2021-11-26 10:32:07.594866 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 10:32:07.595067 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 10:32:07.595250 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 10:32:07.595499 (Thread-1): 11:32:07 | 1 of 5 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 10:32:07.595721 (Thread-2): 11:32:07 | 2 of 5 START view model public.stg_customers......................... [RUN]
2021-11-26 10:32:07.595934 (Thread-3): 11:32:07 | 3 of 5 START view model public.stg_orders............................ [RUN]
2021-11-26 10:32:07.596274 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:07.596566 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:07.596878 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:07.597036 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 10:32:07.597172 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 10:32:07.597299 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 10:32:07.599506 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 10:32:07.600452 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 10:32:07.601450 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 10:32:07.601914 (Thread-2): finished collecting timing info
2021-11-26 10:32:07.602100 (Thread-3): finished collecting timing info
2021-11-26 10:32:07.626572 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 10:32:07.627291 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 10:32:07.627463 (Thread-1): finished collecting timing info
2021-11-26 10:32:07.640225 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 10:32:07.640441 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:07.640570 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:07.640659 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 10:32:07.640764 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 10:32:07.640902 (Thread-3): Opening a new connection, currently in state init
2021-11-26 10:32:07.641027 (Thread-2): Opening a new connection, currently in state init
2021-11-26 10:32:07.641121 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:07.641407 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 10:32:07.641498 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 10:32:07.644856 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:07.645019 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:07.645115 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:07.645215 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:07.645322 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:07.645411 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:07.645497 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 10:32:07.645579 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 10:32:07.645685 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 10:32:07.652917 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 10:32:07.653089 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 10:32:07.653195 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 10:32:07.657603 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:07.658909 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:07.660060 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:07.660175 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 10:32:07.660268 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 10:32:07.660357 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 10:32:07.660787 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:07.660890 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:07.662735 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:07.662831 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:07.667125 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 10:32:07.667243 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 10:32:07.667876 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 10:32:07.667985 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:07.668111 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:07.668206 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 10:32:07.668295 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 10:32:07.668429 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:07.671825 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 10:32:07.671932 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:07.672018 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:07.672088 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:07.674712 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:07.674823 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 10:32:07.675655 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:07.675758 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 10:32:07.675874 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 10:32:07.676098 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:07.676961 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:07.677069 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 10:32:07.677152 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 10:32:07.677225 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 10:32:07.677854 (Thread-2): finished collecting timing info
2021-11-26 10:32:07.678425 (Thread-3): finished collecting timing info
2021-11-26 10:32:07.678567 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 10:32:07.678679 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 10:32:07.678934 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82579d9b-3677-4658-af88-640301dbefa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b100dcac0>]}
2021-11-26 10:32:07.679172 (Thread-2): 11:32:07 | 2 of 5 OK created view model public.stg_customers.................... [CREATE VIEW in 0.08s]
2021-11-26 10:32:07.679295 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 10:32:07.679587 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82579d9b-3677-4658-af88-640301dbefa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b10107040>]}
2021-11-26 10:32:07.679777 (Thread-3): 11:32:07 | 3 of 5 OK created view model public.stg_orders....................... [CREATE VIEW in 0.08s]
2021-11-26 10:32:07.679918 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 10:32:07.680149 (Thread-5): Began running node model.demo_dbt.dim_customers
2021-11-26 10:32:07.680302 (Thread-5): 11:32:07 | 4 of 5 START table model public.dim_customers........................ [RUN]
2021-11-26 10:32:07.680499 (Thread-5): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:07.680594 (Thread-5): Compiling model.demo_dbt.dim_customers
2021-11-26 10:32:07.682478 (Thread-5): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 10:32:07.682957 (Thread-5): finished collecting timing info
2021-11-26 10:32:07.684214 (Thread-5): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 10:32:07.684330 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-26 10:32:07.685009 (Thread-1): finished collecting timing info
2021-11-26 10:32:07.685129 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 10:32:07.685368 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82579d9b-3677-4658-af88-640301dbefa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b426b7f10>]}
2021-11-26 10:32:07.685514 (Thread-5): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:07.685721 (Thread-1): 11:32:07 | 1 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 10:32:07.685804 (Thread-5): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 10:32:07.685935 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 10:32:07.686032 (Thread-5): Opening a new connection, currently in state init
2021-11-26 10:32:07.686353 (Thread-7): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 10:32:07.686506 (Thread-7): 11:32:07 | 5 of 5 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 10:32:07.686693 (Thread-7): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:07.686786 (Thread-7): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 10:32:07.688125 (Thread-7): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 10:32:07.688382 (Thread-7): finished collecting timing info
2021-11-26 10:32:07.689599 (Thread-7): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 10:32:07.689848 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:07.689931 (Thread-7): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 10:32:07.690015 (Thread-5): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:07.690110 (Thread-7): Opening a new connection, currently in state init
2021-11-26 10:32:07.690189 (Thread-5): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:07.690344 (Thread-5): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    

with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

with orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 10:32:07.690607 (Thread-5): Postgres error: syntax error at or near "with"
LINE 12: with orders as (
         ^

2021-11-26 10:32:07.690700 (Thread-5): On model.demo_dbt.dim_customers: ROLLBACK
2021-11-26 10:32:07.691018 (Thread-5): finished collecting timing info
2021-11-26 10:32:07.691173 (Thread-5): On model.demo_dbt.dim_customers: Close
2021-11-26 10:32:07.693329 (Thread-7): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:07.693632 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:07.693795 (Thread-7): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 10:32:07.695475 (Thread-7): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 10:32:07.691431 (Thread-5): Database Error in model dim_customers (models/dim_customers.sql)
  syntax error at or near "with"
  LINE 12: with orders as (
           ^
  compiled SQL at target/run/demo_dbt/models/dim_customers.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "with"
LINE 12: with orders as (
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/dim_customers.sql)
  syntax error at or near "with"
  LINE 12: with orders as (
           ^
  compiled SQL at target/run/demo_dbt/models/dim_customers.sql
2021-11-26 10:32:07.697013 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:07.697197 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82579d9b-3677-4658-af88-640301dbefa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b1005f280>]}
2021-11-26 10:32:07.697295 (Thread-7): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 10:32:07.697543 (Thread-5): 11:32:07 | 4 of 5 ERROR creating table model public.dim_customers............... [ERROR in 0.02s]
2021-11-26 10:32:07.697652 (Thread-5): Finished running node model.demo_dbt.dim_customers
2021-11-26 10:32:07.697776 (Thread-7): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:07.698501 (Thread-7): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 10:32:07.698589 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:07.698666 (Thread-7): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 10:32:07.699025 (Thread-7): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:07.699780 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:07.699967 (Thread-7): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 10:32:07.700279 (Thread-7): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 10:32:07.700815 (Thread-7): finished collecting timing info
2021-11-26 10:32:07.700916 (Thread-7): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 10:32:07.701114 (Thread-7): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82579d9b-3677-4658-af88-640301dbefa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b426b7f10>]}
2021-11-26 10:32:07.701303 (Thread-7): 11:32:07 | 5 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.01s]
2021-11-26 10:32:07.701406 (Thread-7): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 10:32:07.702217 (MainThread): Acquiring new postgres connection "master".
2021-11-26 10:32:07.702335 (MainThread): Using postgres connection "master".
2021-11-26 10:32:07.702416 (MainThread): On master: BEGIN
2021-11-26 10:32:07.702498 (MainThread): Opening a new connection, currently in state closed
2021-11-26 10:32:07.705396 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:07.705515 (MainThread): On master: COMMIT
2021-11-26 10:32:07.705598 (MainThread): Using postgres connection "master".
2021-11-26 10:32:07.705677 (MainThread): On master: COMMIT
2021-11-26 10:32:07.705856 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:07.705947 (MainThread): On master: Close
2021-11-26 10:32:07.706161 (MainThread): 11:32:07 | 
2021-11-26 10:32:07.706271 (MainThread): 11:32:07 | Finished running 3 view models, 2 table models in 0.26s.
2021-11-26 10:32:07.706368 (MainThread): Connection 'master' was properly closed.
2021-11-26 10:32:07.706449 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 10:32:07.706525 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 10:32:07.706599 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 10:32:07.706672 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 10:32:07.706745 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 10:32:07.709875 (MainThread): 
2021-11-26 10:32:07.710041 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 10:32:07.710144 (MainThread): 
2021-11-26 10:32:07.710240 (MainThread): Database Error in model dim_customers (models/dim_customers.sql)
2021-11-26 10:32:07.710330 (MainThread):   syntax error at or near "with"
2021-11-26 10:32:07.710414 (MainThread):   LINE 12: with orders as (
2021-11-26 10:32:07.710499 (MainThread):            ^
2021-11-26 10:32:07.710583 (MainThread):   compiled SQL at target/run/demo_dbt/models/dim_customers.sql
2021-11-26 10:32:07.710680 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-11-26 10:32:07.710833 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b425f8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b20e4ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b42653550>]}
2021-11-26 10:32:07.710993 (MainThread): Flushing usage events
2021-11-26 10:32:38.844093 (MainThread): Running with dbt=0.21.0
2021-11-26 10:32:38.908810 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 10:32:38.910107 (MainThread): Tracking: tracking
2021-11-26 10:32:38.935463 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f284d7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f284e52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f284df220>]}
2021-11-26 10:32:38.944126 (MainThread): Partial parsing not enabled
2021-11-26 10:32:38.953006 (MainThread): Parsing macros/catalog.sql
2021-11-26 10:32:38.955589 (MainThread): Parsing macros/relations.sql
2021-11-26 10:32:38.956686 (MainThread): Parsing macros/adapters.sql
2021-11-26 10:32:38.974414 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 10:32:38.975619 (MainThread): Parsing macros/core.sql
2021-11-26 10:32:38.978233 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 10:32:38.983425 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 10:32:38.991209 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 10:32:38.992480 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 10:32:39.005042 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 10:32:39.035359 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 10:32:39.053306 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 10:32:39.054523 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 10:32:39.062422 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 10:32:39.079163 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 10:32:39.090376 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 10:32:39.096955 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 10:32:39.102977 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 10:32:39.105635 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 10:32:39.106632 (MainThread): Parsing macros/etc/query.sql
2021-11-26 10:32:39.107247 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 10:32:39.108293 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 10:32:39.114717 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 10:32:39.115908 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 10:32:39.117555 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 10:32:39.118613 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 10:32:39.163698 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 10:32:39.164826 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 10:32:39.165585 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 10:32:39.166465 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 10:32:39.279518 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:39.287248 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:39.289905 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:39.291546 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:39.293748 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:39.323350 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd989930d-4b42-4513-833c-61ab02fd1fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ace8610>]}
2021-11-26 10:32:39.326496 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd989930d-4b42-4513-833c-61ab02fd1fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ac48670>]}
2021-11-26 10:32:39.326676 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 10:32:39.327591 (MainThread): 
2021-11-26 10:32:39.327798 (MainThread): Acquiring new postgres connection "master".
2021-11-26 10:32:39.328572 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 10:32:39.334812 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 10:32:39.334968 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 10:32:39.335064 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 10:32:39.374447 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 10:32:39.376195 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 10:32:39.377154 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 10:32:39.381800 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 10:32:39.381929 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 10:32:39.382034 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 10:32:39.386853 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:39.386973 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 10:32:39.387064 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 10:32:39.393596 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2021-11-26 10:32:39.394502 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 10:32:39.394818 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 10:32:39.398196 (MainThread): Using postgres connection "master".
2021-11-26 10:32:39.398324 (MainThread): On master: BEGIN
2021-11-26 10:32:39.398428 (MainThread): Opening a new connection, currently in state init
2021-11-26 10:32:39.403301 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:39.403419 (MainThread): Using postgres connection "master".
2021-11-26 10:32:39.403511 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 10:32:39.446906 (MainThread): SQL status: SELECT 3 in 0.04 seconds
2021-11-26 10:32:39.448060 (MainThread): On master: ROLLBACK
2021-11-26 10:32:39.448408 (MainThread): Using postgres connection "master".
2021-11-26 10:32:39.448544 (MainThread): On master: BEGIN
2021-11-26 10:32:39.449139 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:39.449286 (MainThread): On master: COMMIT
2021-11-26 10:32:39.449411 (MainThread): Using postgres connection "master".
2021-11-26 10:32:39.449529 (MainThread): On master: COMMIT
2021-11-26 10:32:39.449844 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:39.449991 (MainThread): On master: Close
2021-11-26 10:32:39.450271 (MainThread): 11:32:39 | Concurrency: 10 threads (target='dev')
2021-11-26 10:32:39.450438 (MainThread): 11:32:39 | 
2021-11-26 10:32:39.454165 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 10:32:39.454461 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 10:32:39.454615 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 10:32:39.454875 (Thread-1): 11:32:39 | 1 of 5 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 10:32:39.455094 (Thread-2): 11:32:39 | 2 of 5 START view model public.stg_customers......................... [RUN]
2021-11-26 10:32:39.455272 (Thread-3): 11:32:39 | 3 of 5 START view model public.stg_orders............................ [RUN]
2021-11-26 10:32:39.455718 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:39.456008 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:39.456249 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:39.456460 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 10:32:39.456613 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 10:32:39.456740 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 10:32:39.458900 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 10:32:39.459858 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 10:32:39.460882 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 10:32:39.461490 (Thread-2): finished collecting timing info
2021-11-26 10:32:39.461686 (Thread-3): finished collecting timing info
2021-11-26 10:32:39.467963 (Thread-1): finished collecting timing info
2021-11-26 10:32:39.480231 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 10:32:39.481670 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 10:32:39.494109 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 10:32:39.494666 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:39.494792 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:39.494879 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 10:32:39.494994 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 10:32:39.495119 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:39.495203 (Thread-2): Opening a new connection, currently in state init
2021-11-26 10:32:39.495289 (Thread-3): Opening a new connection, currently in state init
2021-11-26 10:32:39.495368 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 10:32:39.495635 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 10:32:39.500949 (Thread-2): SQL status: BEGIN in 0.01 seconds
2021-11-26 10:32:39.501062 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-11-26 10:32:39.501161 (Thread-3): SQL status: BEGIN in 0.01 seconds
2021-11-26 10:32:39.501258 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:39.501352 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:39.501438 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:39.501524 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 10:32:39.501611 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 10:32:39.501697 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 10:32:39.505790 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 10:32:39.509904 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:39.510023 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 10:32:39.510107 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 10:32:39.510185 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 10:32:39.511510 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:39.512848 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:39.512960 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 10:32:39.513054 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 10:32:39.514278 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.514375 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.516251 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:39.516345 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.517486 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:39.517591 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 10:32:39.518774 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:39.518881 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 10:32:39.519000 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 10:32:39.519505 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.523806 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 10:32:39.523917 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.524007 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:39.524080 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.524684 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 10:32:39.524783 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 10:32:39.527986 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 10:32:39.528093 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:39.528216 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:39.528308 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 10:32:39.528391 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 10:32:39.529074 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:39.531817 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 10:32:39.531920 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:39.532002 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 10:32:39.532075 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:39.532888 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 10:32:39.533752 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 10:32:39.533856 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 10:32:39.533944 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 10:32:39.535437 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 10:32:39.536078 (Thread-3): finished collecting timing info
2021-11-26 10:32:39.536192 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 10:32:39.536294 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 10:32:39.536911 (Thread-2): finished collecting timing info
2021-11-26 10:32:39.537177 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd989930d-4b42-4513-833c-61ab02fd1fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef82c3370>]}
2021-11-26 10:32:39.537266 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 10:32:39.537488 (Thread-3): 11:32:39 | 3 of 5 OK created view model public.stg_orders....................... [CREATE VIEW in 0.08s]
2021-11-26 10:32:39.537682 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd989930d-4b42-4513-833c-61ab02fd1fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1acdb3a0>]}
2021-11-26 10:32:39.537785 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 10:32:39.537885 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 10:32:39.538072 (Thread-2): 11:32:39 | 2 of 5 OK created view model public.stg_customers.................... [CREATE VIEW in 0.08s]
2021-11-26 10:32:39.538746 (Thread-1): finished collecting timing info
2021-11-26 10:32:39.538881 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 10:32:39.539005 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 10:32:39.539225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd989930d-4b42-4513-833c-61ab02fd1fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ac9b6a0>]}
2021-11-26 10:32:39.539528 (Thread-1): 11:32:39 | 1 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2021-11-26 10:32:39.539643 (Thread-5): Began running node model.demo_dbt.dim_customers
2021-11-26 10:32:39.539750 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 10:32:39.539887 (Thread-5): 11:32:39 | 4 of 5 START table model public.dim_customers........................ [RUN]
2021-11-26 10:32:39.540159 (Thread-5): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:39.540300 (Thread-7): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 10:32:39.540399 (Thread-5): Compiling model.demo_dbt.dim_customers
2021-11-26 10:32:39.540528 (Thread-7): 11:32:39 | 5 of 5 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 10:32:39.542307 (Thread-5): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 10:32:39.542629 (Thread-7): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:39.542787 (Thread-7): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 10:32:39.544196 (Thread-7): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 10:32:39.544436 (Thread-5): finished collecting timing info
2021-11-26 10:32:39.545653 (Thread-5): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 10:32:39.545800 (Thread-7): finished collecting timing info
2021-11-26 10:32:39.546975 (Thread-7): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 10:32:39.547161 (Thread-5): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:39.547273 (Thread-5): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 10:32:39.547362 (Thread-5): Opening a new connection, currently in state init
2021-11-26 10:32:39.547458 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:39.547622 (Thread-7): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 10:32:39.547708 (Thread-7): Opening a new connection, currently in state init
2021-11-26 10:32:39.552273 (Thread-5): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:39.552409 (Thread-7): SQL status: BEGIN in 0.00 seconds
2021-11-26 10:32:39.552500 (Thread-5): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:39.552588 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:39.552679 (Thread-5): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    

with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 10:32:39.552772 (Thread-7): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 10:32:39.556242 (Thread-7): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 10:32:39.557698 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:39.557796 (Thread-7): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 10:32:39.558512 (Thread-7): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.559105 (Thread-7): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 10:32:39.559198 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:39.559279 (Thread-7): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 10:32:39.559943 (Thread-7): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:39.560762 (Thread-7): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 10:32:39.560864 (Thread-7): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 10:32:39.561235 (Thread-7): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 10:32:39.561886 (Thread-7): finished collecting timing info
2021-11-26 10:32:39.562008 (Thread-7): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 10:32:39.562256 (Thread-7): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd989930d-4b42-4513-833c-61ab02fd1fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1acdb3a0>]}
2021-11-26 10:32:39.562477 (Thread-7): 11:32:39 | 5 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 10:32:39.562586 (Thread-7): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 10:32:39.565259 (Thread-5): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 10:32:39.567484 (Thread-5): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:39.567643 (Thread-5): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 10:32:39.568418 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.569941 (Thread-5): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:39.570051 (Thread-5): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 10:32:39.570734 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 10:32:39.571367 (Thread-5): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 10:32:39.571452 (Thread-5): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:39.571526 (Thread-5): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 10:32:39.572200 (Thread-5): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:39.572896 (Thread-5): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 10:32:39.572985 (Thread-5): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 10:32:39.575879 (Thread-5): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 10:32:39.576607 (Thread-5): finished collecting timing info
2021-11-26 10:32:39.576747 (Thread-5): On model.demo_dbt.dim_customers: Close
2021-11-26 10:32:39.577013 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd989930d-4b42-4513-833c-61ab02fd1fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ad765b0>]}
2021-11-26 10:32:39.577250 (Thread-5): 11:32:39 | 4 of 5 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 10:32:39.577373 (Thread-5): Finished running node model.demo_dbt.dim_customers
2021-11-26 10:32:39.578466 (MainThread): Acquiring new postgres connection "master".
2021-11-26 10:32:39.578651 (MainThread): Using postgres connection "master".
2021-11-26 10:32:39.578742 (MainThread): On master: BEGIN
2021-11-26 10:32:39.578835 (MainThread): Opening a new connection, currently in state closed
2021-11-26 10:32:39.584469 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 10:32:39.584619 (MainThread): On master: COMMIT
2021-11-26 10:32:39.584710 (MainThread): Using postgres connection "master".
2021-11-26 10:32:39.584796 (MainThread): On master: COMMIT
2021-11-26 10:32:39.585037 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 10:32:39.585142 (MainThread): On master: Close
2021-11-26 10:32:39.585400 (MainThread): 11:32:39 | 
2021-11-26 10:32:39.585516 (MainThread): 11:32:39 | Finished running 3 view models, 2 table models in 0.26s.
2021-11-26 10:32:39.585622 (MainThread): Connection 'master' was properly closed.
2021-11-26 10:32:39.585705 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 10:32:39.585786 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 10:32:39.585866 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 10:32:39.585948 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 10:32:39.586029 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 10:32:39.590363 (MainThread): 
2021-11-26 10:32:39.590494 (MainThread): Completed successfully
2021-11-26 10:32:39.590599 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-11-26 10:32:39.590750 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ac1af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ad00e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ac63340>]}
2021-11-26 10:32:39.590901 (MainThread): Flushing usage events
2021-11-26 11:49:09.473200 (MainThread): Running with dbt=0.21.0
2021-11-26 11:49:09.568020 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 11:49:09.570280 (MainThread): Tracking: tracking
2021-11-26 11:49:09.605650 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbac1f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbac2eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa8618c10>]}
2021-11-26 11:49:09.614454 (MainThread): Partial parsing not enabled
2021-11-26 11:49:09.624975 (MainThread): Parsing macros/catalog.sql
2021-11-26 11:49:09.627739 (MainThread): Parsing macros/relations.sql
2021-11-26 11:49:09.628799 (MainThread): Parsing macros/adapters.sql
2021-11-26 11:49:09.645442 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 11:49:09.646620 (MainThread): Parsing macros/core.sql
2021-11-26 11:49:09.649169 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 11:49:09.654069 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 11:49:09.660894 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 11:49:09.662039 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 11:49:09.674127 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 11:49:09.700947 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 11:49:09.717902 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 11:49:09.719097 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 11:49:09.726580 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 11:49:09.742004 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 11:49:09.752513 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 11:49:09.758528 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 11:49:09.764053 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 11:49:09.766701 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 11:49:09.767677 (MainThread): Parsing macros/etc/query.sql
2021-11-26 11:49:09.768300 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 11:49:09.769323 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 11:49:09.775466 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 11:49:09.776641 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 11:49:09.778261 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 11:49:09.779295 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 11:49:09.821308 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 11:49:09.822432 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 11:49:09.823212 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 11:49:09.824080 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 11:49:09.938351 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:49:09.946196 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 11:49:09.947893 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:49:09.949540 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:49:09.951744 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 11:49:09.953928 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:49:09.956428 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 11:49:09.987838 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbad4fc10>]}
2021-11-26 11:49:09.992353 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbacf5550>]}
2021-11-26 11:49:09.992531 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 11:49:09.993550 (MainThread): 
2021-11-26 11:49:09.993754 (MainThread): Acquiring new postgres connection "master".
2021-11-26 11:49:09.994620 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 11:49:10.001386 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 11:49:10.001631 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 11:49:10.001735 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 11:49:10.066307 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.06 seconds
2021-11-26 11:49:10.068274 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 11:49:10.069417 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 11:49:10.074126 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 11:49:10.074261 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 11:49:10.074371 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 11:49:10.080954 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 11:49:10.081076 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 11:49:10.081174 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 11:49:10.098316 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.02 seconds
2021-11-26 11:49:10.099508 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 11:49:10.099890 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 11:49:10.104119 (MainThread): Using postgres connection "master".
2021-11-26 11:49:10.104301 (MainThread): On master: BEGIN
2021-11-26 11:49:10.104433 (MainThread): Opening a new connection, currently in state init
2021-11-26 11:49:10.108190 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:49:10.108362 (MainThread): Using postgres connection "master".
2021-11-26 11:49:10.108479 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 11:49:10.149539 (MainThread): SQL status: SELECT 3 in 0.04 seconds
2021-11-26 11:49:10.150833 (MainThread): On master: ROLLBACK
2021-11-26 11:49:10.151068 (MainThread): Using postgres connection "master".
2021-11-26 11:49:10.151193 (MainThread): On master: BEGIN
2021-11-26 11:49:10.151454 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:49:10.151620 (MainThread): On master: COMMIT
2021-11-26 11:49:10.151747 (MainThread): Using postgres connection "master".
2021-11-26 11:49:10.151860 (MainThread): On master: COMMIT
2021-11-26 11:49:10.152041 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:49:10.152223 (MainThread): On master: Close
2021-11-26 11:49:10.152536 (MainThread): 12:49:10 | Concurrency: 10 threads (target='dev')
2021-11-26 11:49:10.152697 (MainThread): 12:49:10 | 
2021-11-26 11:49:10.155787 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 11:49:10.155996 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 11:49:10.156164 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 11:49:10.156304 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 11:49:10.156543 (Thread-1): 12:49:10 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 11:49:10.156778 (Thread-2): 12:49:10 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 11:49:10.156994 (Thread-3): 12:49:10 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 11:49:10.157176 (Thread-4): 12:49:10 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 11:49:10.157515 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:49:10.157795 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:49:10.158125 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:49:10.158392 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 11:49:10.158551 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 11:49:10.158686 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 11:49:10.158807 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 11:49:10.158935 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 11:49:10.161431 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 11:49:10.162474 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 11:49:10.163363 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 11:49:10.164324 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 11:49:10.164940 (Thread-3): finished collecting timing info
2021-11-26 11:49:10.183925 (Thread-2): finished collecting timing info
2021-11-26 11:49:10.184097 (Thread-1): finished collecting timing info
2021-11-26 11:49:10.186079 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 11:49:10.186199 (Thread-4): finished collecting timing info
2021-11-26 11:49:10.187501 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 11:49:10.200599 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 11:49:10.202726 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 11:49:10.203153 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:49:10.203255 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 11:49:10.203359 (Thread-3): Opening a new connection, currently in state init
2021-11-26 11:49:10.203483 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:49:10.203715 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 11:49:10.203809 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 11:49:10.203901 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 11:49:10.204015 (Thread-2): Opening a new connection, currently in state init
2021-11-26 11:49:10.204126 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:49:10.204216 (Thread-4): Opening a new connection, currently in state init
2021-11-26 11:49:10.204407 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 11:49:10.204612 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 11:49:10.206821 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:49:10.206959 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:49:10.207093 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 11:49:10.207208 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:49:10.207338 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:49:10.207421 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 11:49:10.207504 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:49:10.207600 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:49:10.207687 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 11:49:10.207767 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:49:10.207845 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 11:49:10.207925 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 11:49:10.213077 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 11:49:10.217563 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:49:10.217712 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 11:49:10.217813 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 11:49:10.217904 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 11:49:10.218000 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 11:49:10.219308 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:49:10.220697 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:49:10.220811 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.222042 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 11:49:10.222155 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 11:49:10.222249 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 11:49:10.223460 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:49:10.223573 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 11:49:10.223736 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 11:49:10.224013 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.224124 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.225342 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:49:10.225431 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.225530 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.226590 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:49:10.226690 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 11:49:10.230891 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 11:49:10.233993 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 11:49:10.234103 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 11:49:10.234223 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 11:49:10.234326 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:49:10.234447 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 11:49:10.234543 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.234637 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 11:49:10.235269 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 11:49:10.235376 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:49:10.235452 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.235552 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:49:10.238251 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 11:49:10.238351 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:49:10.238906 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 11:49:10.238998 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 11:49:10.239079 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 11:49:10.239803 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:49:10.239893 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:49:10.240023 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 11:49:10.240113 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 11:49:10.240203 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:49:10.240301 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 11:49:10.241236 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:49:10.241347 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:49:10.241992 (Thread-4): finished collecting timing info
2021-11-26 11:49:10.242103 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 11:49:10.242971 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:49:10.243064 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 11:49:10.243164 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 11:49:10.243269 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 11:49:10.243859 (Thread-1): finished collecting timing info
2021-11-26 11:49:10.243970 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 11:49:10.244200 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbad8efa0>]}
2021-11-26 11:49:10.244326 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 11:49:10.244948 (Thread-2): finished collecting timing info
2021-11-26 11:49:10.245054 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 11:49:10.245291 (Thread-4): 12:49:10 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 11:49:10.245491 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbace4fa0>]}
2021-11-26 11:49:10.245590 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 11:49:10.246182 (Thread-3): finished collecting timing info
2021-11-26 11:49:10.246327 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 11:49:10.246517 (Thread-1): 12:49:10 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 11:49:10.246638 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 11:49:10.246831 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbacde460>]}
2021-11-26 11:49:10.247062 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 11:49:10.247336 (Thread-2): 12:49:10 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 11:49:10.247552 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f98133d00>]}
2021-11-26 11:49:10.247815 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 11:49:10.247917 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 11:49:10.248132 (Thread-3): 12:49:10 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 11:49:10.248312 (Thread-6): 12:49:10 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 11:49:10.248438 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 11:49:10.248635 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 11:49:10.248870 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 11:49:10.250361 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 11:49:10.250554 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 11:49:10.250669 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 11:49:10.250835 (Thread-8): 12:49:10 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 11:49:10.250983 (Thread-9): 12:49:10 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 11:49:10.251544 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:49:10.251651 (Thread-6): finished collecting timing info
2021-11-26 11:49:10.251859 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 11:49:10.251958 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 11:49:10.253315 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 11:49:10.253475 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 11:49:10.255446 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 11:49:10.258126 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 11:49:10.258396 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 11:49:10.258511 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 11:49:10.258630 (Thread-6): Opening a new connection, currently in state init
2021-11-26 11:49:10.258858 (Thread-9): finished collecting timing info
2021-11-26 11:49:10.258957 (Thread-8): finished collecting timing info
2021-11-26 11:49:10.260261 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 11:49:10.261480 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 11:49:10.261873 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 11:49:10.261974 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:49:10.262083 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:49:10.262167 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 11:49:10.262266 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 11:49:10.262353 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 11:49:10.262445 (Thread-9): Opening a new connection, currently in state init
2021-11-26 11:49:10.262528 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 11:49:10.262611 (Thread-8): Opening a new connection, currently in state init
2021-11-26 11:49:10.264138 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 11:49:10.265543 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 11:49:10.265680 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 11:49:10.266226 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.267034 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 11:49:10.267168 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 11:49:10.267252 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 11:49:10.267629 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:49:10.268789 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 11:49:10.268978 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 11:49:10.269252 (Thread-9): SQL status: BEGIN in 0.01 seconds
2021-11-26 11:49:10.269374 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 11:49:10.269466 (Thread-8): SQL status: BEGIN in 0.01 seconds
2021-11-26 11:49:10.269571 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 11:49:10.270304 (Thread-6): finished collecting timing info
2021-11-26 11:49:10.270416 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:49:10.270505 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

final as(
    orders.order_id,
    orders.customer_id,
    payments.amount

    from orders 
    left join payments using (order_id)
)
  );
2021-11-26 11:49:10.270608 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 11:49:10.270692 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 11:49:10.270986 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f98133d60>]}
2021-11-26 11:49:10.271107 (Thread-9): Postgres error: syntax error at or near "orders"
LINE 16:     orders.order_id,
             ^

2021-11-26 11:49:10.271349 (Thread-6): 12:49:10 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 11:49:10.271436 (Thread-9): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 11:49:10.271562 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 11:49:10.271826 (Thread-9): finished collecting timing info
2021-11-26 11:49:10.271947 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 11:49:10.272164 (Thread-9): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "orders"
  LINE 16:     orders.order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "orders"
LINE 16:     orders.order_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "orders"
  LINE 16:     orders.order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 11:49:10.275435 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbad67df0>]}
2021-11-26 11:49:10.275555 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 11:49:10.275797 (Thread-9): 12:49:10 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.02s]
2021-11-26 11:49:10.277219 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:49:10.277376 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 11:49:10.277475 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 11:49:10.278052 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.279209 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:49:10.279308 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 11:49:10.279748 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 11:49:10.280419 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 11:49:10.280513 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:49:10.280591 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 11:49:10.281193 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:49:10.282168 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:49:10.282287 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 11:49:10.283510 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 11:49:10.284389 (Thread-8): finished collecting timing info
2021-11-26 11:49:10.284526 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 11:49:10.284780 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b60372-338e-4a74-99fa-f29a9598ad65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbad97c70>]}
2021-11-26 11:49:10.285007 (Thread-8): 12:49:10 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 11:49:10.285123 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 11:49:10.287037 (MainThread): Acquiring new postgres connection "master".
2021-11-26 11:49:10.287252 (MainThread): Using postgres connection "master".
2021-11-26 11:49:10.287343 (MainThread): On master: BEGIN
2021-11-26 11:49:10.287449 (MainThread): Opening a new connection, currently in state closed
2021-11-26 11:49:10.291018 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:49:10.291159 (MainThread): On master: COMMIT
2021-11-26 11:49:10.291244 (MainThread): Using postgres connection "master".
2021-11-26 11:49:10.291324 (MainThread): On master: COMMIT
2021-11-26 11:49:10.291542 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:49:10.291664 (MainThread): On master: Close
2021-11-26 11:49:10.291920 (MainThread): 12:49:10 | 
2021-11-26 11:49:10.292036 (MainThread): 12:49:10 | Finished running 4 view models, 3 table models in 0.30s.
2021-11-26 11:49:10.292136 (MainThread): Connection 'master' was properly closed.
2021-11-26 11:49:10.292215 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 11:49:10.292292 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 11:49:10.292368 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 11:49:10.292443 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 11:49:10.292518 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 11:49:10.292593 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 11:49:10.292668 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 11:49:10.295946 (MainThread): 
2021-11-26 11:49:10.296071 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 11:49:10.296171 (MainThread): 
2021-11-26 11:49:10.296266 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 11:49:10.296356 (MainThread):   syntax error at or near "orders"
2021-11-26 11:49:10.296441 (MainThread):   LINE 16:     orders.order_id,
2021-11-26 11:49:10.296525 (MainThread):                ^
2021-11-26 11:49:10.296607 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 11:49:10.296702 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 11:49:10.296853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbad2b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbac2eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb8fe7880>]}
2021-11-26 11:49:10.297010 (MainThread): Flushing usage events
2021-11-26 11:54:28.810691 (MainThread): Running with dbt=0.21.0
2021-11-26 11:54:28.877669 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['fct_orders'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 11:54:28.879571 (MainThread): Tracking: tracking
2021-11-26 11:54:28.906914 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2d17820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2d27ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2cf8be0>]}
2021-11-26 11:54:28.916009 (MainThread): Partial parsing not enabled
2021-11-26 11:54:28.926706 (MainThread): Parsing macros/catalog.sql
2021-11-26 11:54:28.929419 (MainThread): Parsing macros/relations.sql
2021-11-26 11:54:28.930478 (MainThread): Parsing macros/adapters.sql
2021-11-26 11:54:28.946821 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 11:54:28.947987 (MainThread): Parsing macros/core.sql
2021-11-26 11:54:28.950532 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 11:54:28.955385 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 11:54:28.962140 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 11:54:28.963263 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 11:54:28.975293 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 11:54:29.001522 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 11:54:29.018368 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 11:54:29.019576 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 11:54:29.027027 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 11:54:29.042111 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 11:54:29.052413 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 11:54:29.058354 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 11:54:29.063825 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 11:54:29.066435 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 11:54:29.067422 (MainThread): Parsing macros/etc/query.sql
2021-11-26 11:54:29.068043 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 11:54:29.069069 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 11:54:29.075120 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 11:54:29.076321 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 11:54:29.078009 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 11:54:29.079098 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 11:54:29.120155 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 11:54:29.121281 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 11:54:29.122041 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 11:54:29.122913 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 11:54:29.236209 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 11:54:29.243965 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 11:54:29.245651 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 11:54:29.247289 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 11:54:29.249506 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 11:54:29.251672 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 11:54:29.254171 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 11:54:29.285300 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6484284a-dfce-4a05-b896-02ec3638e484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2ec8be0>]}
2021-11-26 11:54:29.289091 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6484284a-dfce-4a05-b896-02ec3638e484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2e84520>]}
2021-11-26 11:54:29.289272 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 11:54:29.290082 (MainThread): 
2021-11-26 11:54:29.290293 (MainThread): Acquiring new postgres connection "master".
2021-11-26 11:54:29.290912 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 11:54:29.297493 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 11:54:29.297688 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 11:54:29.297792 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 11:54:29.349289 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 11:54:29.351006 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 11:54:29.352091 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 11:54:29.356625 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 11:54:29.356755 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 11:54:29.356865 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 11:54:29.361690 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:54:29.361812 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 11:54:29.361911 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 11:54:29.368432 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 11:54:29.369382 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 11:54:29.369690 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 11:54:29.373212 (MainThread): Using postgres connection "master".
2021-11-26 11:54:29.373344 (MainThread): On master: BEGIN
2021-11-26 11:54:29.373457 (MainThread): Opening a new connection, currently in state init
2021-11-26 11:54:29.378499 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 11:54:29.378636 (MainThread): Using postgres connection "master".
2021-11-26 11:54:29.378742 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 11:54:29.436420 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 11:54:29.437776 (MainThread): On master: ROLLBACK
2021-11-26 11:54:29.438262 (MainThread): Using postgres connection "master".
2021-11-26 11:54:29.438423 (MainThread): On master: BEGIN
2021-11-26 11:54:29.439030 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:54:29.439196 (MainThread): On master: COMMIT
2021-11-26 11:54:29.439339 (MainThread): Using postgres connection "master".
2021-11-26 11:54:29.439472 (MainThread): On master: COMMIT
2021-11-26 11:54:29.439880 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:54:29.440054 (MainThread): On master: Close
2021-11-26 11:54:29.440380 (MainThread): 12:54:29 | Concurrency: 10 threads (target='dev')
2021-11-26 11:54:29.440584 (MainThread): 12:54:29 | 
2021-11-26 11:54:29.444729 (Thread-1): Began running node model.demo_dbt.fct_orders
2021-11-26 11:54:29.445267 (Thread-1): 12:54:29 | 1 of 1 START table model public.fct_orders........................... [RUN]
2021-11-26 11:54:29.445974 (Thread-1): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 11:54:29.446230 (Thread-1): Compiling model.demo_dbt.fct_orders
2021-11-26 11:54:29.450033 (Thread-1): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 11:54:29.450687 (Thread-1): finished collecting timing info
2021-11-26 11:54:29.475629 (Thread-1): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 11:54:29.476094 (Thread-1): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 11:54:29.476205 (Thread-1): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 11:54:29.476310 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 11:54:29.480279 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:54:29.480529 (Thread-1): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 11:54:29.480632 (Thread-1): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

final as(
    order_id,
    customer_id,
    payments.amount

    from orders 
    left join payments using (order_id)
)
  );
2021-11-26 11:54:29.480970 (Thread-1): Postgres error: syntax error at or near "order_id"
LINE 16:     order_id,
             ^

2021-11-26 11:54:29.481130 (Thread-1): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 11:54:29.481377 (Thread-1): finished collecting timing info
2021-11-26 11:54:29.481533 (Thread-1): On model.demo_dbt.fct_orders: Close
2021-11-26 11:54:29.481807 (Thread-1): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "order_id"
LINE 16:     order_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 11:54:29.485661 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6484284a-dfce-4a05-b896-02ec3638e484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd00675190>]}
2021-11-26 11:54:29.485978 (Thread-1): 12:54:29 | 1 of 1 ERROR creating table model public.fct_orders.................. [ERROR in 0.04s]
2021-11-26 11:54:29.486113 (Thread-1): Finished running node model.demo_dbt.fct_orders
2021-11-26 11:54:29.487067 (MainThread): Acquiring new postgres connection "master".
2021-11-26 11:54:29.487208 (MainThread): Using postgres connection "master".
2021-11-26 11:54:29.487301 (MainThread): On master: BEGIN
2021-11-26 11:54:29.487395 (MainThread): Opening a new connection, currently in state closed
2021-11-26 11:54:29.490802 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 11:54:29.490940 (MainThread): On master: COMMIT
2021-11-26 11:54:29.491027 (MainThread): Using postgres connection "master".
2021-11-26 11:54:29.491108 (MainThread): On master: COMMIT
2021-11-26 11:54:29.491244 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 11:54:29.491336 (MainThread): On master: Close
2021-11-26 11:54:29.491552 (MainThread): 12:54:29 | 
2021-11-26 11:54:29.491663 (MainThread): 12:54:29 | Finished running 1 table model in 0.20s.
2021-11-26 11:54:29.491759 (MainThread): Connection 'master' was properly closed.
2021-11-26 11:54:29.491838 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 11:54:29.494892 (MainThread): 
2021-11-26 11:54:29.495027 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 11:54:29.495124 (MainThread): 
2021-11-26 11:54:29.495216 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 11:54:29.495301 (MainThread):   syntax error at or near "order_id"
2021-11-26 11:54:29.495382 (MainThread):   LINE 16:     order_id,
2021-11-26 11:54:29.495464 (MainThread):                ^
2021-11-26 11:54:29.495544 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 11:54:29.495632 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-11-26 11:54:29.495784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2cf87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2ea4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcf2d27ac0>]}
2021-11-26 11:54:29.495945 (MainThread): Flushing usage events
2021-11-26 13:06:45.774315 (MainThread): Running with dbt=0.21.0
2021-11-26 13:06:45.878165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 13:06:45.879914 (MainThread): Tracking: tracking
2021-11-26 13:06:45.914937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a75f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a76fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a740be0>]}
2021-11-26 13:06:45.923677 (MainThread): Partial parsing not enabled
2021-11-26 13:06:45.934995 (MainThread): Parsing macros/catalog.sql
2021-11-26 13:06:45.937887 (MainThread): Parsing macros/relations.sql
2021-11-26 13:06:45.938960 (MainThread): Parsing macros/adapters.sql
2021-11-26 13:06:45.955689 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 13:06:45.956866 (MainThread): Parsing macros/core.sql
2021-11-26 13:06:45.959414 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 13:06:45.964334 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 13:06:45.971186 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 13:06:45.972333 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 13:06:45.984459 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 13:06:46.011750 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 13:06:46.028709 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 13:06:46.029898 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 13:06:46.037565 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 13:06:46.053069 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 13:06:46.063641 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 13:06:46.069721 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 13:06:46.075328 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 13:06:46.077955 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 13:06:46.078933 (MainThread): Parsing macros/etc/query.sql
2021-11-26 13:06:46.079550 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 13:06:46.080573 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 13:06:46.086701 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 13:06:46.087876 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 13:06:46.089497 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 13:06:46.090533 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 13:06:46.132499 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 13:06:46.133622 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 13:06:46.134374 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 13:06:46.135241 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 13:06:46.249365 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:06:46.257223 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:06:46.258926 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:06:46.260579 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:06:46.262818 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:06:46.265000 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:06:46.267480 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:06:46.298220 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a8d1be0>]}
2021-11-26 13:06:46.302224 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a86ffd0>]}
2021-11-26 13:06:46.302406 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 13:06:46.303386 (MainThread): 
2021-11-26 13:06:46.303594 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:06:46.304436 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 13:06:46.310220 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 13:06:46.310325 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 13:06:46.310415 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 13:06:46.370844 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.06 seconds
2021-11-26 13:06:46.372801 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 13:06:46.373914 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 13:06:46.378628 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:06:46.378756 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 13:06:46.378864 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 13:06:46.384542 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:06:46.384665 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:06:46.384763 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 13:06:46.395064 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 13:06:46.396088 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 13:06:46.396408 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 13:06:46.400233 (MainThread): Using postgres connection "master".
2021-11-26 13:06:46.400363 (MainThread): On master: BEGIN
2021-11-26 13:06:46.400474 (MainThread): Opening a new connection, currently in state init
2021-11-26 13:06:46.405768 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:06:46.405908 (MainThread): Using postgres connection "master".
2021-11-26 13:06:46.406020 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 13:06:46.455112 (MainThread): SQL status: SELECT 4 in 0.05 seconds
2021-11-26 13:06:46.456305 (MainThread): On master: ROLLBACK
2021-11-26 13:06:46.456723 (MainThread): Using postgres connection "master".
2021-11-26 13:06:46.456856 (MainThread): On master: BEGIN
2021-11-26 13:06:46.457362 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:06:46.457501 (MainThread): On master: COMMIT
2021-11-26 13:06:46.457624 (MainThread): Using postgres connection "master".
2021-11-26 13:06:46.457739 (MainThread): On master: COMMIT
2021-11-26 13:06:46.458090 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:06:46.458233 (MainThread): On master: Close
2021-11-26 13:06:46.458518 (MainThread): 14:06:46 | Concurrency: 10 threads (target='dev')
2021-11-26 13:06:46.458682 (MainThread): 14:06:46 | 
2021-11-26 13:06:46.461802 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:06:46.462026 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 13:06:46.462206 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 13:06:46.462355 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 13:06:46.462617 (Thread-1): 14:06:46 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 13:06:46.462837 (Thread-2): 14:06:46 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 13:06:46.463040 (Thread-3): 14:06:46 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 13:06:46.463274 (Thread-4): 14:06:46 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 13:06:46.463655 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:06:46.464117 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:06:46.464493 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:06:46.464880 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:06:46.465104 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 13:06:46.465289 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 13:06:46.465461 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 13:06:46.465667 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 13:06:46.468043 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:06:46.469140 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:06:46.470130 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:06:46.471199 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:06:46.471747 (Thread-1): finished collecting timing info
2021-11-26 13:06:46.494187 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:06:46.494488 (Thread-4): finished collecting timing info
2021-11-26 13:06:46.494622 (Thread-2): finished collecting timing info
2021-11-26 13:06:46.494742 (Thread-3): finished collecting timing info
2021-11-26 13:06:46.507697 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:06:46.509255 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:06:46.511175 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:06:46.511324 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:06:46.511551 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 13:06:46.511669 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:06:46.511959 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:06:46.512074 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:06:46.512193 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:06:46.512288 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 13:06:46.512380 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 13:06:46.512465 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 13:06:46.512553 (Thread-2): Opening a new connection, currently in state init
2021-11-26 13:06:46.512641 (Thread-4): Opening a new connection, currently in state init
2021-11-26 13:06:46.512722 (Thread-3): Opening a new connection, currently in state init
2021-11-26 13:06:46.515803 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:06:46.515943 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:06:46.516032 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 13:06:46.517155 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:06:46.517278 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:06:46.517379 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:06:46.517455 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:06:46.517553 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:06:46.517652 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 13:06:46.517738 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:06:46.517818 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 13:06:46.517929 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 13:06:46.525097 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 13:06:46.529521 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:06:46.529690 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:06:46.529791 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:06:46.529868 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:06:46.529947 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 13:06:46.531215 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:06:46.532443 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:06:46.533616 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:06:46.533778 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 13:06:46.533881 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 13:06:46.533966 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 13:06:46.535990 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:06:46.536088 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:06:46.536188 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:06:46.537391 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:06:46.537478 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:06:46.538652 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:06:46.539720 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:06:46.539814 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 13:06:46.540929 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:06:46.541026 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 13:06:46.541109 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 13:06:46.541224 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 13:06:46.541472 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:06:46.547496 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 13:06:46.548177 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:06:46.548784 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:06:46.548874 (Thread-3): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 13:06:46.548977 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:06:46.549047 (Thread-4): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 13:06:46.549130 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:06:46.549681 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:06:46.549769 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:06:46.550299 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:06:46.550387 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:06:46.550470 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:06:46.550573 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:06:46.550690 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:06:46.550779 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:06:46.550992 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:06:46.551095 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:06:46.553655 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:06:46.553743 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:06:46.553836 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:06:46.554658 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:06:46.554753 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 13:06:46.555530 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:06:46.556290 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:06:46.556378 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 13:06:46.556486 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 13:06:46.556574 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 13:06:46.558083 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:06:46.558184 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:06:46.558265 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:06:46.558928 (Thread-2): finished collecting timing info
2021-11-26 13:06:46.559496 (Thread-3): finished collecting timing info
2021-11-26 13:06:46.560047 (Thread-4): finished collecting timing info
2021-11-26 13:06:46.560166 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 13:06:46.560268 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 13:06:46.560358 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 13:06:46.560633 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a900190>]}
2021-11-26 13:06:46.560823 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe807d160>]}
2021-11-26 13:06:46.561071 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe805c220>]}
2021-11-26 13:06:46.561393 (Thread-2): 14:06:46 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.10s]
2021-11-26 13:06:46.561597 (Thread-3): 14:06:46 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.10s]
2021-11-26 13:06:46.561773 (Thread-4): 14:06:46 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.10s]
2021-11-26 13:06:46.561899 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 13:06:46.562018 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-26 13:06:46.562108 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 13:06:46.562219 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 13:06:46.562951 (Thread-1): finished collecting timing info
2021-11-26 13:06:46.563246 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 13:06:46.563353 (Thread-6): Began running node model.demo_dbt.dim_customers
2021-11-26 13:06:46.563459 (Thread-7): Began running node model.demo_dbt.fct_orders
2021-11-26 13:06:46.563611 (Thread-6): 14:06:46 | 5 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 13:06:46.563815 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a933dc0>]}
2021-11-26 13:06:46.563956 (Thread-7): 14:06:46 | 6 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 13:06:46.564162 (Thread-6): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:06:46.564421 (Thread-1): 14:06:46 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.10s]
2021-11-26 13:06:46.564595 (Thread-7): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:06:46.564705 (Thread-6): Compiling model.demo_dbt.dim_customers
2021-11-26 13:06:46.564829 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:06:46.564921 (Thread-7): Compiling model.demo_dbt.fct_orders
2021-11-26 13:06:46.566815 (Thread-6): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:06:46.568444 (Thread-7): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:06:46.568726 (Thread-9): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:06:46.569004 (Thread-9): 14:06:46 | 7 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 13:06:46.569410 (Thread-9): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:06:46.569708 (Thread-9): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 13:06:46.569821 (Thread-7): finished collecting timing info
2021-11-26 13:06:46.569931 (Thread-6): finished collecting timing info
2021-11-26 13:06:46.573032 (Thread-9): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:06:46.574397 (Thread-7): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:06:46.575622 (Thread-6): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:06:46.576227 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:06:46.576354 (Thread-9): finished collecting timing info
2021-11-26 13:06:46.576497 (Thread-7): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:06:46.576583 (Thread-6): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 13:06:46.577953 (Thread-9): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:06:46.578071 (Thread-7): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 13:06:46.578164 (Thread-6): Opening a new connection, currently in state init
2021-11-26 13:06:46.578301 (Thread-7): Opening a new connection, currently in state init
2021-11-26 13:06:46.578618 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:06:46.578706 (Thread-9): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 13:06:46.578787 (Thread-9): Opening a new connection, currently in state init
2021-11-26 13:06:46.581949 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:06:46.582079 (Thread-7): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:06:46.582175 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:06:46.582255 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:06:46.582346 (Thread-7): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:06:46.582430 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 13:06:46.582516 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:06:46.582594 (Thread-7): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

final as(
    order_id,
    customer_id,
    payments.amount

    from orders 
    left join payments using (order_id)
)
  );
2021-11-26 13:06:46.582694 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 13:06:46.582987 (Thread-7): Postgres error: syntax error at or near "order_id"
LINE 16:     order_id,
             ^

2021-11-26 13:06:46.583076 (Thread-7): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 13:06:46.583305 (Thread-7): finished collecting timing info
2021-11-26 13:06:46.583419 (Thread-7): On model.demo_dbt.fct_orders: Close
2021-11-26 13:06:46.584148 (Thread-9): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:06:46.585467 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:06:46.585569 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 13:06:46.586026 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:06:46.586702 (Thread-9): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:06:46.586794 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:06:46.586885 (Thread-6): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 13:06:46.587012 (Thread-9): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:06:46.588315 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:06:46.588471 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 13:06:46.588910 (Thread-9): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:06:46.589006 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:06:46.590047 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:06:46.591451 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:06:46.591588 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 13:06:46.591695 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 13:06:46.592264 (Thread-9): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:06:46.592908 (Thread-9): finished collecting timing info
2021-11-26 13:06:46.593021 (Thread-9): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 13:06:46.593178 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:06:46.593408 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a9c5d90>]}
2021-11-26 13:06:46.594144 (Thread-6): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:06:46.594404 (Thread-9): 14:06:46 | 7 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 13:06:46.594511 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:06:46.594694 (Thread-9): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:06:46.594775 (Thread-6): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:06:46.583646 (Thread-7): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "order_id"
LINE 16:     order_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:06:46.595532 (Thread-7): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbe80638e0>]}
2021-11-26 13:06:46.595629 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:06:46.596447 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:06:46.596542 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 13:06:46.596734 (Thread-7): 14:06:46 | 6 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.03s]
2021-11-26 13:06:46.596867 (Thread-7): Finished running node model.demo_dbt.fct_orders
2021-11-26 13:06:46.597950 (Thread-6): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:06:46.598590 (Thread-6): finished collecting timing info
2021-11-26 13:06:46.598702 (Thread-6): On model.demo_dbt.dim_customers: Close
2021-11-26 13:06:46.598907 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fafd298-11db-4e07-8d47-d0a1f9fa5249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a90cd60>]}
2021-11-26 13:06:46.599100 (Thread-6): 14:06:46 | 5 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 13:06:46.599204 (Thread-6): Finished running node model.demo_dbt.dim_customers
2021-11-26 13:06:46.600135 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:06:46.600251 (MainThread): Using postgres connection "master".
2021-11-26 13:06:46.600332 (MainThread): On master: BEGIN
2021-11-26 13:06:46.600411 (MainThread): Opening a new connection, currently in state closed
2021-11-26 13:06:46.603275 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:06:46.603390 (MainThread): On master: COMMIT
2021-11-26 13:06:46.603472 (MainThread): Using postgres connection "master".
2021-11-26 13:06:46.603549 (MainThread): On master: COMMIT
2021-11-26 13:06:46.603810 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:06:46.603899 (MainThread): On master: Close
2021-11-26 13:06:46.604132 (MainThread): 14:06:46 | 
2021-11-26 13:06:46.604243 (MainThread): 14:06:46 | Finished running 4 view models, 3 table models in 0.30s.
2021-11-26 13:06:46.604338 (MainThread): Connection 'master' was properly closed.
2021-11-26 13:06:46.604420 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 13:06:46.604496 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 13:06:46.604570 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 13:06:46.604643 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 13:06:46.604717 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 13:06:46.604790 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 13:06:46.604863 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 13:06:46.608302 (MainThread): 
2021-11-26 13:06:46.608510 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 13:06:46.608613 (MainThread): 
2021-11-26 13:06:46.608711 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 13:06:46.608799 (MainThread):   syntax error at or near "order_id"
2021-11-26 13:06:46.608883 (MainThread):   LINE 16:     order_id,
2021-11-26 13:06:46.608965 (MainThread):                ^
2021-11-26 13:06:46.609045 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:06:46.609148 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 13:06:46.609361 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a76fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a8a1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc1a8d1fd0>]}
2021-11-26 13:06:46.609567 (MainThread): Flushing usage events
2021-11-26 13:07:01.315070 (MainThread): Running with dbt=0.21.0
2021-11-26 13:07:01.371146 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 13:07:01.373228 (MainThread): Tracking: tracking
2021-11-26 13:07:01.399016 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dab8ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dab9eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dab6fa30>]}
2021-11-26 13:07:01.407409 (MainThread): Partial parsing not enabled
2021-11-26 13:07:01.416710 (MainThread): Parsing macros/catalog.sql
2021-11-26 13:07:01.419265 (MainThread): Parsing macros/relations.sql
2021-11-26 13:07:01.420315 (MainThread): Parsing macros/adapters.sql
2021-11-26 13:07:01.437654 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 13:07:01.438832 (MainThread): Parsing macros/core.sql
2021-11-26 13:07:01.441434 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 13:07:01.446446 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 13:07:01.453462 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 13:07:01.454613 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 13:07:01.466927 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 13:07:01.495217 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 13:07:01.512781 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 13:07:01.513985 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 13:07:01.521641 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 13:07:01.537662 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 13:07:01.548573 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 13:07:01.554770 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 13:07:01.560472 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 13:07:01.563127 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 13:07:01.564114 (MainThread): Parsing macros/etc/query.sql
2021-11-26 13:07:01.564731 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 13:07:01.565761 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 13:07:01.572027 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 13:07:01.573209 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 13:07:01.574844 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 13:07:01.575896 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 13:07:01.619790 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 13:07:01.620913 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 13:07:01.621667 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 13:07:01.622538 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 13:07:01.739143 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:01.746966 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:01.748642 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:01.750265 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:01.752448 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:01.754595 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:01.757082 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:07:01.786842 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dadc1c70>]}
2021-11-26 13:07:01.790404 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dad7b850>]}
2021-11-26 13:07:01.790574 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 13:07:01.791570 (MainThread): 
2021-11-26 13:07:01.791786 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:07:01.792619 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 13:07:01.798881 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 13:07:01.799037 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 13:07:01.799129 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 13:07:01.844470 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 13:07:01.846207 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 13:07:01.847347 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 13:07:01.851823 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:07:01.851957 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 13:07:01.852070 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 13:07:01.857369 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:07:01.857497 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:07:01.857597 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 13:07:01.864040 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 13:07:01.864959 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 13:07:01.865318 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 13:07:01.868842 (MainThread): Using postgres connection "master".
2021-11-26 13:07:01.868975 (MainThread): On master: BEGIN
2021-11-26 13:07:01.869088 (MainThread): Opening a new connection, currently in state init
2021-11-26 13:07:01.873911 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:01.874041 (MainThread): Using postgres connection "master".
2021-11-26 13:07:01.874143 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 13:07:01.930050 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 13:07:01.931347 (MainThread): On master: ROLLBACK
2021-11-26 13:07:01.931685 (MainThread): Using postgres connection "master".
2021-11-26 13:07:01.931839 (MainThread): On master: BEGIN
2021-11-26 13:07:01.932271 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:01.932430 (MainThread): On master: COMMIT
2021-11-26 13:07:01.932572 (MainThread): Using postgres connection "master".
2021-11-26 13:07:01.932704 (MainThread): On master: COMMIT
2021-11-26 13:07:01.932977 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:01.933138 (MainThread): On master: Close
2021-11-26 13:07:01.933458 (MainThread): 14:07:01 | Concurrency: 10 threads (target='dev')
2021-11-26 13:07:01.933643 (MainThread): 14:07:01 | 
2021-11-26 13:07:01.937550 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:07:01.937840 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 13:07:01.938213 (Thread-1): 14:07:01 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 13:07:01.938375 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 13:07:01.938591 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 13:07:01.938873 (Thread-2): 14:07:01 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 13:07:01.939411 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:01.939656 (Thread-3): 14:07:01 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 13:07:01.939880 (Thread-4): 14:07:01 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 13:07:01.940289 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:01.940488 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 13:07:01.940871 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:01.941125 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:01.941299 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 13:07:01.943640 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:07:01.943807 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 13:07:01.943945 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 13:07:01.945001 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:07:01.946086 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:07:01.947107 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:07:01.947401 (Thread-1): finished collecting timing info
2021-11-26 13:07:01.953657 (Thread-2): finished collecting timing info
2021-11-26 13:07:01.959412 (Thread-3): finished collecting timing info
2021-11-26 13:07:01.974227 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:07:01.980542 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:07:01.981854 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:07:01.982093 (Thread-4): finished collecting timing info
2021-11-26 13:07:01.982294 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:01.984167 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:07:01.984315 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 13:07:01.984480 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:01.984576 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:01.984664 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:07:01.984771 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 13:07:01.984869 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 13:07:01.984972 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:01.985134 (Thread-2): Opening a new connection, currently in state init
2021-11-26 13:07:01.985215 (Thread-3): Opening a new connection, currently in state init
2021-11-26 13:07:01.985295 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 13:07:01.985542 (Thread-4): Opening a new connection, currently in state init
2021-11-26 13:07:01.988509 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:01.988727 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:01.988836 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:01.988973 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:01.989075 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:01.989169 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 13:07:01.989307 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:01.989419 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 13:07:01.989557 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 13:07:01.989673 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:07:01.989809 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:01.989888 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 13:07:01.991170 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:07:01.991290 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 13:07:01.995376 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:01.995482 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:07:01.995594 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:07:01.996767 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:01.996868 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 13:07:01.998152 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:01.999313 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:01.999412 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 13:07:01.999530 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 13:07:01.999619 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 13:07:02.000001 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.000095 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.001189 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:02.001272 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.001361 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.002505 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:02.002603 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 13:07:02.003637 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:02.004810 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:02.004935 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 13:07:02.005087 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 13:07:02.005190 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 13:07:02.005567 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.005668 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.012311 (Thread-3): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 13:07:02.012500 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:07:02.013065 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:07:02.013145 (Thread-4): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 13:07:02.013705 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:07:02.013799 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:02.013880 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:02.014409 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:07:02.014499 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:02.014579 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:07:02.014657 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:07:02.014753 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:02.014826 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:07:02.014950 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:07:02.015434 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:02.015531 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:02.018245 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:02.018332 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:02.018425 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:02.019284 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:02.019380 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 13:07:02.020158 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:02.020916 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:02.021014 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 13:07:02.021123 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 13:07:02.021206 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 13:07:02.022111 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:07:02.022873 (Thread-4): finished collecting timing info
2021-11-26 13:07:02.023007 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 13:07:02.023115 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:07:02.023728 (Thread-3): finished collecting timing info
2021-11-26 13:07:02.025494 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0daf20f40>]}
2021-11-26 13:07:02.025639 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 13:07:02.025835 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:07:02.025992 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:07:02.026607 (Thread-4): 14:07:02 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.08s]
2021-11-26 13:07:02.026920 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0daf359a0>]}
2021-11-26 13:07:02.027761 (Thread-1): finished collecting timing info
2021-11-26 13:07:02.029282 (Thread-2): finished collecting timing info
2021-11-26 13:07:02.030612 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 13:07:02.030988 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 13:07:02.031359 (Thread-3): 14:07:02 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 13:07:02.031493 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 13:07:02.031749 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 13:07:02.032851 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dade2f10>]}
2021-11-26 13:07:02.033316 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0d00f5700>]}
2021-11-26 13:07:02.033869 (Thread-2): 14:07:02 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 13:07:02.034098 (Thread-1): 14:07:02 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 13:07:02.034208 (Thread-6): Began running node model.demo_dbt.fct_orders
2021-11-26 13:07:02.034388 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 13:07:02.034614 (Thread-6): 14:07:02 | 5 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 13:07:02.035382 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:07:02.035577 (Thread-1): Began running node model.demo_dbt.dim_customers
2021-11-26 13:07:02.036800 (Thread-1): 14:07:02 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 13:07:02.038655 (Thread-9): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:07:02.036082 (Thread-6): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:07:02.039769 (Thread-9): 14:07:02 | 7 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 13:07:02.041740 (Thread-1): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:02.042718 (Thread-1): Compiling model.demo_dbt.dim_customers
2021-11-26 13:07:02.042247 (Thread-6): Compiling model.demo_dbt.fct_orders
2021-11-26 13:07:02.046132 (Thread-1): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:07:02.048175 (Thread-9): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:02.053082 (Thread-6): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:07:02.053639 (Thread-9): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 13:07:02.056788 (Thread-9): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:07:02.057107 (Thread-1): finished collecting timing info
2021-11-26 13:07:02.059190 (Thread-1): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:07:02.059733 (Thread-6): finished collecting timing info
2021-11-26 13:07:02.061205 (Thread-6): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:07:02.061445 (Thread-9): finished collecting timing info
2021-11-26 13:07:02.062733 (Thread-9): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:07:02.062866 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:02.063031 (Thread-1): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 13:07:02.063150 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:07:02.063262 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:07:02.063486 (Thread-6): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 13:07:02.063588 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:02.063704 (Thread-6): Opening a new connection, currently in state init
2021-11-26 13:07:02.063800 (Thread-9): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 13:07:02.063966 (Thread-9): Opening a new connection, currently in state init
2021-11-26 13:07:02.067268 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:02.067448 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:02.067570 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:02.067656 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:02.067755 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:07:02.067842 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 13:07:02.067955 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:02.068048 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as(
    orders.order_id,
    orders.customer_id,
    sum(payments.amount) as amount

    from orders 
)
select * from order_payments
  );
2021-11-26 13:07:02.068160 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 13:07:02.068481 (Thread-6): Postgres error: syntax error at or near "orders"
LINE 16:     orders.order_id,
             ^

2021-11-26 13:07:02.068624 (Thread-6): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 13:07:02.068840 (Thread-6): finished collecting timing info
2021-11-26 13:07:02.068997 (Thread-6): On model.demo_dbt.fct_orders: Close
2021-11-26 13:07:02.069695 (Thread-9): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:07:02.071569 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:02.071753 (Thread-1): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 13:07:02.071868 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 13:07:02.073576 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:02.073814 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 13:07:02.074248 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.075044 (Thread-9): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:07:02.075151 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.075237 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:02.076614 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:02.076744 (Thread-9): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:07:02.076873 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 13:07:02.077292 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:02.077388 (Thread-9): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:02.078194 (Thread-1): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:07:02.079069 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:02.079225 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:02.079329 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 13:07:02.079496 (Thread-1): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:07:02.079811 (Thread-9): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:07:02.079905 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:02.080747 (Thread-9): finished collecting timing info
2021-11-26 13:07:02.081567 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:02.081757 (Thread-9): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 13:07:02.081902 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 13:07:02.082199 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0daf0b760>]}
2021-11-26 13:07:02.082542 (Thread-9): 14:07:02 | 7 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 13:07:02.082829 (Thread-9): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:07:02.083338 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:07:02.084117 (Thread-1): finished collecting timing info
2021-11-26 13:07:02.084323 (Thread-1): On model.demo_dbt.dim_customers: Close
2021-11-26 13:07:02.084603 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dae9f490>]}
2021-11-26 13:07:02.069325 (Thread-6): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "orders"
  LINE 16:     orders.order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "orders"
LINE 16:     orders.order_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "orders"
  LINE 16:     orders.order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:07:02.085019 (Thread-1): 14:07:02 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 13:07:02.085169 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f72ca117-f44d-45ba-8475-9e4f2216acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dadce310>]}
2021-11-26 13:07:02.085296 (Thread-1): Finished running node model.demo_dbt.dim_customers
2021-11-26 13:07:02.085543 (Thread-6): 14:07:02 | 5 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.05s]
2021-11-26 13:07:02.085742 (Thread-6): Finished running node model.demo_dbt.fct_orders
2021-11-26 13:07:02.086597 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:07:02.086739 (MainThread): Using postgres connection "master".
2021-11-26 13:07:02.086825 (MainThread): On master: BEGIN
2021-11-26 13:07:02.086912 (MainThread): Opening a new connection, currently in state closed
2021-11-26 13:07:02.091007 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:02.091230 (MainThread): On master: COMMIT
2021-11-26 13:07:02.091344 (MainThread): Using postgres connection "master".
2021-11-26 13:07:02.091458 (MainThread): On master: COMMIT
2021-11-26 13:07:02.091648 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:02.091761 (MainThread): On master: Close
2021-11-26 13:07:02.092050 (MainThread): 14:07:02 | 
2021-11-26 13:07:02.092175 (MainThread): 14:07:02 | Finished running 4 view models, 3 table models in 0.30s.
2021-11-26 13:07:02.092272 (MainThread): Connection 'master' was properly closed.
2021-11-26 13:07:02.092353 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 13:07:02.092432 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 13:07:02.092554 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 13:07:02.092631 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 13:07:02.092705 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 13:07:02.092779 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 13:07:02.096611 (MainThread): 
2021-11-26 13:07:02.096799 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 13:07:02.096907 (MainThread): 
2021-11-26 13:07:02.097008 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 13:07:02.097180 (MainThread):   syntax error at or near "orders"
2021-11-26 13:07:02.097276 (MainThread):   LINE 16:     orders.order_id,
2021-11-26 13:07:02.097367 (MainThread):                ^
2021-11-26 13:07:02.097460 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:07:02.097561 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 13:07:02.097754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dad9c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dab9eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0d8f378e0>]}
2021-11-26 13:07:02.097941 (MainThread): Flushing usage events
2021-11-26 13:07:56.588803 (MainThread): Running with dbt=0.21.0
2021-11-26 13:07:56.644892 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 13:07:56.646271 (MainThread): Tracking: tracking
2021-11-26 13:07:56.670475 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afaddf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afadee310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad8202c40>]}
2021-11-26 13:07:56.678859 (MainThread): Partial parsing not enabled
2021-11-26 13:07:56.688126 (MainThread): Parsing macros/catalog.sql
2021-11-26 13:07:56.690574 (MainThread): Parsing macros/relations.sql
2021-11-26 13:07:56.691616 (MainThread): Parsing macros/adapters.sql
2021-11-26 13:07:56.707966 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 13:07:56.709133 (MainThread): Parsing macros/core.sql
2021-11-26 13:07:56.711687 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 13:07:56.716541 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 13:07:56.723335 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 13:07:56.724466 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 13:07:56.736475 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 13:07:56.762701 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 13:07:56.779314 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 13:07:56.780494 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 13:07:56.787906 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 13:07:56.803041 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 13:07:56.813336 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 13:07:56.819280 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 13:07:56.824757 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 13:07:56.827371 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 13:07:56.828349 (MainThread): Parsing macros/etc/query.sql
2021-11-26 13:07:56.828968 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 13:07:56.829991 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 13:07:56.836075 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 13:07:56.837257 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 13:07:56.838879 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 13:07:56.839925 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 13:07:56.881637 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 13:07:56.882847 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 13:07:56.883636 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 13:07:56.884518 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 13:07:56.998571 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:57.006426 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:57.008106 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:57.009750 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:57.011949 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:57.014104 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:57.016586 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:07:57.046488 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac80d1af0>]}
2021-11-26 13:07:57.050169 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac807a4f0>]}
2021-11-26 13:07:57.050352 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 13:07:57.051344 (MainThread): 
2021-11-26 13:07:57.051549 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:07:57.052459 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 13:07:57.059341 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 13:07:57.059514 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 13:07:57.059610 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 13:07:57.102025 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 13:07:57.103608 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 13:07:57.104672 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 13:07:57.109146 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:07:57.109277 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 13:07:57.109386 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 13:07:57.114546 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:07:57.114668 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:07:57.114766 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 13:07:57.121227 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 13:07:57.122170 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 13:07:57.122566 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 13:07:57.126068 (MainThread): Using postgres connection "master".
2021-11-26 13:07:57.126199 (MainThread): On master: BEGIN
2021-11-26 13:07:57.126313 (MainThread): Opening a new connection, currently in state init
2021-11-26 13:07:57.131091 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:57.131217 (MainThread): Using postgres connection "master".
2021-11-26 13:07:57.131317 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 13:07:57.185076 (MainThread): SQL status: SELECT 4 in 0.05 seconds
2021-11-26 13:07:57.186466 (MainThread): On master: ROLLBACK
2021-11-26 13:07:57.186861 (MainThread): Using postgres connection "master".
2021-11-26 13:07:57.187014 (MainThread): On master: BEGIN
2021-11-26 13:07:57.187597 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:57.187762 (MainThread): On master: COMMIT
2021-11-26 13:07:57.187909 (MainThread): Using postgres connection "master".
2021-11-26 13:07:57.188042 (MainThread): On master: COMMIT
2021-11-26 13:07:57.188546 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:57.188710 (MainThread): On master: Close
2021-11-26 13:07:57.189043 (MainThread): 14:07:57 | Concurrency: 10 threads (target='dev')
2021-11-26 13:07:57.189228 (MainThread): 14:07:57 | 
2021-11-26 13:07:57.193601 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:07:57.193827 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 13:07:57.194030 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 13:07:57.194324 (Thread-1): 14:07:57 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 13:07:57.194470 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 13:07:57.194713 (Thread-2): 14:07:57 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 13:07:57.194917 (Thread-3): 14:07:57 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 13:07:57.195275 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:57.195475 (Thread-4): 14:07:57 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 13:07:57.195814 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:57.196190 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:57.196412 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 13:07:57.196634 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 13:07:57.196939 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:57.197103 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 13:07:57.199861 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:07:57.201012 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:07:57.201171 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 13:07:57.202136 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:07:57.203320 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:07:57.203728 (Thread-1): finished collecting timing info
2021-11-26 13:07:57.203899 (Thread-2): finished collecting timing info
2021-11-26 13:07:57.210357 (Thread-3): finished collecting timing info
2021-11-26 13:07:57.231217 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:07:57.237239 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:07:57.239350 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:07:57.239499 (Thread-4): finished collecting timing info
2021-11-26 13:07:57.241122 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:07:57.241257 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:57.241396 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:57.241507 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 13:07:57.241638 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 13:07:57.241757 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:57.241864 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:57.241950 (Thread-2): Opening a new connection, currently in state init
2021-11-26 13:07:57.242036 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:07:57.242118 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 13:07:57.242198 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 13:07:57.242471 (Thread-3): Opening a new connection, currently in state init
2021-11-26 13:07:57.242558 (Thread-4): Opening a new connection, currently in state init
2021-11-26 13:07:57.246988 (Thread-2): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:07:57.247128 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:07:57.247220 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:57.247297 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:57.247383 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:57.247474 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:57.247569 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:57.247655 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:57.247743 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 13:07:57.247831 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 13:07:57.247917 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 13:07:57.248000 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 13:07:57.249291 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 13:07:57.253387 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:57.253507 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:07:57.253593 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:07:57.253666 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:07:57.253854 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 13:07:57.255071 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:57.256360 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:57.257595 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:57.257738 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 13:07:57.257827 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 13:07:57.257906 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 13:07:57.258099 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.259241 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:57.259339 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.259417 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 13:07:57.259487 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.259576 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.260606 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:57.261807 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:57.261907 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.263011 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:57.263111 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 13:07:57.263197 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 13:07:57.269833 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:07:57.269929 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 13:07:57.270092 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:57.270202 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:07:57.270826 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:57.270926 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.271011 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.271082 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.273659 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:07:57.274279 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:07:57.274925 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:07:57.275469 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:07:57.275558 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 13:07:57.275643 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:57.275723 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:57.275801 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:57.275899 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:07:57.275980 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:07:57.276055 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:07:57.276521 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:57.277245 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:07:57.277343 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:57.277419 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 13:07:57.277487 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:57.278281 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:07:57.279077 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:07:57.279174 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 13:07:57.279257 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 13:07:57.279340 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:07:57.279974 (Thread-1): finished collecting timing info
2021-11-26 13:07:57.280085 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 13:07:57.280174 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:07:57.280718 (Thread-3): finished collecting timing info
2021-11-26 13:07:57.280939 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afaef3eb0>]}
2021-11-26 13:07:57.281036 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 13:07:57.281268 (Thread-1): 14:07:57 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 13:07:57.281345 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:07:57.281419 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:07:57.281565 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:07:57.281766 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae8104880>]}
2021-11-26 13:07:57.282325 (Thread-2): finished collecting timing info
2021-11-26 13:07:57.282864 (Thread-4): finished collecting timing info
2021-11-26 13:07:57.283165 (Thread-3): 14:07:57 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 13:07:57.283309 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 13:07:57.283408 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 13:07:57.283510 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:07:57.283633 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 13:07:57.283879 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac808dc10>]}
2021-11-26 13:07:57.284031 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad85aa550>]}
2021-11-26 13:07:57.284161 (Thread-6): 14:07:57 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 13:07:57.284407 (Thread-2): 14:07:57 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 13:07:57.284579 (Thread-4): 14:07:57 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 13:07:57.284762 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:57.284923 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 13:07:57.285093 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 13:07:57.285182 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 13:07:57.286557 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:07:57.286677 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 13:07:57.287016 (Thread-8): 14:07:57 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 13:07:57.287247 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:57.287415 (Thread-10): Began running node model.demo_dbt.fct_orders
2021-11-26 13:07:57.287518 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 13:07:57.287746 (Thread-10): 14:07:57 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 13:07:57.291030 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:07:57.291165 (Thread-6): finished collecting timing info
2021-11-26 13:07:57.291429 (Thread-10): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:07:57.292741 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:07:57.292865 (Thread-10): Compiling model.demo_dbt.fct_orders
2021-11-26 13:07:57.294347 (Thread-10): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:07:57.294513 (Thread-8): finished collecting timing info
2021-11-26 13:07:57.295680 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:07:57.295891 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:57.295990 (Thread-10): finished collecting timing info
2021-11-26 13:07:57.296100 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 13:07:57.297139 (Thread-10): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:07:57.297244 (Thread-6): Opening a new connection, currently in state init
2021-11-26 13:07:57.297342 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:57.297590 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 13:07:57.297680 (Thread-8): Opening a new connection, currently in state init
2021-11-26 13:07:57.297773 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:07:57.297931 (Thread-10): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 13:07:57.298022 (Thread-10): Opening a new connection, currently in state init
2021-11-26 13:07:57.301849 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:57.301952 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:57.302041 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:57.302116 (Thread-10): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:07:57.302199 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:57.302281 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 13:07:57.302364 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:07:57.302438 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 13:07:57.302540 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as(
    order_id,
    sum(amount) as amount

    from payments
)
select * from order_payments
  );
2021-11-26 13:07:57.302970 (Thread-10): Postgres error: syntax error at or near "order_id"
LINE 16:     order_id,
             ^

2021-11-26 13:07:57.303052 (Thread-10): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 13:07:57.303323 (Thread-10): finished collecting timing info
2021-11-26 13:07:57.303429 (Thread-10): On model.demo_dbt.fct_orders: Close
2021-11-26 13:07:57.306042 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:07:57.307640 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:57.307774 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 13:07:57.303631 (Thread-10): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "order_id"
LINE 16:     order_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:07:57.308705 (Thread-10): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae811cc40>]}
2021-11-26 13:07:57.308837 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.309087 (Thread-10): 14:07:57 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.02s]
2021-11-26 13:07:57.309738 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:07:57.309867 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:57.309974 (Thread-10): Finished running node model.demo_dbt.fct_orders
2021-11-26 13:07:57.310064 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:07:57.310377 (Thread-8): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 13:07:57.311718 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:57.311822 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:57.311902 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 13:07:57.312698 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:07:57.312824 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 13:07:57.313139 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:07:57.313697 (Thread-6): finished collecting timing info
2021-11-26 13:07:57.313792 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.313893 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 13:07:57.314911 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:57.315027 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 13:07:57.315222 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afaf9dd60>]}
2021-11-26 13:07:57.315432 (Thread-6): 14:07:57 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 13:07:57.315530 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:07:57.315960 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:07:57.316612 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:07:57.316700 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:57.316776 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:07:57.317225 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:57.318073 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:07:57.318168 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 13:07:57.320294 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:07:57.320862 (Thread-8): finished collecting timing info
2021-11-26 13:07:57.320975 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 13:07:57.321190 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e64fcd2e-a2e9-4226-a702-a05980bc49e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac808d910>]}
2021-11-26 13:07:57.321391 (Thread-8): 14:07:57 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 13:07:57.321495 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 13:07:57.322341 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:07:57.322488 (MainThread): Using postgres connection "master".
2021-11-26 13:07:57.322577 (MainThread): On master: BEGIN
2021-11-26 13:07:57.322671 (MainThread): Opening a new connection, currently in state closed
2021-11-26 13:07:57.328136 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:07:57.328308 (MainThread): On master: COMMIT
2021-11-26 13:07:57.328395 (MainThread): Using postgres connection "master".
2021-11-26 13:07:57.328477 (MainThread): On master: COMMIT
2021-11-26 13:07:57.328658 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:07:57.328782 (MainThread): On master: Close
2021-11-26 13:07:57.329049 (MainThread): 14:07:57 | 
2021-11-26 13:07:57.329166 (MainThread): 14:07:57 | Finished running 3 table models, 4 view models in 0.28s.
2021-11-26 13:07:57.329268 (MainThread): Connection 'master' was properly closed.
2021-11-26 13:07:57.329353 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 13:07:57.329433 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 13:07:57.329513 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 13:07:57.329592 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 13:07:57.329670 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 13:07:57.329749 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 13:07:57.329827 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 13:07:57.332913 (MainThread): 
2021-11-26 13:07:57.333036 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 13:07:57.333136 (MainThread): 
2021-11-26 13:07:57.333232 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 13:07:57.333320 (MainThread):   syntax error at or near "order_id"
2021-11-26 13:07:57.333403 (MainThread):   LINE 16:     order_id,
2021-11-26 13:07:57.333484 (MainThread):                ^
2021-11-26 13:07:57.333567 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:07:57.333661 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 13:07:57.333814 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac80ae790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad82871f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac808b250>]}
2021-11-26 13:07:57.333965 (MainThread): Flushing usage events
2021-11-26 13:08:38.359538 (MainThread): Running with dbt=0.21.0
2021-11-26 13:08:38.423540 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 13:08:38.426221 (MainThread): Tracking: tracking
2021-11-26 13:08:38.451821 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2ab8fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2ab9e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2ab70790>]}
2021-11-26 13:08:38.460351 (MainThread): Partial parsing not enabled
2021-11-26 13:08:38.469766 (MainThread): Parsing macros/catalog.sql
2021-11-26 13:08:38.472376 (MainThread): Parsing macros/relations.sql
2021-11-26 13:08:38.473480 (MainThread): Parsing macros/adapters.sql
2021-11-26 13:08:38.491503 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 13:08:38.492717 (MainThread): Parsing macros/core.sql
2021-11-26 13:08:38.495377 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 13:08:38.500539 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 13:08:38.507846 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 13:08:38.509029 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 13:08:38.521594 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 13:08:38.550642 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 13:08:38.569090 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 13:08:38.570327 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 13:08:38.578088 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 13:08:38.594690 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 13:08:38.606106 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 13:08:38.612368 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 13:08:38.618208 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 13:08:38.620907 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 13:08:38.621905 (MainThread): Parsing macros/etc/query.sql
2021-11-26 13:08:38.622529 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 13:08:38.623569 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 13:08:38.630047 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 13:08:38.631246 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 13:08:38.632907 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 13:08:38.633975 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 13:08:38.679888 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 13:08:38.681042 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 13:08:38.681818 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 13:08:38.682707 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 13:08:38.796810 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:08:38.804599 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:08:38.806280 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:08:38.807918 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:08:38.810143 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:08:38.812308 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:08:38.818311 (MainThread): 1699: statically parsed Marts/fct_orders.sql
2021-11-26 13:08:38.818536 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:08:38.820638 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2ac9cf40>]}
2021-11-26 13:08:38.849311 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb18888b80>]}
2021-11-26 13:08:38.852880 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2aca54f0>]}
2021-11-26 13:08:38.853049 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 13:08:38.854020 (MainThread): 
2021-11-26 13:08:38.854230 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:08:38.855076 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 13:08:38.861780 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 13:08:38.861949 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 13:08:38.862041 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 13:08:38.899672 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 13:08:38.901169 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 13:08:38.902195 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 13:08:38.906496 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:08:38.906618 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 13:08:38.906719 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 13:08:38.911491 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:38.911609 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:08:38.911701 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 13:08:38.918309 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 13:08:38.919216 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 13:08:38.919523 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 13:08:38.922987 (MainThread): Using postgres connection "master".
2021-11-26 13:08:38.923108 (MainThread): On master: BEGIN
2021-11-26 13:08:38.923212 (MainThread): Opening a new connection, currently in state init
2021-11-26 13:08:38.927807 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:38.927931 (MainThread): Using postgres connection "master".
2021-11-26 13:08:38.928026 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 13:08:38.977291 (MainThread): SQL status: SELECT 4 in 0.05 seconds
2021-11-26 13:08:38.978498 (MainThread): On master: ROLLBACK
2021-11-26 13:08:38.978867 (MainThread): Using postgres connection "master".
2021-11-26 13:08:38.979005 (MainThread): On master: BEGIN
2021-11-26 13:08:38.979553 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:38.979704 (MainThread): On master: COMMIT
2021-11-26 13:08:38.979834 (MainThread): Using postgres connection "master".
2021-11-26 13:08:38.979953 (MainThread): On master: COMMIT
2021-11-26 13:08:38.980324 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:08:38.980477 (MainThread): On master: Close
2021-11-26 13:08:38.980756 (MainThread): 14:08:38 | Concurrency: 10 threads (target='dev')
2021-11-26 13:08:38.980923 (MainThread): 14:08:38 | 
2021-11-26 13:08:38.984822 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:08:38.985071 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 13:08:38.985277 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 13:08:38.985435 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 13:08:38.985692 (Thread-1): 14:08:38 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 13:08:38.985920 (Thread-2): 14:08:38 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 13:08:38.986117 (Thread-3): 14:08:38 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 13:08:38.986401 (Thread-4): 14:08:38 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 13:08:38.986924 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:08:38.987313 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:08:38.987614 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:08:38.987817 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 13:08:38.988049 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:08:38.988184 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 13:08:38.988305 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 13:08:38.990605 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:08:38.990801 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 13:08:38.991811 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:08:38.992704 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:08:38.993861 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:08:38.994210 (Thread-1): finished collecting timing info
2021-11-26 13:08:39.000711 (Thread-3): finished collecting timing info
2021-11-26 13:08:39.020853 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:08:39.021066 (Thread-4): finished collecting timing info
2021-11-26 13:08:39.021203 (Thread-2): finished collecting timing info
2021-11-26 13:08:39.027708 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:08:39.029275 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:08:39.031445 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:08:39.031740 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:08:39.032020 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 13:08:39.032130 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:08:39.032439 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:08:39.032554 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:08:39.032799 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 13:08:39.032915 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:08:39.033018 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 13:08:39.033121 (Thread-4): Opening a new connection, currently in state init
2021-11-26 13:08:39.033213 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 13:08:39.033310 (Thread-3): Opening a new connection, currently in state init
2021-11-26 13:08:39.033508 (Thread-2): Opening a new connection, currently in state init
2021-11-26 13:08:39.036956 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:39.037200 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:08:39.037327 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:39.037438 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 13:08:39.037543 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:39.037661 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:08:39.037846 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:08:39.037967 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:39.038057 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 13:08:39.038152 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 13:08:39.038258 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:08:39.038498 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 13:08:39.039830 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 13:08:39.043919 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:08:39.044177 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:08:39.044276 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:08:39.044365 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 13:08:39.044445 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:08:39.045703 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:08:39.046970 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:08:39.048228 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:08:39.048338 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.048439 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 13:08:39.048534 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 13:08:39.048625 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 13:08:39.049856 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:08:39.050059 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 13:08:39.050285 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.051481 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:08:39.051589 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.051676 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.051755 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 13:08:39.051836 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.058724 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:08:39.060102 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:08:39.061277 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:08:39.061387 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.061495 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:08:39.061582 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 13:08:39.061688 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 13:08:39.062364 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:08:39.062470 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:08:39.062612 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:08:39.062726 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:08:39.062889 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.063528 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:08:39.063635 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:08:39.063724 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.063806 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:08:39.063878 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:08:39.066893 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:08:39.067544 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:08:39.067651 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:08:39.068512 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:08:39.068613 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 13:08:39.068702 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:08:39.068821 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 13:08:39.068939 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:08:39.069031 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:08:39.069945 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:08:39.070057 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:08:39.070142 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:08:39.070225 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 13:08:39.070315 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:08:39.071165 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:08:39.071803 (Thread-2): finished collecting timing info
2021-11-26 13:08:39.072508 (Thread-1): finished collecting timing info
2021-11-26 13:08:39.072621 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 13:08:39.072714 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:08:39.072830 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 13:08:39.072927 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 13:08:39.073498 (Thread-4): finished collecting timing info
2021-11-26 13:08:39.073635 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:08:39.073887 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb080b7130>]}
2021-11-26 13:08:39.074086 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2ace4e20>]}
2021-11-26 13:08:39.074198 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 13:08:39.074808 (Thread-3): finished collecting timing info
2021-11-26 13:08:39.075111 (Thread-2): 14:08:39 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 13:08:39.075300 (Thread-1): 14:08:39 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 13:08:39.075414 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 13:08:39.075594 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf8062490>]}
2021-11-26 13:08:39.075732 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 13:08:39.075888 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:08:39.076144 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf805cf40>]}
2021-11-26 13:08:39.076356 (Thread-4): 14:08:39 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 13:08:39.076679 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:08:39.076872 (Thread-3): 14:08:39 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 13:08:39.077003 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 13:08:39.077144 (Thread-6): 14:08:39 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 13:08:39.077309 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 13:08:39.077594 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:08:39.077792 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 13:08:39.079288 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:08:39.079454 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 13:08:39.079573 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 13:08:39.079749 (Thread-8): 14:08:39 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 13:08:39.079917 (Thread-9): 14:08:39 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 13:08:39.080023 (Thread-6): finished collecting timing info
2021-11-26 13:08:39.080230 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:08:39.080402 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:08:39.081749 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:08:39.081867 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 13:08:39.081970 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 13:08:39.084353 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:08:39.085677 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:08:39.085902 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:08:39.086009 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 13:08:39.086137 (Thread-6): Opening a new connection, currently in state init
2021-11-26 13:08:39.086330 (Thread-8): finished collecting timing info
2021-11-26 13:08:39.086429 (Thread-9): finished collecting timing info
2021-11-26 13:08:39.087663 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:08:39.089084 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:08:39.089646 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:08:39.089783 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:39.089893 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 13:08:39.090023 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:08:39.090129 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:08:39.090228 (Thread-9): Opening a new connection, currently in state init
2021-11-26 13:08:39.090312 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 13:08:39.090394 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 13:08:39.090603 (Thread-8): Opening a new connection, currently in state init
2021-11-26 13:08:39.092074 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:08:39.093547 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:08:39.093651 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 13:08:39.093972 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:39.094072 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.094167 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:39.094248 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:08:39.094885 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:08:39.094979 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:08:39.095066 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as(
    order_id,
    sum(amount) as amount

    from payments
    group by 1
)
select * from order_payments
  );
2021-11-26 13:08:39.095155 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:08:39.095235 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 13:08:39.095348 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:08:39.095555 (Thread-9): Postgres error: syntax error at or near "order_id"
LINE 16:     order_id,
             ^

2021-11-26 13:08:39.095656 (Thread-9): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 13:08:39.095740 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:08:39.096651 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:08:39.096755 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 13:08:39.096887 (Thread-9): finished collecting timing info
2021-11-26 13:08:39.097023 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 13:08:39.097124 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:08:39.098149 (Thread-6): finished collecting timing info
2021-11-26 13:08:39.098254 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 13:08:39.098383 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 13:08:39.099684 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:08:39.099980 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf807b370>]}
2021-11-26 13:08:39.100110 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 13:08:39.100441 (Thread-6): 14:08:39 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 13:08:39.100531 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.100724 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:08:39.101862 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:08:39.102055 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 13:08:39.102555 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:08:39.103311 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:08:39.103491 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:08:39.103599 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:08:39.104035 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:08:39.105101 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:08:39.105284 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 13:08:39.097337 (Thread-9): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "order_id"
LINE 16:     order_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:08:39.106606 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2acded00>]}
2021-11-26 13:08:39.106755 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:08:39.107059 (Thread-9): 14:08:39 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.03s]
2021-11-26 13:08:39.107848 (Thread-8): finished collecting timing info
2021-11-26 13:08:39.108025 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 13:08:39.108173 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 13:08:39.108839 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c98c90-c50f-4ea7-92d1-560ed7b65d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2ac78b50>]}
2021-11-26 13:08:39.109140 (Thread-8): 14:08:39 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 13:08:39.109257 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 13:08:39.110083 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:08:39.110227 (MainThread): Using postgres connection "master".
2021-11-26 13:08:39.110315 (MainThread): On master: BEGIN
2021-11-26 13:08:39.110404 (MainThread): Opening a new connection, currently in state closed
2021-11-26 13:08:39.113942 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:08:39.114095 (MainThread): On master: COMMIT
2021-11-26 13:08:39.114181 (MainThread): Using postgres connection "master".
2021-11-26 13:08:39.114261 (MainThread): On master: COMMIT
2021-11-26 13:08:39.114558 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:08:39.114674 (MainThread): On master: Close
2021-11-26 13:08:39.114945 (MainThread): 14:08:39 | 
2021-11-26 13:08:39.115068 (MainThread): 14:08:39 | Finished running 4 view models, 3 table models in 0.26s.
2021-11-26 13:08:39.115171 (MainThread): Connection 'master' was properly closed.
2021-11-26 13:08:39.115259 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 13:08:39.115339 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 13:08:39.115416 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 13:08:39.115493 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 13:08:39.115570 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 13:08:39.115647 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 13:08:39.115723 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 13:08:39.118783 (MainThread): 
2021-11-26 13:08:39.118919 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 13:08:39.119019 (MainThread): 
2021-11-26 13:08:39.119116 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 13:08:39.119208 (MainThread):   syntax error at or near "order_id"
2021-11-26 13:08:39.119295 (MainThread):   LINE 16:     order_id,
2021-11-26 13:08:39.119378 (MainThread):                ^
2021-11-26 13:08:39.119462 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:08:39.119562 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 13:08:39.119716 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb188637f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb18814ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0815f490>]}
2021-11-26 13:08:39.119871 (MainThread): Flushing usage events
2021-11-26 13:09:35.620681 (MainThread): Running with dbt=0.21.0
2021-11-26 13:09:35.684718 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 13:09:35.686459 (MainThread): Tracking: tracking
2021-11-26 13:09:35.712490 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ab1f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ab2fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ab00be0>]}
2021-11-26 13:09:35.720802 (MainThread): Partial parsing not enabled
2021-11-26 13:09:35.730660 (MainThread): Parsing macros/catalog.sql
2021-11-26 13:09:35.733316 (MainThread): Parsing macros/relations.sql
2021-11-26 13:09:35.734472 (MainThread): Parsing macros/adapters.sql
2021-11-26 13:09:35.752466 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 13:09:35.753686 (MainThread): Parsing macros/core.sql
2021-11-26 13:09:35.756300 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 13:09:35.761407 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 13:09:35.768589 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 13:09:35.769764 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 13:09:35.782206 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 13:09:35.811060 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 13:09:35.828870 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 13:09:35.830070 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 13:09:35.837802 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 13:09:35.854257 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 13:09:35.865738 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 13:09:35.872303 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 13:09:35.878109 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 13:09:35.880794 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 13:09:35.881799 (MainThread): Parsing macros/etc/query.sql
2021-11-26 13:09:35.882432 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 13:09:35.883486 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 13:09:35.889905 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 13:09:35.891115 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 13:09:35.892772 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 13:09:35.893840 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 13:09:35.939142 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 13:09:35.940277 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 13:09:35.941044 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 13:09:35.941928 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 13:09:36.055521 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:09:36.063417 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:09:36.065166 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:09:36.066816 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:09:36.069061 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:09:36.071239 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:09:36.073762 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:09:36.104066 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ad0fbe0>]}
2021-11-26 13:09:36.108083 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0accc910>]}
2021-11-26 13:09:36.108264 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 13:09:36.109240 (MainThread): 
2021-11-26 13:09:36.109446 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:09:36.110294 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 13:09:36.117011 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 13:09:36.117187 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 13:09:36.117286 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 13:09:36.160803 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 13:09:36.162278 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 13:09:36.163168 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 13:09:36.166800 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:09:36.166903 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 13:09:36.166993 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 13:09:36.171487 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.171597 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:09:36.171683 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 13:09:36.178268 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 13:09:36.179137 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 13:09:36.179448 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 13:09:36.182660 (MainThread): Using postgres connection "master".
2021-11-26 13:09:36.182782 (MainThread): On master: BEGIN
2021-11-26 13:09:36.182888 (MainThread): Opening a new connection, currently in state init
2021-11-26 13:09:36.187790 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.187920 (MainThread): Using postgres connection "master".
2021-11-26 13:09:36.188015 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 13:09:36.234808 (MainThread): SQL status: SELECT 4 in 0.05 seconds
2021-11-26 13:09:36.236055 (MainThread): On master: ROLLBACK
2021-11-26 13:09:36.236644 (MainThread): Using postgres connection "master".
2021-11-26 13:09:36.236780 (MainThread): On master: BEGIN
2021-11-26 13:09:36.237500 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.237643 (MainThread): On master: COMMIT
2021-11-26 13:09:36.237771 (MainThread): Using postgres connection "master".
2021-11-26 13:09:36.237889 (MainThread): On master: COMMIT
2021-11-26 13:09:36.238345 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:09:36.238500 (MainThread): On master: Close
2021-11-26 13:09:36.238794 (MainThread): 14:09:36 | Concurrency: 10 threads (target='dev')
2021-11-26 13:09:36.238959 (MainThread): 14:09:36 | 
2021-11-26 13:09:36.242649 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:09:36.242902 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 13:09:36.243105 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 13:09:36.243373 (Thread-1): 14:09:36 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 13:09:36.243518 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 13:09:36.243754 (Thread-2): 14:09:36 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 13:09:36.243965 (Thread-3): 14:09:36 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 13:09:36.244459 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:09:36.244709 (Thread-4): 14:09:36 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 13:09:36.245026 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:09:36.245338 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:09:36.245583 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 13:09:36.245879 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:09:36.245999 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 13:09:36.246126 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 13:09:36.248211 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:09:36.248371 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 13:09:36.249336 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:09:36.250209 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:09:36.251330 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:09:36.251754 (Thread-1): finished collecting timing info
2021-11-26 13:09:36.257223 (Thread-3): finished collecting timing info
2021-11-26 13:09:36.257528 (Thread-4): finished collecting timing info
2021-11-26 13:09:36.257657 (Thread-2): finished collecting timing info
2021-11-26 13:09:36.277989 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:09:36.283327 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:09:36.285255 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:09:36.286457 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:09:36.287151 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:09:36.287256 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 13:09:36.287352 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:09:36.287591 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:09:36.287703 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 13:09:36.287796 (Thread-3): Opening a new connection, currently in state init
2021-11-26 13:09:36.287983 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:09:36.288173 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 13:09:36.288281 (Thread-4): Opening a new connection, currently in state init
2021-11-26 13:09:36.288607 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:09:36.288722 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 13:09:36.288816 (Thread-2): Opening a new connection, currently in state init
2021-11-26 13:09:36.291375 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.291544 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.291658 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:09:36.291742 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.291831 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.291930 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:09:36.292021 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 13:09:36.292108 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:09:36.292189 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:09:36.292269 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 13:09:36.292377 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 13:09:36.292463 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 13:09:36.294087 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 13:09:36.298023 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:09:36.298147 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:09:36.298232 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:09:36.298316 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:09:36.298522 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 13:09:36.299713 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:09:36.300924 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:09:36.302121 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:09:36.302301 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 13:09:36.302393 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 13:09:36.302473 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 13:09:36.302601 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.303876 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:09:36.303984 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.304063 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 13:09:36.304134 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.304223 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.305284 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:09:36.306543 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:09:36.306649 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.307742 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:09:36.307841 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 13:09:36.307924 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 13:09:36.314381 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:09:36.314461 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 13:09:36.314607 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:09:36.314713 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:09:36.315384 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.315944 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:09:36.316036 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:09:36.316114 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:09:36.316211 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.316795 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:09:36.316889 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:09:36.316967 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:09:36.317034 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.317121 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:09:36.319674 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:09:36.319777 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:09:36.320446 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:09:36.321169 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:09:36.321272 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 13:09:36.321389 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:09:36.321468 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 13:09:36.321585 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:09:36.321697 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:09:36.322487 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:09:36.322576 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 13:09:36.322667 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:09:36.323422 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:09:36.323518 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 13:09:36.323615 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:09:36.324202 (Thread-2): finished collecting timing info
2021-11-26 13:09:36.324320 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 13:09:36.324411 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:09:36.324949 (Thread-1): finished collecting timing info
2021-11-26 13:09:36.325058 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 13:09:36.325153 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:09:36.325689 (Thread-4): finished collecting timing info
2021-11-26 13:09:36.325794 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 13:09:36.326020 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ad3d9a0>]}
2021-11-26 13:09:36.326233 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad187a9550>]}
2021-11-26 13:09:36.326450 (Thread-4): 14:09:36 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.08s]
2021-11-26 13:09:36.326641 (Thread-2): 14:09:36 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.08s]
2021-11-26 13:09:36.326830 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ad72ee0>]}
2021-11-26 13:09:36.326915 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:09:36.327100 (Thread-1): 14:09:36 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2021-11-26 13:09:36.327199 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 13:09:36.327797 (Thread-3): finished collecting timing info
2021-11-26 13:09:36.327909 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 13:09:36.328081 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:09:36.328186 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 13:09:36.328480 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:09:36.328667 (Thread-6): 14:09:36 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 13:09:36.328847 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:09:36.329030 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ad76910>]}
2021-11-26 13:09:36.329123 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 13:09:36.330517 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:09:36.330747 (Thread-3): 14:09:36 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.08s]
2021-11-26 13:09:36.330862 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 13:09:36.331129 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 13:09:36.331254 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 13:09:36.331399 (Thread-8): 14:09:36 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 13:09:36.331496 (Thread-6): finished collecting timing info
2021-11-26 13:09:36.331651 (Thread-9): 14:09:36 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 13:09:36.331885 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:09:36.334153 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:09:36.334303 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 13:09:36.334467 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:09:36.336036 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:09:36.336151 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 13:09:36.337773 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:09:36.337988 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:09:36.338217 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 13:09:36.338342 (Thread-6): Opening a new connection, currently in state init
2021-11-26 13:09:36.338561 (Thread-8): finished collecting timing info
2021-11-26 13:09:36.340320 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:09:36.340478 (Thread-9): finished collecting timing info
2021-11-26 13:09:36.341675 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:09:36.341915 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:09:36.342029 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:09:36.342109 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 13:09:36.342195 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 13:09:36.342288 (Thread-8): Opening a new connection, currently in state init
2021-11-26 13:09:36.342373 (Thread-9): Opening a new connection, currently in state init
2021-11-26 13:09:36.343412 (Thread-6): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:09:36.343507 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:09:36.343587 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 13:09:36.346454 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.346547 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.346633 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:09:36.346718 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:09:36.346807 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:09:36.346881 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as(
    order_id,
    sum(amount) as amount

    from payments
    group by 1
)
select * from order_payments
  );
2021-11-26 13:09:36.346964 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 13:09:36.348122 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:09:36.348280 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 13:09:36.348549 (Thread-9): Postgres error: syntax error at or near "order_id"
LINE 16:     order_id,
             ^

2021-11-26 13:09:36.348638 (Thread-9): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 13:09:36.348821 (Thread-9): finished collecting timing info
2021-11-26 13:09:36.348913 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.348999 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 13:09:36.349598 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:09:36.349990 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:09:36.350207 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:09:36.350787 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:09:36.351545 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:09:36.351664 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 13:09:36.352063 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:09:36.352656 (Thread-6): finished collecting timing info
2021-11-26 13:09:36.352811 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 13:09:36.353017 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ad5e1f0>]}
2021-11-26 13:09:36.353298 (Thread-6): 14:09:36 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 13:09:36.353413 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:09:36.349801 (Thread-9): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "order_id"
LINE 16:     order_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:09:36.355572 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ad52580>]}
2021-11-26 13:09:36.355911 (Thread-9): 14:09:36 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.02s]
2021-11-26 13:09:36.356039 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 13:09:36.356477 (Thread-8): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 13:09:36.358201 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:09:36.358311 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 13:09:36.359122 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.360167 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:09:36.360254 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 13:09:36.360996 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:09:36.361615 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:09:36.361703 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:09:36.361778 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:09:36.362240 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:09:36.363080 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:09:36.363175 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 13:09:36.365423 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:09:36.365983 (Thread-8): finished collecting timing info
2021-11-26 13:09:36.366094 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 13:09:36.366318 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5eb433-d678-4d02-90cc-45715f81a25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad18745a30>]}
2021-11-26 13:09:36.366526 (Thread-8): 14:09:36 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 13:09:36.366628 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 13:09:36.367445 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:09:36.367579 (MainThread): Using postgres connection "master".
2021-11-26 13:09:36.367667 (MainThread): On master: BEGIN
2021-11-26 13:09:36.367756 (MainThread): Opening a new connection, currently in state closed
2021-11-26 13:09:36.371316 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:09:36.371543 (MainThread): On master: COMMIT
2021-11-26 13:09:36.371630 (MainThread): Using postgres connection "master".
2021-11-26 13:09:36.371712 (MainThread): On master: COMMIT
2021-11-26 13:09:36.371926 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:09:36.372032 (MainThread): On master: Close
2021-11-26 13:09:36.372346 (MainThread): 14:09:36 | 
2021-11-26 13:09:36.372466 (MainThread): 14:09:36 | Finished running 4 view models, 3 table models in 0.26s.
2021-11-26 13:09:36.372560 (MainThread): Connection 'master' was properly closed.
2021-11-26 13:09:36.372642 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 13:09:36.372722 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 13:09:36.372798 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 13:09:36.372873 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 13:09:36.372947 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 13:09:36.373021 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 13:09:36.373095 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 13:09:36.376553 (MainThread): 
2021-11-26 13:09:36.376711 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 13:09:36.376810 (MainThread): 
2021-11-26 13:09:36.376909 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 13:09:36.376999 (MainThread):   syntax error at or near "order_id"
2021-11-26 13:09:36.377082 (MainThread):   LINE 16:     order_id,
2021-11-26 13:09:36.377165 (MainThread):                ^
2021-11-26 13:09:36.377246 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:09:36.377345 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 13:09:36.377503 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0acec880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad186eab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0ad0ffa0>]}
2021-11-26 13:09:36.377663 (MainThread): Flushing usage events
2021-11-26 13:10:22.089682 (MainThread): Running with dbt=0.21.0
2021-11-26 13:10:22.153975 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 13:10:22.155938 (MainThread): Tracking: tracking
2021-11-26 13:10:22.181516 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2c57e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2c67b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0804d7f70>]}
2021-11-26 13:10:22.190108 (MainThread): Partial parsing not enabled
2021-11-26 13:10:22.200055 (MainThread): Parsing macros/catalog.sql
2021-11-26 13:10:22.202947 (MainThread): Parsing macros/relations.sql
2021-11-26 13:10:22.204161 (MainThread): Parsing macros/adapters.sql
2021-11-26 13:10:22.221403 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 13:10:22.222627 (MainThread): Parsing macros/core.sql
2021-11-26 13:10:22.225198 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 13:10:22.230194 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 13:10:22.237175 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 13:10:22.238320 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 13:10:22.250600 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 13:10:22.278050 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 13:10:22.295262 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 13:10:22.296457 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 13:10:22.304030 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 13:10:22.319700 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 13:10:22.330382 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 13:10:22.336474 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 13:10:22.342086 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 13:10:22.344742 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 13:10:22.345725 (MainThread): Parsing macros/etc/query.sql
2021-11-26 13:10:22.346352 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 13:10:22.347384 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 13:10:22.353642 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 13:10:22.354822 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 13:10:22.356471 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 13:10:22.357518 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 13:10:22.400382 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 13:10:22.401509 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 13:10:22.402280 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 13:10:22.403159 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 13:10:22.516812 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:22.524612 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:22.526306 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:22.527989 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:22.530204 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:22.532358 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:22.537963 (MainThread): 1699: statically parsed Marts/fct_orders.sql
2021-11-26 13:10:22.538098 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:10:22.539995 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2e1c6a0>]}
2021-11-26 13:10:22.568762 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc080567ca0>]}
2021-11-26 13:10:22.572359 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2e30d00>]}
2021-11-26 13:10:22.572538 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 13:10:22.573532 (MainThread): 
2021-11-26 13:10:22.573738 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:10:22.574566 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 13:10:22.581037 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 13:10:22.581197 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 13:10:22.581290 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 13:10:22.628315 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 13:10:22.629807 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 13:10:22.630894 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 13:10:22.635353 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:10:22.635487 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 13:10:22.635600 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 13:10:22.640833 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:22.640962 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:10:22.641063 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 13:10:22.647528 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 13:10:22.648458 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 13:10:22.648709 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 13:10:22.652215 (MainThread): Using postgres connection "master".
2021-11-26 13:10:22.652355 (MainThread): On master: BEGIN
2021-11-26 13:10:22.652469 (MainThread): Opening a new connection, currently in state init
2021-11-26 13:10:22.657169 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:22.657314 (MainThread): Using postgres connection "master".
2021-11-26 13:10:22.657421 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 13:10:22.711125 (MainThread): SQL status: SELECT 4 in 0.05 seconds
2021-11-26 13:10:22.712293 (MainThread): On master: ROLLBACK
2021-11-26 13:10:22.712715 (MainThread): Using postgres connection "master".
2021-11-26 13:10:22.712852 (MainThread): On master: BEGIN
2021-11-26 13:10:22.713571 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:22.713721 (MainThread): On master: COMMIT
2021-11-26 13:10:22.713847 (MainThread): Using postgres connection "master".
2021-11-26 13:10:22.713995 (MainThread): On master: COMMIT
2021-11-26 13:10:22.714421 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:22.714564 (MainThread): On master: Close
2021-11-26 13:10:22.714853 (MainThread): 14:10:22 | Concurrency: 10 threads (target='dev')
2021-11-26 13:10:22.715017 (MainThread): 14:10:22 | 
2021-11-26 13:10:22.718749 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:10:22.719012 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 13:10:22.719279 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 13:10:22.719440 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 13:10:22.719714 (Thread-1): 14:10:22 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 13:10:22.719966 (Thread-2): 14:10:22 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 13:10:22.720173 (Thread-3): 14:10:22 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 13:10:22.720369 (Thread-4): 14:10:22 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 13:10:22.720827 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:22.721131 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:22.721544 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:22.721789 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:22.722055 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 13:10:22.722198 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 13:10:22.722329 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 13:10:22.722506 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 13:10:22.724916 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:10:22.726024 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:10:22.727053 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:10:22.728114 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:10:22.728655 (Thread-2): finished collecting timing info
2021-11-26 13:10:22.741288 (Thread-1): finished collecting timing info
2021-11-26 13:10:22.747483 (Thread-3): finished collecting timing info
2021-11-26 13:10:22.747613 (Thread-4): finished collecting timing info
2021-11-26 13:10:22.749065 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:10:22.762975 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:10:22.763738 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:10:22.765602 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:10:22.766089 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:22.766195 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 13:10:22.766291 (Thread-3): Opening a new connection, currently in state init
2021-11-26 13:10:22.766393 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:22.766579 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:22.766696 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 13:10:22.766813 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:22.766904 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 13:10:22.766988 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:10:22.767083 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 13:10:22.767186 (Thread-2): Opening a new connection, currently in state init
2021-11-26 13:10:22.767370 (Thread-4): Opening a new connection, currently in state init
2021-11-26 13:10:22.769808 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:22.769976 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:22.770066 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 13:10:22.770614 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:22.770726 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:22.770843 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:22.770944 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:22.771044 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:22.771158 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:22.771256 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 13:10:22.771344 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 13:10:22.771480 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 13:10:22.772663 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:10:22.776740 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:22.776881 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 13:10:22.776985 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:10:22.777073 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 13:10:22.777153 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:10:22.778334 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:22.779572 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:22.780756 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:22.780864 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.780950 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 13:10:22.781038 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 13:10:22.781124 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 13:10:22.782207 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:22.782399 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 13:10:22.782565 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.783614 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:22.783786 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.783869 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 13:10:22.783942 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.784037 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.785058 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:22.786203 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:22.786308 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.790507 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:10:22.790627 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 13:10:22.790717 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 13:10:22.793768 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:10:22.793877 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:22.794045 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:22.794141 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:10:22.794223 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:10:22.794376 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.794487 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.795067 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:10:22.795162 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:22.795722 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:10:22.795801 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:22.795891 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:22.798477 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:22.798586 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:22.799426 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:22.799534 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:10:22.799627 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 13:10:22.799717 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:10:22.799797 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 13:10:22.800097 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:22.800191 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:22.801027 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:22.801135 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:10:22.801928 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:22.802048 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:10:22.802124 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 13:10:22.802737 (Thread-3): finished collecting timing info
2021-11-26 13:10:22.802840 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 13:10:22.803371 (Thread-1): finished collecting timing info
2021-11-26 13:10:22.803513 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 13:10:22.803655 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 13:10:22.803928 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2f1ffd0>]}
2021-11-26 13:10:22.804142 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2e10f70>]}
2021-11-26 13:10:22.804382 (Thread-3): 14:10:22 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.08s]
2021-11-26 13:10:22.804601 (Thread-1): 14:10:22 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2021-11-26 13:10:22.804705 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:10:22.804792 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:10:22.804904 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 13:10:22.805014 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:10:22.805731 (Thread-4): finished collecting timing info
2021-11-26 13:10:22.806322 (Thread-2): finished collecting timing info
2021-11-26 13:10:22.806611 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 13:10:22.806769 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 13:10:22.806861 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:10:22.807145 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2eabf40>]}
2021-11-26 13:10:22.807312 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2f2b6a0>]}
2021-11-26 13:10:22.807456 (Thread-6): 14:10:22 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 13:10:22.807698 (Thread-2): 14:10:22 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 13:10:22.807891 (Thread-4): 14:10:22 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 13:10:22.808120 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:22.808258 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 13:10:22.808379 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 13:10:22.808485 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 13:10:22.809062 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 13:10:22.809215 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 13:10:22.811192 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:10:22.811416 (Thread-8): 14:10:22 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 13:10:22.811565 (Thread-9): 14:10:22 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 13:10:22.811863 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:22.812340 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:10:22.812453 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 13:10:22.812569 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 13:10:22.812681 (Thread-6): finished collecting timing info
2021-11-26 13:10:22.814186 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:10:22.816430 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:10:22.817605 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:10:22.817911 (Thread-8): finished collecting timing info
2021-11-26 13:10:22.818013 (Thread-9): finished collecting timing info
2021-11-26 13:10:22.818138 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:22.819261 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:10:22.820258 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:10:22.820363 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 13:10:22.820573 (Thread-6): Opening a new connection, currently in state init
2021-11-26 13:10:22.820782 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:22.820890 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 13:10:22.820995 (Thread-8): Opening a new connection, currently in state init
2021-11-26 13:10:22.821097 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:10:22.821264 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 13:10:22.821356 (Thread-9): Opening a new connection, currently in state init
2021-11-26 13:10:22.826390 (Thread-6): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:22.826555 (Thread-8): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:22.826653 (Thread-9): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:22.826751 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:22.826842 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:22.826922 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:10:22.827006 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 13:10:22.827098 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 13:10:22.827193 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as(
    order_id,
    sum(amount) as amount

    from payments
    group by 1
)
select * from order_payments
  );
2021-11-26 13:10:22.827615 (Thread-9): Postgres error: syntax error at or near "order_id"
LINE 16:     order_id,
             ^

2021-11-26 13:10:22.827707 (Thread-9): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 13:10:22.827897 (Thread-9): finished collecting timing info
2021-11-26 13:10:22.827999 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 13:10:22.830678 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:10:22.831963 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:22.832064 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 13:10:22.828216 (Thread-9): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "order_id"
LINE 16:     order_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "order_id"
  LINE 16:     order_id,
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:10:22.832931 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2f2b760>]}
2021-11-26 13:10:22.833023 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.833232 (Thread-9): 14:10:22 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.02s]
2021-11-26 13:10:22.833805 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:10:22.833926 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 13:10:22.834036 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:22.834282 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:10:22.834966 (Thread-8): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 13:10:22.835057 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:22.836353 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:22.837192 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:22.837311 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 13:10:22.837406 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 13:10:22.837813 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:10:22.838507 (Thread-6): finished collecting timing info
2021-11-26 13:10:22.838652 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.838774 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 13:10:22.839998 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:22.840167 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 13:10:22.840443 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2f423a0>]}
2021-11-26 13:10:22.840761 (Thread-6): 14:10:22 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 13:10:22.840887 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:10:22.841460 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:22.842162 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:10:22.842251 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:22.842327 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:10:22.842824 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:22.843760 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:22.843855 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 13:10:22.846342 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:10:22.846904 (Thread-8): finished collecting timing info
2021-11-26 13:10:22.847012 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 13:10:22.847222 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a8e8d79-810d-4f6b-a400-aa24f37a8a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2e06640>]}
2021-11-26 13:10:22.847420 (Thread-8): 14:10:22 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 13:10:22.847523 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 13:10:22.848358 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:10:22.848479 (MainThread): Using postgres connection "master".
2021-11-26 13:10:22.848562 (MainThread): On master: BEGIN
2021-11-26 13:10:22.848644 (MainThread): Opening a new connection, currently in state closed
2021-11-26 13:10:22.853700 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:22.853820 (MainThread): On master: COMMIT
2021-11-26 13:10:22.853911 (MainThread): Using postgres connection "master".
2021-11-26 13:10:22.853996 (MainThread): On master: COMMIT
2021-11-26 13:10:22.854234 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:22.854338 (MainThread): On master: Close
2021-11-26 13:10:22.854581 (MainThread): 14:10:22 | 
2021-11-26 13:10:22.854699 (MainThread): 14:10:22 | Finished running 4 view models, 3 table models in 0.28s.
2021-11-26 13:10:22.854797 (MainThread): Connection 'master' was properly closed.
2021-11-26 13:10:22.854882 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 13:10:22.854964 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 13:10:22.855043 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 13:10:22.855123 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 13:10:22.855203 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 13:10:22.855282 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 13:10:22.855363 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 13:10:22.859273 (MainThread): 
2021-11-26 13:10:22.859445 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 13:10:22.859548 (MainThread): 
2021-11-26 13:10:22.859648 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 13:10:22.859739 (MainThread):   syntax error at or near "order_id"
2021-11-26 13:10:22.859824 (MainThread):   LINE 16:     order_id,
2021-11-26 13:10:22.859908 (MainThread):                ^
2021-11-26 13:10:22.859990 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:10:22.860087 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 13:10:22.860244 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc080543940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a2c67b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a0e1f910>]}
2021-11-26 13:10:22.860400 (MainThread): Flushing usage events
2021-11-26 13:10:53.985995 (MainThread): Running with dbt=0.21.0
2021-11-26 13:10:54.050623 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 13:10:54.052404 (MainThread): Tracking: tracking
2021-11-26 13:10:54.080493 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecac4f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecac5e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ea8194a30>]}
2021-11-26 13:10:54.088905 (MainThread): Partial parsing not enabled
2021-11-26 13:10:54.098463 (MainThread): Parsing macros/catalog.sql
2021-11-26 13:10:54.100985 (MainThread): Parsing macros/relations.sql
2021-11-26 13:10:54.102007 (MainThread): Parsing macros/adapters.sql
2021-11-26 13:10:54.118504 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 13:10:54.119687 (MainThread): Parsing macros/core.sql
2021-11-26 13:10:54.122266 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 13:10:54.127148 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 13:10:54.133967 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 13:10:54.135099 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 13:10:54.147253 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 13:10:54.173783 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 13:10:54.190832 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 13:10:54.192176 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 13:10:54.199837 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 13:10:54.215114 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 13:10:54.225561 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 13:10:54.231520 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 13:10:54.237047 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 13:10:54.239660 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 13:10:54.240636 (MainThread): Parsing macros/etc/query.sql
2021-11-26 13:10:54.241285 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 13:10:54.242313 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 13:10:54.248399 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 13:10:54.249652 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 13:10:54.251295 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 13:10:54.252344 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 13:10:54.293512 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 13:10:54.294625 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 13:10:54.295381 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 13:10:54.296252 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 13:10:54.410553 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:54.418303 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:54.420007 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:54.421649 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:54.423855 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:54.426032 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:54.428582 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:10:54.458731 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecae80bb0>]}
2021-11-26 13:10:54.462365 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecae23550>]}
2021-11-26 13:10:54.462545 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 13:10:54.463527 (MainThread): 
2021-11-26 13:10:54.463735 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:10:54.464638 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 13:10:54.471289 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 13:10:54.471450 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 13:10:54.471538 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 13:10:54.515345 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 13:10:54.516979 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 13:10:54.518013 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 13:10:54.522500 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:10:54.522635 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 13:10:54.522745 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 13:10:54.527984 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:54.528105 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:10:54.528199 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 13:10:54.534907 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 13:10:54.535836 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 13:10:54.536179 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 13:10:54.539588 (MainThread): Using postgres connection "master".
2021-11-26 13:10:54.539712 (MainThread): On master: BEGIN
2021-11-26 13:10:54.539817 (MainThread): Opening a new connection, currently in state init
2021-11-26 13:10:54.544909 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:54.545024 (MainThread): Using postgres connection "master".
2021-11-26 13:10:54.545120 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 13:10:54.604116 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 13:10:54.605467 (MainThread): On master: ROLLBACK
2021-11-26 13:10:54.605874 (MainThread): Using postgres connection "master".
2021-11-26 13:10:54.606029 (MainThread): On master: BEGIN
2021-11-26 13:10:54.607761 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:54.607930 (MainThread): On master: COMMIT
2021-11-26 13:10:54.608075 (MainThread): Using postgres connection "master".
2021-11-26 13:10:54.608217 (MainThread): On master: COMMIT
2021-11-26 13:10:54.608694 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:54.608863 (MainThread): On master: Close
2021-11-26 13:10:54.609177 (MainThread): 14:10:54 | Concurrency: 10 threads (target='dev')
2021-11-26 13:10:54.609381 (MainThread): 14:10:54 | 
2021-11-26 13:10:54.612980 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:10:54.613204 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 13:10:54.613412 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 13:10:54.613625 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 13:10:54.613992 (Thread-1): 14:10:54 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 13:10:54.614252 (Thread-2): 14:10:54 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 13:10:54.614478 (Thread-3): 14:10:54 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 13:10:54.614683 (Thread-4): 14:10:54 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 13:10:54.615152 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:54.615486 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:54.615771 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:54.616037 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:54.616267 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 13:10:54.616418 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 13:10:54.616551 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 13:10:54.616679 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 13:10:54.619015 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:10:54.620119 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:10:54.621102 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:10:54.622171 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:10:54.623099 (Thread-1): finished collecting timing info
2021-11-26 13:10:54.623322 (Thread-2): finished collecting timing info
2021-11-26 13:10:54.623477 (Thread-4): finished collecting timing info
2021-11-26 13:10:54.628760 (Thread-3): finished collecting timing info
2021-11-26 13:10:54.656873 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:10:54.660250 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:10:54.661111 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:10:54.662445 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:10:54.663014 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:54.663133 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:54.663240 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:54.663345 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 13:10:54.663434 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 13:10:54.663533 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:54.663615 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 13:10:54.663703 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:10:54.663793 (Thread-4): Opening a new connection, currently in state init
2021-11-26 13:10:54.663881 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 13:10:54.663964 (Thread-2): Opening a new connection, currently in state init
2021-11-26 13:10:54.664223 (Thread-3): Opening a new connection, currently in state init
2021-11-26 13:10:54.668299 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:54.668472 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:54.668583 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:54.668683 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:54.668793 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:54.668880 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:54.668963 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 13:10:54.669044 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:54.669137 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 13:10:54.669231 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 13:10:54.669356 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:54.669867 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 13:10:54.672323 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:10:54.676475 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:54.676642 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 13:10:54.676738 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 13:10:54.676827 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:10:54.676920 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:10:54.678090 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:54.679421 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:54.680604 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:54.680693 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.680788 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 13:10:54.680874 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 13:10:54.680965 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 13:10:54.682090 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:54.682267 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 13:10:54.682792 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.683851 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:54.683951 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 13:10:54.684086 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.684260 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.685401 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:54.685493 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.686724 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:54.686856 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.686974 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 13:10:54.691324 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:10:54.691503 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 13:10:54.694693 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:10:54.694866 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:54.694987 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:54.695076 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:10:54.695158 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:10:54.695603 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.696172 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:10:54.696267 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:54.696348 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:10:54.696449 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.697026 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:10:54.697126 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:54.697207 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:10:54.697308 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:54.699857 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:10:54.699960 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 13:10:54.700064 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:54.700873 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:10:54.700962 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 13:10:54.701057 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:54.701786 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:10:54.701875 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 13:10:54.701973 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:54.702729 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:10:54.702815 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 13:10:54.702909 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:10:54.703498 (Thread-3): finished collecting timing info
2021-11-26 13:10:54.703610 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 13:10:54.703839 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecaead3d0>]}
2021-11-26 13:10:54.703941 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:10:54.704503 (Thread-2): finished collecting timing info
2021-11-26 13:10:54.704614 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 13:10:54.704842 (Thread-3): 14:10:54 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 13:10:54.705048 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ea86b5ac0>]}
2021-11-26 13:10:54.705164 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:10:54.705747 (Thread-1): finished collecting timing info
2021-11-26 13:10:54.705859 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 13:10:54.705975 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 13:10:54.706182 (Thread-2): 14:10:54 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 13:10:54.706280 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 13:10:54.706497 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:10:54.707180 (Thread-4): finished collecting timing info
2021-11-26 13:10:54.707318 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 13:10:54.707571 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ea86b5b20>]}
2021-11-26 13:10:54.707808 (Thread-4): 14:10:54 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 13:10:54.707929 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 13:10:54.708266 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ea86ad130>]}
2021-11-26 13:10:54.708518 (Thread-1): 14:10:54 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 13:10:54.708645 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:10:54.709291 (Thread-6): Began running node model.demo_dbt.dim_customers
2021-11-26 13:10:54.709501 (Thread-6): 14:10:54 | 5 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 13:10:54.709756 (Thread-6): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:54.709867 (Thread-6): Compiling model.demo_dbt.dim_customers
2021-11-26 13:10:54.712020 (Thread-6): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:10:54.712655 (Thread-6): finished collecting timing info
2021-11-26 13:10:54.715666 (Thread-6): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:10:54.716102 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:54.716198 (Thread-6): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 13:10:54.716296 (Thread-6): Opening a new connection, currently in state init
2021-11-26 13:10:54.716946 (Thread-7): Began running node model.demo_dbt.fct_orders
2021-11-26 13:10:54.717171 (Thread-7): 14:10:54 | 6 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 13:10:54.717421 (Thread-7): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:10:54.717526 (Thread-7): Compiling model.demo_dbt.fct_orders
2021-11-26 13:10:54.719369 (Thread-7): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:10:54.719761 (Thread-7): finished collecting timing info
2021-11-26 13:10:54.721210 (Thread-7): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:10:54.721603 (Thread-7): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:10:54.721697 (Thread-7): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 13:10:54.721789 (Thread-7): Opening a new connection, currently in state init
2021-11-26 13:10:54.722155 (Thread-8): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:10:54.722397 (Thread-8): 14:10:54 | 7 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 13:10:54.722680 (Thread-8): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:54.722790 (Thread-8): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 13:10:54.724447 (Thread-8): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:10:54.725378 (Thread-8): finished collecting timing info
2021-11-26 13:10:54.727213 (Thread-8): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:10:54.727377 (Thread-6): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:54.727533 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:54.727640 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 13:10:54.727813 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:54.727904 (Thread-8): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 13:10:54.727992 (Thread-8): Opening a new connection, currently in state init
2021-11-26 13:10:54.729905 (Thread-7): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:54.730097 (Thread-7): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:10:54.730186 (Thread-7): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
)

select * from order_payments
  );
2021-11-26 13:10:54.731478 (Thread-7): Postgres error: relation "order_payments" does not exist
LINE 15: select * from order_payments
                       ^

2021-11-26 13:10:54.731970 (Thread-7): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 13:10:54.732537 (Thread-7): finished collecting timing info
2021-11-26 13:10:54.732738 (Thread-7): On model.demo_dbt.fct_orders: Close
2021-11-26 13:10:54.733961 (Thread-8): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:10:54.734242 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:54.734350 (Thread-8): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 13:10:54.734805 (Thread-6): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 13:10:54.736246 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:54.736451 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 13:10:54.737183 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.738851 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:54.739138 (Thread-8): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:10:54.739267 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 13:10:54.740988 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:54.741279 (Thread-8): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 13:10:54.742036 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.742167 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:10:54.742854 (Thread-6): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:10:54.733023 (Thread-7): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  relation "order_payments" does not exist
  LINE 15: select * from order_payments
                         ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "order_payments" does not exist
LINE 15: select * from order_payments
                       ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  relation "order_payments" does not exist
  LINE 15: select * from order_payments
                         ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:10:54.743515 (Thread-8): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:10:54.743610 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:54.743792 (Thread-7): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecaec9b80>]}
2021-11-26 13:10:54.743901 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:54.743989 (Thread-6): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:10:54.744216 (Thread-7): 14:10:54 | 6 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.03s]
2021-11-26 13:10:54.744289 (Thread-8): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:10:54.744439 (Thread-7): Finished running node model.demo_dbt.fct_orders
2021-11-26 13:10:54.744729 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:54.744827 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:54.745579 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:10:54.746429 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:10:54.746526 (Thread-8): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 13:10:54.746608 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 13:10:54.746889 (Thread-8): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:10:54.747464 (Thread-8): finished collecting timing info
2021-11-26 13:10:54.747575 (Thread-8): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 13:10:54.747778 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ea8695c10>]}
2021-11-26 13:10:54.747952 (Thread-8): 14:10:54 | 7 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 13:10:54.748050 (Thread-8): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:10:54.748665 (Thread-6): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:10:54.749217 (Thread-6): finished collecting timing info
2021-11-26 13:10:54.749322 (Thread-6): On model.demo_dbt.dim_customers: Close
2021-11-26 13:10:54.749515 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3635671-c74e-4d83-8503-cc723d2b9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecae13af0>]}
2021-11-26 13:10:54.749693 (Thread-6): 14:10:54 | 5 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 13:10:54.749791 (Thread-6): Finished running node model.demo_dbt.dim_customers
2021-11-26 13:10:54.750529 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:10:54.750655 (MainThread): Using postgres connection "master".
2021-11-26 13:10:54.750739 (MainThread): On master: BEGIN
2021-11-26 13:10:54.750825 (MainThread): Opening a new connection, currently in state closed
2021-11-26 13:10:54.755595 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:10:54.755815 (MainThread): On master: COMMIT
2021-11-26 13:10:54.755906 (MainThread): Using postgres connection "master".
2021-11-26 13:10:54.755992 (MainThread): On master: COMMIT
2021-11-26 13:10:54.756230 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:10:54.756331 (MainThread): On master: Close
2021-11-26 13:10:54.756617 (MainThread): 14:10:54 | 
2021-11-26 13:10:54.756748 (MainThread): 14:10:54 | Finished running 4 view models, 3 table models in 0.29s.
2021-11-26 13:10:54.756852 (MainThread): Connection 'master' was properly closed.
2021-11-26 13:10:54.756934 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 13:10:54.757013 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 13:10:54.757092 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 13:10:54.757169 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 13:10:54.757247 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 13:10:54.757326 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 13:10:54.757403 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 13:10:54.760581 (MainThread): 
2021-11-26 13:10:54.760711 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 13:10:54.760808 (MainThread): 
2021-11-26 13:10:54.760907 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 13:10:54.761000 (MainThread):   relation "order_payments" does not exist
2021-11-26 13:10:54.761084 (MainThread):   LINE 15: select * from order_payments
2021-11-26 13:10:54.761168 (MainThread):                          ^
2021-11-26 13:10:54.761253 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 13:10:54.761355 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 13:10:54.761509 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ea8194940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecae4fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecae80af0>]}
2021-11-26 13:10:54.761666 (MainThread): Flushing usage events
2021-11-26 13:11:13.652084 (MainThread): Running with dbt=0.21.0
2021-11-26 13:11:13.715868 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 13:11:13.717602 (MainThread): Tracking: tracking
2021-11-26 13:11:13.745239 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7788af7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7788bd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78827ca30>]}
2021-11-26 13:11:13.753944 (MainThread): Partial parsing not enabled
2021-11-26 13:11:13.763182 (MainThread): Parsing macros/catalog.sql
2021-11-26 13:11:13.765666 (MainThread): Parsing macros/relations.sql
2021-11-26 13:11:13.766726 (MainThread): Parsing macros/adapters.sql
2021-11-26 13:11:13.783685 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 13:11:13.784861 (MainThread): Parsing macros/core.sql
2021-11-26 13:11:13.787418 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 13:11:13.792339 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 13:11:13.799217 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 13:11:13.800351 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 13:11:13.812491 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 13:11:13.839954 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 13:11:13.857005 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 13:11:13.858199 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 13:11:13.865713 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 13:11:13.881333 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 13:11:13.892429 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 13:11:13.898690 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 13:11:13.904323 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 13:11:13.906953 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 13:11:13.907942 (MainThread): Parsing macros/etc/query.sql
2021-11-26 13:11:13.908564 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 13:11:13.909592 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 13:11:13.915777 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 13:11:13.916953 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 13:11:13.918585 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 13:11:13.919642 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 13:11:13.962403 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 13:11:13.963578 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 13:11:13.964368 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 13:11:13.965260 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 13:11:14.078893 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:11:14.086720 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:11:14.088414 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:11:14.090078 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:11:14.092306 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:11:14.094498 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:11:14.097045 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:11:14.127159 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7789e0bb0>]}
2021-11-26 13:11:14.130805 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7789894f0>]}
2021-11-26 13:11:14.130981 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 13:11:14.131975 (MainThread): 
2021-11-26 13:11:14.132188 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:11:14.133020 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 13:11:14.139941 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 13:11:14.140116 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 13:11:14.140215 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 13:11:14.192391 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 13:11:14.194155 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 13:11:14.195311 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 13:11:14.199995 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:11:14.200126 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 13:11:14.200236 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 13:11:14.205330 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:11:14.205456 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 13:11:14.205554 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 13:11:14.211947 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.01 seconds
2021-11-26 13:11:14.212892 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 13:11:14.213283 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 13:11:14.216801 (MainThread): Using postgres connection "master".
2021-11-26 13:11:14.216937 (MainThread): On master: BEGIN
2021-11-26 13:11:14.217049 (MainThread): Opening a new connection, currently in state init
2021-11-26 13:11:14.222172 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:11:14.222306 (MainThread): Using postgres connection "master".
2021-11-26 13:11:14.222407 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 13:11:14.276176 (MainThread): SQL status: SELECT 4 in 0.05 seconds
2021-11-26 13:11:14.277390 (MainThread): On master: ROLLBACK
2021-11-26 13:11:14.277968 (MainThread): Using postgres connection "master".
2021-11-26 13:11:14.278102 (MainThread): On master: BEGIN
2021-11-26 13:11:14.278833 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:11:14.278976 (MainThread): On master: COMMIT
2021-11-26 13:11:14.279104 (MainThread): Using postgres connection "master".
2021-11-26 13:11:14.279219 (MainThread): On master: COMMIT
2021-11-26 13:11:14.279563 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.279716 (MainThread): On master: Close
2021-11-26 13:11:14.279996 (MainThread): 14:11:14 | Concurrency: 10 threads (target='dev')
2021-11-26 13:11:14.280159 (MainThread): 14:11:14 | 
2021-11-26 13:11:14.283981 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:11:14.284278 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 13:11:14.284515 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 13:11:14.284841 (Thread-1): 14:11:14 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 13:11:14.285003 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 13:11:14.285262 (Thread-2): 14:11:14 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 13:11:14.285709 (Thread-3): 14:11:14 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 13:11:14.286287 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:11:14.286588 (Thread-4): 14:11:14 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 13:11:14.287027 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:11:14.287306 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:11:14.287554 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 13:11:14.287966 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:11:14.288135 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 13:11:14.288297 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 13:11:14.290804 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:11:14.290996 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 13:11:14.292089 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:11:14.293194 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:11:14.294461 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:11:14.295178 (Thread-3): finished collecting timing info
2021-11-26 13:11:14.295340 (Thread-2): finished collecting timing info
2021-11-26 13:11:14.295465 (Thread-1): finished collecting timing info
2021-11-26 13:11:14.301116 (Thread-4): finished collecting timing info
2021-11-26 13:11:14.316502 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 13:11:14.317289 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 13:11:14.331889 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 13:11:14.332423 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 13:11:14.332881 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:11:14.333004 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:11:14.333096 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 13:11:14.333215 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 13:11:14.333352 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:11:14.333435 (Thread-2): Opening a new connection, currently in state init
2021-11-26 13:11:14.333517 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:11:14.333601 (Thread-3): Opening a new connection, currently in state init
2021-11-26 13:11:14.333683 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 13:11:14.333878 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 13:11:14.334059 (Thread-4): Opening a new connection, currently in state init
2021-11-26 13:11:14.334145 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 13:11:14.337744 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:11:14.337936 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:11:14.338079 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:11:14.338188 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:11:14.338298 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:11:14.338396 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:11:14.338487 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:11:14.338578 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 13:11:14.338664 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:11:14.338749 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 13:11:14.338837 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 13:11:14.338941 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 13:11:14.340169 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 13:11:14.344236 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:11:14.344360 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:11:14.344466 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 13:11:14.344554 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:11:14.344637 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 13:11:14.345808 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:11:14.347088 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:11:14.347200 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.348378 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:11:14.348486 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 13:11:14.348569 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 13:11:14.349670 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:11:14.349760 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 13:11:14.349893 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 13:11:14.350159 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.351369 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:11:14.351467 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.351545 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 13:11:14.351614 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.351704 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.352752 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:11:14.353893 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:11:14.353991 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.360386 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 13:11:14.360544 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:11:14.360633 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 13:11:14.361202 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:11:14.361328 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:11:14.361450 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:11:14.361542 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 13:11:14.361623 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.361706 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 13:11:14.362318 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:11:14.362400 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.362473 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.362581 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:11:14.363132 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:11:14.365749 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 13:11:14.365834 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.365928 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 13:11:14.366012 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:11:14.366101 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 13:11:14.366963 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 13:11:14.367078 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 13:11:14.367190 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 13:11:14.367273 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.368112 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 13:11:14.368215 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.368303 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 13:11:14.369082 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 13:11:14.369166 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:11:14.369242 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:11:14.369360 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 13:11:14.370063 (Thread-2): finished collecting timing info
2021-11-26 13:11:14.370176 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:11:14.370726 (Thread-1): finished collecting timing info
2021-11-26 13:11:14.370865 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 13:11:14.371408 (Thread-3): finished collecting timing info
2021-11-26 13:11:14.371513 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 13:11:14.371629 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 13:11:14.371852 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ab3fcd0>]}
2021-11-26 13:11:14.372046 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78aafd730>]}
2021-11-26 13:11:14.372212 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ab41190>]}
2021-11-26 13:11:14.372462 (Thread-2): 14:11:14 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.08s]
2021-11-26 13:11:14.372630 (Thread-1): 14:11:14 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 13:11:14.372800 (Thread-3): 14:11:14 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 13:11:14.372886 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:11:14.373019 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 13:11:14.373220 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 13:11:14.373855 (Thread-4): finished collecting timing info
2021-11-26 13:11:14.373961 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 13:11:14.374271 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 13:11:14.374378 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:11:14.374624 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 13:11:14.374827 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7681f7d60>]}
2021-11-26 13:11:14.374967 (Thread-6): 14:11:14 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 13:11:14.375107 (Thread-8): 14:11:14 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 13:11:14.375321 (Thread-4): 14:11:14 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 13:11:14.375515 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:11:14.375692 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:11:14.375802 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 13:11:14.375895 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 13:11:14.375991 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 13:11:14.377420 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:11:14.377524 (Thread-10): Began running node model.demo_dbt.fct_orders
2021-11-26 13:11:14.379001 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:11:14.379248 (Thread-10): 14:11:14 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 13:11:14.379483 (Thread-10): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:11:14.379600 (Thread-10): Compiling model.demo_dbt.fct_orders
2021-11-26 13:11:14.381985 (Thread-10): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:11:14.382250 (Thread-6): finished collecting timing info
2021-11-26 13:11:14.383417 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 13:11:14.383551 (Thread-8): finished collecting timing info
2021-11-26 13:11:14.384566 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 13:11:14.384693 (Thread-10): finished collecting timing info
2021-11-26 13:11:14.385752 (Thread-10): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 13:11:14.385994 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:11:14.386110 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:11:14.386196 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 13:11:14.386295 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 13:11:14.386395 (Thread-8): Opening a new connection, currently in state init
2021-11-26 13:11:14.386490 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:11:14.386575 (Thread-6): Opening a new connection, currently in state init
2021-11-26 13:11:14.386748 (Thread-10): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 13:11:14.386914 (Thread-10): Opening a new connection, currently in state init
2021-11-26 13:11:14.392135 (Thread-6): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:11:14.392282 (Thread-10): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:11:14.392385 (Thread-8): SQL status: BEGIN in 0.01 seconds
2021-11-26 13:11:14.392469 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:11:14.392560 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:11:14.392639 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:11:14.392715 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 13:11:14.392796 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
)

select * from payments
  );
2021-11-26 13:11:14.392877 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 13:11:14.396746 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 13:11:14.398191 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:11:14.398304 (Thread-10): SQL status: SELECT 113 in 0.01 seconds
2021-11-26 13:11:14.398390 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 13:11:14.399605 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:11:14.399732 (Thread-8): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 13:11:14.399827 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 13:11:14.401097 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:11:14.401201 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.401310 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 13:11:14.401939 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:11:14.402037 (Thread-10): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.402154 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:11:14.402824 (Thread-10): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 13:11:14.402917 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.403016 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 13:11:14.403114 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:11:14.404210 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:11:14.404369 (Thread-10): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 13:11:14.404468 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 13:11:14.404840 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.405876 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 13:11:14.405986 (Thread-10): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.406077 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 13:11:14.406152 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 13:11:14.407003 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 13:11:14.407746 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:11:14.407842 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 13:11:14.407921 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 13:11:14.408007 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:11:14.408615 (Thread-6): finished collecting timing info
2021-11-26 13:11:14.408742 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 13:11:14.408845 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 13:11:14.409099 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768203c40>]}
2021-11-26 13:11:14.409323 (Thread-6): 14:11:14 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 13:11:14.409418 (Thread-10): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:11:14.409496 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.409619 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 13:11:14.410273 (Thread-10): finished collecting timing info
2021-11-26 13:11:14.411238 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 13:11:14.411441 (Thread-10): On model.demo_dbt.fct_orders: Close
2021-11-26 13:11:14.411534 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 13:11:14.411747 (Thread-10): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778a05b50>]}
2021-11-26 13:11:14.411968 (Thread-10): 14:11:14 | 7 of 7 OK created table model public.fct_orders...................... [SELECT 113 in 0.03s]
2021-11-26 13:11:14.412076 (Thread-10): Finished running node model.demo_dbt.fct_orders
2021-11-26 13:11:14.414396 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 13:11:14.415008 (Thread-8): finished collecting timing info
2021-11-26 13:11:14.415115 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 13:11:14.415312 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07d8d4df-ebe0-44f4-ad0a-7f93a15f1127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7789b51c0>]}
2021-11-26 13:11:14.415489 (Thread-8): 14:11:14 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 13:11:14.415587 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 13:11:14.416370 (MainThread): Acquiring new postgres connection "master".
2021-11-26 13:11:14.416491 (MainThread): Using postgres connection "master".
2021-11-26 13:11:14.416576 (MainThread): On master: BEGIN
2021-11-26 13:11:14.416658 (MainThread): Opening a new connection, currently in state closed
2021-11-26 13:11:14.421623 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 13:11:14.421806 (MainThread): On master: COMMIT
2021-11-26 13:11:14.421896 (MainThread): Using postgres connection "master".
2021-11-26 13:11:14.421982 (MainThread): On master: COMMIT
2021-11-26 13:11:14.422146 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 13:11:14.422246 (MainThread): On master: Close
2021-11-26 13:11:14.422541 (MainThread): 14:11:14 | 
2021-11-26 13:11:14.422667 (MainThread): 14:11:14 | Finished running 4 view models, 3 table models in 0.29s.
2021-11-26 13:11:14.422769 (MainThread): Connection 'master' was properly closed.
2021-11-26 13:11:14.422854 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 13:11:14.422970 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 13:11:14.423064 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 13:11:14.423146 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 13:11:14.423226 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 13:11:14.423304 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 13:11:14.423383 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 13:11:14.427115 (MainThread): 
2021-11-26 13:11:14.427280 (MainThread): Completed successfully
2021-11-26 13:11:14.427390 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 13:11:14.427555 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78ab3fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78827c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7788bd460>]}
2021-11-26 13:11:14.427710 (MainThread): Flushing usage events
2021-11-26 16:00:36.266805 (MainThread): Running with dbt=0.21.0
2021-11-26 16:00:36.365669 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:00:36.367488 (MainThread): Tracking: tracking
2021-11-26 16:00:36.403987 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f0aff610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f0b0eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3026dfc10>]}
2021-11-26 16:00:36.412960 (MainThread): Partial parsing not enabled
2021-11-26 16:00:36.423159 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:00:36.426186 (MainThread): Parsing macros/relations.sql
2021-11-26 16:00:36.427248 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:00:36.443997 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:00:36.445169 (MainThread): Parsing macros/core.sql
2021-11-26 16:00:36.447737 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:00:36.452650 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:00:36.459516 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:00:36.460648 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:00:36.472796 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:00:36.500013 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:00:36.517027 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:00:36.518211 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:00:36.525702 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:00:36.541252 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:00:36.551873 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:00:36.557888 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:00:36.563441 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:00:36.566066 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:00:36.567042 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:00:36.567660 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:00:36.568687 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:00:36.574873 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:00:36.576055 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:00:36.577684 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:00:36.578731 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:00:36.621155 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:00:36.622279 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:00:36.623035 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:00:36.623911 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:00:36.738271 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:00:36.746059 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:00:36.747750 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:00:36.749399 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:00:36.751601 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:00:36.753766 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:00:36.756267 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:00:36.786653 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3028f0c10>]}
2021-11-26 16:00:36.790470 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe302896550>]}
2021-11-26 16:00:36.790652 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:00:36.791641 (MainThread): 
2021-11-26 16:00:36.791842 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:00:36.792709 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:00:36.799260 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:00:36.799436 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:00:36.799538 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:00:36.866290 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.07 seconds
2021-11-26 16:00:36.868155 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:00:36.869201 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:00:36.873749 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:00:36.873887 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:00:36.874000 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:00:36.879099 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:00:36.879224 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:00:36.879324 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:00:36.891864 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:00:36.892873 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:00:36.893180 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:00:36.896791 (MainThread): Using postgres connection "master".
2021-11-26 16:00:36.896925 (MainThread): On master: BEGIN
2021-11-26 16:00:36.897037 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:00:36.901946 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:36.902073 (MainThread): Using postgres connection "master".
2021-11-26 16:00:36.902172 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:00:36.956829 (MainThread): SQL status: SELECT 4 in 0.05 seconds
2021-11-26 16:00:36.957970 (MainThread): On master: ROLLBACK
2021-11-26 16:00:36.958492 (MainThread): Using postgres connection "master".
2021-11-26 16:00:36.958617 (MainThread): On master: BEGIN
2021-11-26 16:00:36.959139 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:36.959269 (MainThread): On master: COMMIT
2021-11-26 16:00:36.959381 (MainThread): Using postgres connection "master".
2021-11-26 16:00:36.959485 (MainThread): On master: COMMIT
2021-11-26 16:00:36.960003 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:36.960138 (MainThread): On master: Close
2021-11-26 16:00:36.960410 (MainThread): 17:00:36 | Concurrency: 10 threads (target='dev')
2021-11-26 16:00:36.960557 (MainThread): 17:00:36 | 
2021-11-26 16:00:36.963546 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:00:36.963766 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:00:36.963958 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:00:36.964241 (Thread-1): 17:00:36 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:00:36.964371 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:00:36.964597 (Thread-2): 17:00:36 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:00:36.964823 (Thread-3): 17:00:36 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:00:36.965245 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:00:36.965440 (Thread-4): 17:00:36 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:00:36.965798 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:00:36.966060 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:00:36.966255 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:00:36.966555 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:00:36.966695 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:00:36.966858 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:00:36.969434 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:00:36.969617 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:00:36.970707 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:00:36.971695 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:00:36.972871 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:00:36.973449 (Thread-1): finished collecting timing info
2021-11-26 16:00:36.995601 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:00:36.995787 (Thread-2): finished collecting timing info
2021-11-26 16:00:36.995980 (Thread-4): finished collecting timing info
2021-11-26 16:00:36.996083 (Thread-3): finished collecting timing info
2021-11-26 16:00:37.014445 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:00:37.018304 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:00:37.019697 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:00:37.019827 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:00:37.020097 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:00:37.020206 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:00:37.020486 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:00:37.020596 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:00:37.020686 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:00:37.020803 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:00:37.020908 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:00:37.021004 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:00:37.021095 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:00:37.021183 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:00:37.021350 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:00:37.024249 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:37.024451 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:00:37.024594 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:00:37.024718 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:37.024822 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:37.024901 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:37.024985 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:00:37.025065 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:00:37.025142 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:00:37.025223 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:00:37.025310 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:00:37.025401 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:00:37.031584 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:00:37.031765 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:00:37.031877 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:00:37.031993 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 16:00:37.036226 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:00:37.037486 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:00:37.038777 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:00:37.040030 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:00:37.040137 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:00:37.040230 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:00:37.040316 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:00:37.040399 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:00:37.041295 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.042597 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:00:37.042707 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.042807 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:00:37.042891 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.042985 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.044132 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:00:37.045412 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:00:37.045525 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.046688 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:00:37.046793 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:00:37.046882 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:00:37.053602 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:00:37.053698 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:00:37.053861 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:00:37.053998 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:00:37.054161 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.054258 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.054872 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:00:37.054957 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.055032 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:37.055600 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:00:37.055694 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:00:37.056274 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:00:37.058954 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:00:37.059065 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:00:37.059148 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:00:37.059237 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:00:37.059318 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:00:37.059398 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:00:37.059495 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:00:37.059685 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:37.060584 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:00:37.060685 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:37.060760 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:37.060842 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:00:37.061652 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:00:37.062482 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:00:37.062619 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:00:37.062714 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:00:37.064153 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:00:37.064256 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:00:37.064344 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:00:37.065053 (Thread-2): finished collecting timing info
2021-11-26 16:00:37.065636 (Thread-3): finished collecting timing info
2021-11-26 16:00:37.066194 (Thread-4): finished collecting timing info
2021-11-26 16:00:37.066302 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-11-26 16:00:37.066413 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:00:37.066512 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:00:37.066612 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:00:37.067221 (Thread-1): finished collecting timing info
2021-11-26 16:00:37.067627 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f0b48f70>]}
2021-11-26 16:00:37.067801 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30287e640>]}
2021-11-26 16:00:37.068007 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f0b501c0>]}
2021-11-26 16:00:37.068119 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:00:37.068446 (Thread-2): 17:00:37 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.10s]
2021-11-26 16:00:37.068664 (Thread-3): 17:00:37 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.10s]
2021-11-26 16:00:37.068881 (Thread-4): 17:00:37 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.10s]
2021-11-26 16:00:37.069290 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe302952fa0>]}
2021-11-26 16:00:37.069412 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:00:37.069564 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:00:37.069758 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:00:37.070115 (Thread-1): 17:00:37 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.10s]
2021-11-26 16:00:37.070400 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:00:37.070510 (Thread-1): Began running node model.demo_dbt.dim_customers
2021-11-26 16:00:37.070653 (Thread-6): Began running node model.demo_dbt.fct_orders
2021-11-26 16:00:37.070826 (Thread-1): 17:00:37 | 5 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:00:37.070931 (Thread-8): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:00:37.071064 (Thread-6): 17:00:37 | 6 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:00:37.071288 (Thread-1): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:00:37.071434 (Thread-8): 17:00:37 | 7 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:00:37.071661 (Thread-6): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:00:37.071773 (Thread-1): Compiling model.demo_dbt.dim_customers
2021-11-26 16:00:37.071968 (Thread-8): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:00:37.072057 (Thread-6): Compiling model.demo_dbt.fct_orders
2021-11-26 16:00:37.073871 (Thread-1): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:00:37.074055 (Thread-8): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:00:37.077396 (Thread-6): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:00:37.078723 (Thread-8): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:00:37.079003 (Thread-1): finished collecting timing info
2021-11-26 16:00:37.080216 (Thread-1): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:00:37.080355 (Thread-6): finished collecting timing info
2021-11-26 16:00:37.081477 (Thread-6): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:00:37.081685 (Thread-8): finished collecting timing info
2021-11-26 16:00:37.081816 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:00:37.082860 (Thread-8): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:00:37.082976 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:00:37.083061 (Thread-1): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:00:37.083196 (Thread-6): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:00:37.083292 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:00:37.083394 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:00:37.083494 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:00:37.083733 (Thread-8): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:00:37.083816 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:00:37.087720 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:37.087897 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:37.087999 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:00:37.088080 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:37.088177 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:00:37.088263 (Thread-8): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:00:37.088348 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:00:37.088425 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:00:37.088558 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    orders.order_id as order_id
    from orders
)
select * from order_payments
  );
2021-11-26 16:00:37.091537 (Thread-6): SQL status: SELECT 99 in 0.00 seconds
2021-11-26 16:00:37.091783 (Thread-8): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:00:37.093705 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:00:37.094985 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:00:37.095109 (Thread-1): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 16:00:37.095191 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2021-11-26 16:00:37.095280 (Thread-8): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:00:37.096458 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:00:37.096606 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:00:37.096879 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.096970 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.097043 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.098086 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:00:37.098730 (Thread-8): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:00:37.099718 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:00:37.099814 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 16:00:37.099910 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:00:37.099997 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:00:37.100123 (Thread-8): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:00:37.100397 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.101015 (Thread-6): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:00:37.101104 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:37.101198 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:00:37.102072 (Thread-8): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:00:37.102180 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:00:37.102258 (Thread-6): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:00:37.102339 (Thread-8): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:00:37.102933 (Thread-1): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:00:37.103068 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:00:37.103146 (Thread-1): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:00:37.103242 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:37.104061 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:00:37.104154 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 16:00:37.104243 (Thread-8): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:00:37.104322 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:37.104910 (Thread-8): finished collecting timing info
2021-11-26 16:00:37.105877 (Thread-1): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:00:37.106019 (Thread-6): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:00:37.106165 (Thread-8): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:00:37.106285 (Thread-1): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:00:37.107045 (Thread-6): finished collecting timing info
2021-11-26 16:00:37.107380 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30296f880>]}
2021-11-26 16:00:37.107491 (Thread-6): On model.demo_dbt.fct_orders: Close
2021-11-26 16:00:37.107898 (Thread-8): 17:00:37 | 7 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.04s]
2021-11-26 16:00:37.108036 (Thread-8): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:00:37.108374 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f0b5d820>]}
2021-11-26 16:00:37.108519 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:00:37.109242 (Thread-1): finished collecting timing info
2021-11-26 16:00:37.109349 (Thread-1): On model.demo_dbt.dim_customers: Close
2021-11-26 16:00:37.109543 (Thread-6): 17:00:37 | 6 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.04s]
2021-11-26 16:00:37.109762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae276fe-49c3-4e76-9839-11e27ce0f62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f0ba3490>]}
2021-11-26 16:00:37.109889 (Thread-6): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:00:37.110128 (Thread-1): 17:00:37 | 5 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 16:00:37.110274 (Thread-1): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:00:37.111340 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:00:37.111474 (MainThread): Using postgres connection "master".
2021-11-26 16:00:37.111559 (MainThread): On master: BEGIN
2021-11-26 16:00:37.111648 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:00:37.114891 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:00:37.115016 (MainThread): On master: COMMIT
2021-11-26 16:00:37.115098 (MainThread): Using postgres connection "master".
2021-11-26 16:00:37.115177 (MainThread): On master: COMMIT
2021-11-26 16:00:37.115354 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:00:37.115448 (MainThread): On master: Close
2021-11-26 16:00:37.115705 (MainThread): 17:00:37 | 
2021-11-26 16:00:37.115816 (MainThread): 17:00:37 | Finished running 4 view models, 3 table models in 0.32s.
2021-11-26 16:00:37.115914 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:00:37.115997 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:00:37.116076 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:00:37.116151 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:00:37.116226 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:00:37.116302 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:00:37.116377 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:00:37.119370 (MainThread): 
2021-11-26 16:00:37.119500 (MainThread): Completed successfully
2021-11-26 16:00:37.119614 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 16:00:37.119770 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3028cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f0b0eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f03bf880>]}
2021-11-26 16:00:37.119930 (MainThread): Flushing usage events
2021-11-26 16:01:26.083876 (MainThread): Running with dbt=0.21.0
2021-11-26 16:01:26.147622 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:01:26.149102 (MainThread): Tracking: tracking
2021-11-26 16:01:26.174376 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bab276a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b81bdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bab07fa0>]}
2021-11-26 16:01:26.182709 (MainThread): Partial parsing not enabled
2021-11-26 16:01:26.191954 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:01:26.194452 (MainThread): Parsing macros/relations.sql
2021-11-26 16:01:26.195475 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:01:26.212056 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:01:26.213219 (MainThread): Parsing macros/core.sql
2021-11-26 16:01:26.215773 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:01:26.220650 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:01:26.227440 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:01:26.228570 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:01:26.240604 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:01:26.267597 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:01:26.284464 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:01:26.285645 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:01:26.293071 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:01:26.308330 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:01:26.318777 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:01:26.324761 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:01:26.330243 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:01:26.332840 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:01:26.333825 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:01:26.334447 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:01:26.335469 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:01:26.341772 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:01:26.343001 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:01:26.344667 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:01:26.345732 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:01:26.387628 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:01:26.388757 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:01:26.389528 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:01:26.390411 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:01:26.504739 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:01:26.512728 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:01:26.514422 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:01:26.516087 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:01:26.518361 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:01:26.520547 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:01:26.523063 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:01:26.553171 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a82b4cd0>]}
2021-11-26 16:01:26.556778 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a825ed00>]}
2021-11-26 16:01:26.556952 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:01:26.557936 (MainThread): 
2021-11-26 16:01:26.558157 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:01:26.559063 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:01:26.565399 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:01:26.565549 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:01:26.565646 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:01:26.606622 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 16:01:26.608247 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:01:26.609246 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:01:26.613487 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:01:26.613609 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:01:26.613711 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:01:26.618555 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.618674 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:01:26.618765 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:01:26.625543 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:01:26.626500 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:01:26.626789 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:01:26.630170 (MainThread): Using postgres connection "master".
2021-11-26 16:01:26.630292 (MainThread): On master: BEGIN
2021-11-26 16:01:26.630396 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:01:26.635676 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:01:26.635797 (MainThread): Using postgres connection "master".
2021-11-26 16:01:26.635892 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:01:26.700823 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:01:26.702046 (MainThread): On master: ROLLBACK
2021-11-26 16:01:26.702635 (MainThread): Using postgres connection "master".
2021-11-26 16:01:26.702769 (MainThread): On master: BEGIN
2021-11-26 16:01:26.703412 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.703560 (MainThread): On master: COMMIT
2021-11-26 16:01:26.703685 (MainThread): Using postgres connection "master".
2021-11-26 16:01:26.703801 (MainThread): On master: COMMIT
2021-11-26 16:01:26.704144 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.704288 (MainThread): On master: Close
2021-11-26 16:01:26.704590 (MainThread): 17:01:26 | Concurrency: 10 threads (target='dev')
2021-11-26 16:01:26.704757 (MainThread): 17:01:26 | 
2021-11-26 16:01:26.707832 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:01:26.708083 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:01:26.708237 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:01:26.708465 (Thread-1): 17:01:26 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:01:26.708592 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:01:26.708805 (Thread-2): 17:01:26 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:01:26.708994 (Thread-3): 17:01:26 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:01:26.709343 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:01:26.709551 (Thread-4): 17:01:26 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:01:26.709928 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:01:26.710231 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:01:26.710464 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:01:26.710774 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:01:26.710905 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:01:26.711045 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:01:26.713545 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:01:26.713714 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:01:26.714789 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:01:26.715811 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:01:26.717077 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:01:26.717482 (Thread-1): finished collecting timing info
2021-11-26 16:01:26.730238 (Thread-2): finished collecting timing info
2021-11-26 16:01:26.745165 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:01:26.751268 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:01:26.751401 (Thread-4): finished collecting timing info
2021-11-26 16:01:26.751539 (Thread-3): finished collecting timing info
2021-11-26 16:01:26.752990 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:01:26.754943 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:01:26.755079 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:01:26.755192 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:01:26.755400 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:01:26.755520 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:01:26.755620 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:01:26.755728 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:01:26.755821 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:01:26.755913 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:01:26.755994 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:01:26.756074 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:01:26.756348 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:01:26.756464 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:01:26.759756 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.759910 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.760006 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.760092 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:01:26.760165 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.760253 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:01:26.760341 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:01:26.760435 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:01:26.760520 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:01:26.760602 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:01:26.760685 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:01:26.760789 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:01:26.763035 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:01:26.763187 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:01:26.763274 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:01:26.763348 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:01:26.767613 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:01:26.768951 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:01:26.770286 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:01:26.771480 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:01:26.771601 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:01:26.771700 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:01:26.771783 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:01:26.771875 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:01:26.772477 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.773743 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:01:26.773859 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.773956 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.774034 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:01:26.774105 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.775339 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:01:26.776428 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:01:26.777691 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:01:26.777806 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.777891 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:01:26.777979 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:01:26.778062 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:01:26.784805 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:01:26.784966 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:01:26.785058 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:01:26.785159 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.785825 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:01:26.785928 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.786019 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:01:26.786089 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.786174 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.786756 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:01:26.786854 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:01:26.787394 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:01:26.790100 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:01:26.790208 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:01:26.790323 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:01:26.790411 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:01:26.790503 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.790708 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:01:26.790792 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:01:26.791581 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:01:26.791740 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:01:26.791889 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.791985 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.792821 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:01:26.792912 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:01:26.793000 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:01:26.793841 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:01:26.793946 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:01:26.794627 (Thread-1): finished collecting timing info
2021-11-26 16:01:26.795208 (Thread-3): finished collecting timing info
2021-11-26 16:01:26.795311 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:01:26.795442 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:01:26.795544 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:01:26.795824 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a83b3a30>]}
2021-11-26 16:01:26.796354 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a83b3670>]}
2021-11-26 16:01:26.796458 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:01:26.796549 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:01:26.796782 (Thread-1): 17:01:26 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 16:01:26.797373 (Thread-2): finished collecting timing info
2021-11-26 16:01:26.797536 (Thread-3): 17:01:26 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:01:26.798076 (Thread-4): finished collecting timing info
2021-11-26 16:01:26.798212 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:01:26.798304 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:01:26.798425 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:01:26.798518 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:01:26.798750 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a83b3c10>]}
2021-11-26 16:01:26.799001 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:01:26.799223 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c870b670>]}
2021-11-26 16:01:26.799453 (Thread-6): 17:01:26 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:01:26.799638 (Thread-2): 17:01:26 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:01:26.799816 (Thread-4): 17:01:26 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:01:26.799994 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:01:26.800125 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:01:26.800259 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:01:26.800353 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:01:26.800627 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:01:26.802052 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:01:26.802246 (Thread-8): 17:01:26 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:01:26.802351 (Thread-10): Began running node model.demo_dbt.fct_orders
2021-11-26 16:01:26.802609 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:01:26.802767 (Thread-10): 17:01:26 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:01:26.802871 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:01:26.802961 (Thread-6): finished collecting timing info
2021-11-26 16:01:26.803350 (Thread-10): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:01:26.804885 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:01:26.807672 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:01:26.807857 (Thread-10): Compiling model.demo_dbt.fct_orders
2021-11-26 16:01:26.809434 (Thread-10): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:01:26.809687 (Thread-8): finished collecting timing info
2021-11-26 16:01:26.810816 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:01:26.810966 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:01:26.811059 (Thread-10): finished collecting timing info
2021-11-26 16:01:26.811158 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:01:26.812228 (Thread-10): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:01:26.812360 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:01:26.812458 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:01:26.812679 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:01:26.812780 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:01:26.812853 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:01:26.812933 (Thread-10): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:01:26.813084 (Thread-10): Opening a new connection, currently in state init
2021-11-26 16:01:26.815485 (Thread-10): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.815614 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.815711 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:01:26.815802 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:01:26.815888 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    orders.order_id 
    from orders
)
select * from order_payments
  );
2021-11-26 16:01:26.815970 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:01:26.816342 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:01:26.816445 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:01:26.816526 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:01:26.817836 (Thread-10): SQL status: SELECT 99 in 0.00 seconds
2021-11-26 16:01:26.819411 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:01:26.819548 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2021-11-26 16:01:26.819656 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:01:26.819753 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:01:26.821037 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:01:26.821172 (Thread-10): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.822406 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:01:26.822556 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:01:26.823997 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:01:26.824121 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:01:26.824260 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 16:01:26.824584 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.825895 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:01:26.826001 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.826096 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:01:26.826178 (Thread-10): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.826791 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:01:26.827470 (Thread-10): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:01:26.827569 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:01:26.827658 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:01:26.827743 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:01:26.828349 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:01:26.828437 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:01:26.828517 (Thread-10): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:01:26.828604 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:01:26.828726 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:01:26.829077 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.829168 (Thread-10): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.829244 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.830074 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:01:26.830846 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:01:26.831646 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:01:26.831749 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:01:26.831835 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 16:01:26.831918 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:01:26.832166 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:01:26.832789 (Thread-6): finished collecting timing info
2021-11-26 16:01:26.832905 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:01:26.833155 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c86eb400>]}
2021-11-26 16:01:26.833248 (Thread-10): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:01:26.833335 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:01:26.833973 (Thread-10): finished collecting timing info
2021-11-26 16:01:26.834183 (Thread-6): 17:01:26 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:01:26.834737 (Thread-8): finished collecting timing info
2021-11-26 16:01:26.834850 (Thread-10): On model.demo_dbt.fct_orders: Close
2021-11-26 16:01:26.834965 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:01:26.835067 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:01:26.835422 (Thread-10): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bac32220>]}
2021-11-26 16:01:26.835626 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68de4cd-e7eb-4890-bf77-8b73cc12ac40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c8700b50>]}
2021-11-26 16:01:26.835852 (Thread-10): 17:01:26 | 7 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.03s]
2021-11-26 16:01:26.836037 (Thread-8): 17:01:26 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:01:26.836157 (Thread-10): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:01:26.836264 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:01:26.837200 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:01:26.837340 (MainThread): Using postgres connection "master".
2021-11-26 16:01:26.837423 (MainThread): On master: BEGIN
2021-11-26 16:01:26.837510 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:01:26.856803 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-11-26 16:01:26.857032 (MainThread): On master: COMMIT
2021-11-26 16:01:26.857128 (MainThread): Using postgres connection "master".
2021-11-26 16:01:26.857217 (MainThread): On master: COMMIT
2021-11-26 16:01:26.857440 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:01:26.857573 (MainThread): On master: Close
2021-11-26 16:01:26.857883 (MainThread): 17:01:26 | 
2021-11-26 16:01:26.858022 (MainThread): 17:01:26 | Finished running 3 table models, 4 view models in 0.30s.
2021-11-26 16:01:26.858133 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:01:26.858221 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:01:26.858306 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:01:26.858387 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:01:26.858466 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:01:26.858546 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:01:26.858625 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:01:26.858704 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:01:26.861985 (MainThread): 
2021-11-26 16:01:26.862127 (MainThread): Completed successfully
2021-11-26 16:01:26.862243 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 16:01:26.862403 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86a8293940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b8e4f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b81bdbb0>]}
2021-11-26 16:01:26.862563 (MainThread): Flushing usage events
2021-11-26 16:02:08.482577 (MainThread): Running with dbt=0.21.0
2021-11-26 16:02:08.546372 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:02:08.547880 (MainThread): Tracking: tracking
2021-11-26 16:02:08.574652 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd132b1ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd132b2eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd132affc10>]}
2021-11-26 16:02:08.583010 (MainThread): Partial parsing not enabled
2021-11-26 16:02:08.592144 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:02:08.594633 (MainThread): Parsing macros/relations.sql
2021-11-26 16:02:08.595673 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:02:08.612703 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:02:08.613886 (MainThread): Parsing macros/core.sql
2021-11-26 16:02:08.616439 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:02:08.621380 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:02:08.628324 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:02:08.629465 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:02:08.641658 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:02:08.669367 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:02:08.686551 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:02:08.687740 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:02:08.695314 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:02:08.711019 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:02:08.721740 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:02:08.727864 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:02:08.733497 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:02:08.736117 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:02:08.737092 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:02:08.737709 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:02:08.738743 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:02:08.745499 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:02:08.746770 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:02:08.748431 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:02:08.749492 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:02:08.792665 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:02:08.793832 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:02:08.794600 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:02:08.795479 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:02:08.911110 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:02:08.918933 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:02:08.920646 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:02:08.922287 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:02:08.924505 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:02:08.926672 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:02:08.929160 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:02:08.959882 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1100d0c10>]}
2021-11-26 16:02:08.963539 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd110074bb0>]}
2021-11-26 16:02:08.963711 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:02:08.964701 (MainThread): 
2021-11-26 16:02:08.964904 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:02:08.965793 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:02:08.972692 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:02:08.972870 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:02:08.972971 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:02:09.026171 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 16:02:09.027887 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:02:09.029012 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:02:09.033651 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:02:09.033783 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:02:09.033893 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:02:09.039107 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:02:09.039253 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:02:09.039353 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:02:09.046794 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:02:09.047778 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:02:09.048051 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:02:09.051721 (MainThread): Using postgres connection "master".
2021-11-26 16:02:09.051870 (MainThread): On master: BEGIN
2021-11-26 16:02:09.051988 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:02:09.056556 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:02:09.056691 (MainThread): Using postgres connection "master".
2021-11-26 16:02:09.056791 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:02:09.119149 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:02:09.120221 (MainThread): On master: ROLLBACK
2021-11-26 16:02:09.120762 (MainThread): Using postgres connection "master".
2021-11-26 16:02:09.120882 (MainThread): On master: BEGIN
2021-11-26 16:02:09.121699 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:02:09.121823 (MainThread): On master: COMMIT
2021-11-26 16:02:09.121935 (MainThread): Using postgres connection "master".
2021-11-26 16:02:09.122044 (MainThread): On master: COMMIT
2021-11-26 16:02:09.122492 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:02:09.122623 (MainThread): On master: Close
2021-11-26 16:02:09.122881 (MainThread): 17:02:09 | Concurrency: 10 threads (target='dev')
2021-11-26 16:02:09.123030 (MainThread): 17:02:09 | 
2021-11-26 16:02:09.125871 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:02:09.126115 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:02:09.126302 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:02:09.126568 (Thread-1): 17:02:09 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:02:09.126712 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:02:09.126958 (Thread-2): 17:02:09 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:02:09.127156 (Thread-3): 17:02:09 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:02:09.127557 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:02:09.127807 (Thread-4): 17:02:09 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:02:09.128195 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:02:09.128518 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:02:09.128700 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:02:09.128988 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:02:09.129127 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:02:09.129265 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:02:09.131936 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:02:09.132111 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:02:09.133287 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:02:09.134322 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:02:09.135472 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:02:09.135839 (Thread-1): finished collecting timing info
2021-11-26 16:02:09.142213 (Thread-2): finished collecting timing info
2021-11-26 16:02:09.149166 (Thread-3): finished collecting timing info
2021-11-26 16:02:09.164738 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:02:09.170754 (Thread-4): finished collecting timing info
2021-11-26 16:02:09.174412 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:02:09.175035 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:02:09.176464 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:02:09.176867 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:02:09.176981 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:02:09.177102 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:02:09.177193 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:02:09.177281 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:02:09.177376 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:02:09.177473 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:02:09.177647 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:02:09.177730 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:02:09.177808 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:02:09.177889 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:02:09.178050 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:02:09.180744 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:02:09.180884 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:02:09.180974 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:02:09.181075 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:02:09.181149 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:02:09.181220 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:02:09.181302 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:02:09.181388 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:02:09.181497 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:02:09.181579 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:02:09.181659 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:02:09.181738 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:02:09.183498 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:02:09.187534 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:02:09.187800 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:02:09.187907 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:02:09.188000 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:02:09.188089 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:02:09.189342 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:02:09.190560 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:02:09.191743 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:02:09.191877 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:02:09.191967 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:02:09.192049 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:02:09.192271 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.193468 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:02:09.193573 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:02:09.193668 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.193779 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.194848 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:02:09.194937 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.195017 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.196163 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:02:09.196266 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:02:09.197375 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:02:09.203932 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:02:09.204029 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:02:09.204149 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:02:09.204241 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:02:09.204384 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:02:09.204505 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.205092 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:02:09.205185 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:02:09.205271 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.205355 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:02:09.205424 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.205508 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:02:09.206073 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:02:09.206682 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:02:09.206779 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:02:09.209386 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:02:09.209500 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:02:09.209591 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:02:09.210432 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:02:09.210525 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:02:09.210617 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:02:09.210703 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:02:09.210780 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:02:09.211034 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:02:09.211121 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:02:09.211944 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:02:09.212051 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:02:09.212841 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:02:09.212948 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:02:09.213034 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:02:09.213663 (Thread-2): finished collecting timing info
2021-11-26 16:02:09.213769 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:02:09.214326 (Thread-1): finished collecting timing info
2021-11-26 16:02:09.214466 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:02:09.214597 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:02:09.214870 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14087a1c0>]}
2021-11-26 16:02:09.215223 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11005da60>]}
2021-11-26 16:02:09.215486 (Thread-2): 17:02:09 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:02:09.215593 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:02:09.215679 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:02:09.215856 (Thread-1): 17:02:09 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 16:02:09.215968 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:02:09.216583 (Thread-4): finished collecting timing info
2021-11-26 16:02:09.217135 (Thread-3): finished collecting timing info
2021-11-26 16:02:09.217247 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:02:09.217442 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:02:09.217539 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:02:09.217763 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:02:09.218046 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd120183850>]}
2021-11-26 16:02:09.218264 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd132c5ff10>]}
2021-11-26 16:02:09.218427 (Thread-6): 17:02:09 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:02:09.218643 (Thread-4): 17:02:09 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:02:09.218808 (Thread-3): 17:02:09 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:02:09.219000 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:02:09.219107 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:02:09.219229 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:02:09.219311 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:02:09.220812 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:02:09.221102 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:02:09.221220 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 16:02:09.221379 (Thread-8): 17:02:09 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:02:09.221554 (Thread-9): 17:02:09 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:02:09.221884 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:02:09.221984 (Thread-6): finished collecting timing info
2021-11-26 16:02:09.222232 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:02:09.223858 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:02:09.225196 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:02:09.225319 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 16:02:09.226873 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:02:09.228270 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:02:09.228552 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:02:09.228664 (Thread-8): finished collecting timing info
2021-11-26 16:02:09.228792 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:02:09.229992 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:02:09.230083 (Thread-9): finished collecting timing info
2021-11-26 16:02:09.230183 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:02:09.231323 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:02:09.231579 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:02:09.231715 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:02:09.231807 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:02:09.232036 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:02:09.232124 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:02:09.232208 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:02:09.236152 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:02:09.236259 (Thread-6): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:02:09.236349 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:02:09.236433 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:02:09.236518 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:02:09.236606 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:02:09.237558 (Thread-9): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:02:09.237649 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:02:09.237725 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    orders.order_id
    orders.customer_id 
    from orders
)
select * from order_payments
  );
2021-11-26 16:02:09.238080 (Thread-9): Postgres error: syntax error at or near "."
LINE 18:     orders.customer_id 
                   ^

2021-11-26 16:02:09.238166 (Thread-9): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 16:02:09.238363 (Thread-9): finished collecting timing info
2021-11-26 16:02:09.238469 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 16:02:09.240215 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:02:09.242093 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:02:09.242286 (Thread-8): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 16:02:09.242382 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:02:09.243717 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:02:09.243874 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:02:09.244205 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.244841 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:02:09.244936 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.245025 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:02:09.246164 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:02:09.246291 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:02:09.246402 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:02:09.246865 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:02:09.246958 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:02:09.247589 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:02:09.248421 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:02:09.248575 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:02:09.248672 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:02:09.248810 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:02:09.238693 (Thread-9): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "."
  LINE 18:     orders.customer_id 
                     ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "."
LINE 18:     orders.customer_id 
                   ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "."
  LINE 18:     orders.customer_id 
                     ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:02:09.249112 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:02:09.249193 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:02:09.249347 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd110059c10>]}
2021-11-26 16:02:09.249890 (Thread-6): finished collecting timing info
2021-11-26 16:02:09.250636 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:02:09.250780 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:02:09.250974 (Thread-9): 17:02:09 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.03s]
2021-11-26 16:02:09.251061 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:02:09.251275 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1408be9a0>]}
2021-11-26 16:02:09.251391 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:02:09.251624 (Thread-6): 17:02:09 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:02:09.251868 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:02:09.252686 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:02:09.253331 (Thread-8): finished collecting timing info
2021-11-26 16:02:09.253439 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:02:09.253638 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b2fca3-f2f7-44c1-80ce-1e3c0542f157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd132cabdf0>]}
2021-11-26 16:02:09.253816 (Thread-8): 17:02:09 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:02:09.253912 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:02:09.254747 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:02:09.254884 (MainThread): Using postgres connection "master".
2021-11-26 16:02:09.254969 (MainThread): On master: BEGIN
2021-11-26 16:02:09.255057 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:02:09.260411 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:02:09.260718 (MainThread): On master: COMMIT
2021-11-26 16:02:09.260806 (MainThread): Using postgres connection "master".
2021-11-26 16:02:09.260887 (MainThread): On master: COMMIT
2021-11-26 16:02:09.261080 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:02:09.261172 (MainThread): On master: Close
2021-11-26 16:02:09.261428 (MainThread): 17:02:09 | 
2021-11-26 16:02:09.261532 (MainThread): 17:02:09 | Finished running 4 view models, 3 table models in 0.30s.
2021-11-26 16:02:09.261627 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:02:09.261704 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:02:09.261779 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:02:09.261854 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:02:09.261930 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:02:09.262005 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:02:09.262078 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:02:09.262148 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:02:09.265317 (MainThread): 
2021-11-26 16:02:09.265475 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 16:02:09.265580 (MainThread): 
2021-11-26 16:02:09.265677 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 16:02:09.265769 (MainThread):   syntax error at or near "."
2021-11-26 16:02:09.265856 (MainThread):   LINE 18:     orders.customer_id 
2021-11-26 16:02:09.265938 (MainThread):                      ^
2021-11-26 16:02:09.266020 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:02:09.266117 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 16:02:09.266271 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1100aa8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd132b2eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd130e87880>]}
2021-11-26 16:02:09.266441 (MainThread): Flushing usage events
2021-11-26 16:03:03.103452 (MainThread): Running with dbt=0.21.0
2021-11-26 16:03:03.159129 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:03:03.160086 (MainThread): Tracking: tracking
2021-11-26 16:03:03.185289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f102277f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f10236af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f10208c10>]}
2021-11-26 16:03:03.193585 (MainThread): Partial parsing not enabled
2021-11-26 16:03:03.200722 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:03:03.203053 (MainThread): Parsing macros/relations.sql
2021-11-26 16:03:03.204139 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:03:03.221634 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:03:03.222826 (MainThread): Parsing macros/core.sql
2021-11-26 16:03:03.225424 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:03:03.230450 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:03:03.237545 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:03:03.238703 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:03:03.251097 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:03:03.279252 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:03:03.296807 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:03:03.298004 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:03:03.305617 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:03:03.321809 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:03:03.332846 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:03:03.338996 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:03:03.344732 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:03:03.347375 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:03:03.348359 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:03:03.348981 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:03:03.350013 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:03:03.356356 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:03:03.357543 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:03:03.359177 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:03:03.360231 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:03:03.404742 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:03:03.405871 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:03:03.406629 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:03:03.407507 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:03:03.520751 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:03:03.528561 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:03:03.530307 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:03:03.531986 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:03:03.534252 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:03:03.536532 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:03:03.539135 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:03:03.569142 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f22bffc10>]}
2021-11-26 16:03:03.572755 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f22ba8a90>]}
2021-11-26 16:03:03.572929 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:03:03.573886 (MainThread): 
2021-11-26 16:03:03.574105 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:03:03.574959 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:03:03.581564 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:03:03.581725 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:03:03.581821 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:03:03.623621 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 16:03:03.625290 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:03:03.626475 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:03:03.631011 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:03:03.631144 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:03:03.631253 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:03:03.636178 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.636325 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:03:03.636427 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:03:03.643127 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:03:03.644144 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:03:03.644646 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:03:03.648173 (MainThread): Using postgres connection "master".
2021-11-26 16:03:03.648299 (MainThread): On master: BEGIN
2021-11-26 16:03:03.648403 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:03:03.653305 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.653443 (MainThread): Using postgres connection "master".
2021-11-26 16:03:03.653536 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:03:03.714472 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:03:03.715681 (MainThread): On master: ROLLBACK
2021-11-26 16:03:03.716020 (MainThread): Using postgres connection "master".
2021-11-26 16:03:03.716158 (MainThread): On master: BEGIN
2021-11-26 16:03:03.716732 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.716875 (MainThread): On master: COMMIT
2021-11-26 16:03:03.717001 (MainThread): Using postgres connection "master".
2021-11-26 16:03:03.717118 (MainThread): On master: COMMIT
2021-11-26 16:03:03.717474 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.717620 (MainThread): On master: Close
2021-11-26 16:03:03.717906 (MainThread): 17:03:03 | Concurrency: 10 threads (target='dev')
2021-11-26 16:03:03.718072 (MainThread): 17:03:03 | 
2021-11-26 16:03:03.721096 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:03:03.721377 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:03:03.721535 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:03:03.721785 (Thread-1): 17:03:03 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:03:03.721951 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:03:03.722207 (Thread-2): 17:03:03 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:03:03.722418 (Thread-3): 17:03:03 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:03:03.722803 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:03:03.723117 (Thread-4): 17:03:03 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:03:03.723509 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:03:03.723769 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:03:03.723977 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:03:03.724303 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:03:03.724502 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:03:03.724684 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:03:03.727143 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:03:03.727323 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:03:03.728412 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:03:03.729510 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:03:03.730638 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:03:03.731116 (Thread-1): finished collecting timing info
2021-11-26 16:03:03.731264 (Thread-2): finished collecting timing info
2021-11-26 16:03:03.731385 (Thread-3): finished collecting timing info
2021-11-26 16:03:03.749986 (Thread-4): finished collecting timing info
2021-11-26 16:03:03.758414 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:03:03.770419 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:03:03.774771 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:03:03.776253 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:03:03.776703 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:03:03.776881 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:03:03.777002 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:03:03.777139 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:03:03.777224 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:03:03.777323 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:03:03.777423 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:03:03.777508 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:03:03.777590 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:03:03.777673 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:03:03.777848 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:03:03.777991 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:03:03.781169 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.781310 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.781404 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.781483 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.781564 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:03:03.781644 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:03:03.781727 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:03:03.781810 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:03:03.781891 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:03:03.781973 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:03:03.782051 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:03:03.782128 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:03:03.785400 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:03:03.789502 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:03:03.789656 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:03:03.789896 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:03:03.789998 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:03:03.790091 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:03:03.791405 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:03:03.792602 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:03:03.793749 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:03:03.793879 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:03:03.793968 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:03:03.794049 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:03:03.794226 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.795423 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:03:03.795525 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.795605 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:03:03.795685 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.795780 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.796829 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:03:03.798030 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:03:03.798131 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.799229 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:03:03.799326 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:03:03.799409 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:03:03.805812 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:03:03.805975 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:03:03.806160 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:03:03.806249 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:03:03.806391 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.806489 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.806582 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.807171 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:03:03.807255 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.807811 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:03:03.808347 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:03:03.808440 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:03:03.811068 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:03:03.811176 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:03:03.811260 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:03:03.811336 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:03:03.811412 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:03:03.811489 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:03:03.811562 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:03:03.811887 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.812773 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:03:03.812870 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:03:03.812967 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.813796 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:03:03.813896 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:03:03.814054 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.814856 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:03:03.814962 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:03:03.815053 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:03:03.815130 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:03:03.815202 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:03:03.815807 (Thread-2): finished collecting timing info
2021-11-26 16:03:03.816355 (Thread-1): finished collecting timing info
2021-11-26 16:03:03.816877 (Thread-4): finished collecting timing info
2021-11-26 16:03:03.817018 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:03:03.817112 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:03:03.817198 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:03:03.817465 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f22b8de20>]}
2021-11-26 16:03:03.818027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f22b8dac0>]}
2021-11-26 16:03:03.818255 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f10292ee0>]}
2021-11-26 16:03:03.818353 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:03:03.818578 (Thread-2): 17:03:03 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:03:03.818739 (Thread-1): 17:03:03 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.10s]
2021-11-26 16:03:03.818911 (Thread-4): 17:03:03 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:03:03.819473 (Thread-3): finished collecting timing info
2021-11-26 16:03:03.819631 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:03:03.819749 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:03:03.819859 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:03:03.819945 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:03:03.820264 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:03:03.820500 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f305a65b0>]}
2021-11-26 16:03:03.820713 (Thread-6): 17:03:03 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:03:03.820933 (Thread-3): 17:03:03 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.10s]
2021-11-26 16:03:03.821135 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:03:03.821238 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:03:03.822711 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:03:03.822881 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:03:03.823168 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:03:03.823285 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 16:03:03.823441 (Thread-8): 17:03:03 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:03:03.823544 (Thread-6): finished collecting timing info
2021-11-26 16:03:03.823694 (Thread-9): 17:03:03 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:03:03.824013 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:03:03.826805 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:03:03.827116 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:03:03.827213 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:03:03.827368 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 16:03:03.828946 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:03:03.830311 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:03:03.830497 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:03:03.830620 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:03:03.830715 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:03:03.830947 (Thread-9): finished collecting timing info
2021-11-26 16:03:03.831042 (Thread-8): finished collecting timing info
2021-11-26 16:03:03.832273 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:03:03.833413 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:03:03.833724 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:03:03.833838 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:03:03.833921 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:03:03.834006 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.834093 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:03:03.834174 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:03:03.834255 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:03:03.834336 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:03:03.834485 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:03:03.835900 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:03:03.837381 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:03:03.837523 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:03:03.838014 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.838110 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.838211 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.838305 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:03:03.839104 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:03:03.839226 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:03:03.839324 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    orders.customer_id 
    from orders
)
select * from order_payments
  );
2021-11-26 16:03:03.839421 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:03:03.839502 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:03:03.839616 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:03:03.839948 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.841151 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:03:03.841317 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:03:03.841612 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:03:03.842450 (Thread-6): finished collecting timing info
2021-11-26 16:03:03.842566 (Thread-9): SQL status: SELECT 99 in 0.00 seconds
2021-11-26 16:03:03.842680 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:03:03.842776 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:03:03.844008 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:03:03.845235 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:03:03.845457 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f10351910>]}
2021-11-26 16:03:03.845553 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2021-11-26 16:03:03.845648 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:03:03.845886 (Thread-6): 17:03:03 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 16:03:03.846049 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:03:03.846244 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.847455 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:03:03.847545 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:03:03.847631 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.848779 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:03:03.848869 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 16:03:03.848957 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.849611 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:03:03.849696 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:03:03.849775 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:03:03.849854 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:03:03.850443 (Thread-9): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:03:03.850560 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:03:03.850636 (Thread-9): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:03:03.850724 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.851554 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:03:03.851651 (Thread-9): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.851732 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:03:03.852444 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:03:03.852568 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 16:03:03.853976 (Thread-9): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:03:03.854102 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:03:03.854919 (Thread-9): finished collecting timing info
2021-11-26 16:03:03.855703 (Thread-8): finished collecting timing info
2021-11-26 16:03:03.855877 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 16:03:03.855991 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:03:03.856292 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f305f62b0>]}
2021-11-26 16:03:03.856577 (Thread-9): 17:03:03 | 7 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.03s]
2021-11-26 16:03:03.856791 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a4a875-9680-4c0d-9017-9f695d407bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f305f4e80>]}
2021-11-26 16:03:03.856961 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:03:03.857206 (Thread-8): 17:03:03 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:03:03.857470 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:03:03.858491 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:03:03.858645 (MainThread): Using postgres connection "master".
2021-11-26 16:03:03.858735 (MainThread): On master: BEGIN
2021-11-26 16:03:03.858824 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:03:03.861879 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:03:03.861994 (MainThread): On master: COMMIT
2021-11-26 16:03:03.862074 (MainThread): Using postgres connection "master".
2021-11-26 16:03:03.862148 (MainThread): On master: COMMIT
2021-11-26 16:03:03.862415 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:03:03.862503 (MainThread): On master: Close
2021-11-26 16:03:03.862735 (MainThread): 17:03:03 | 
2021-11-26 16:03:03.862843 (MainThread): 17:03:03 | Finished running 4 view models, 3 table models in 0.29s.
2021-11-26 16:03:03.862937 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:03:03.863019 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:03:03.863095 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:03:03.863168 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:03:03.863243 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:03:03.863316 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:03:03.863388 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:03:03.863457 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:03:03.866415 (MainThread): 
2021-11-26 16:03:03.866542 (MainThread): Completed successfully
2021-11-26 16:03:03.866652 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 16:03:03.866799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f22bdb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f22a8a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f22bd0e80>]}
2021-11-26 16:03:03.866955 (MainThread): Flushing usage events
2021-11-26 16:04:27.327230 (MainThread): Running with dbt=0.21.0
2021-11-26 16:04:27.390476 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:04:27.392095 (MainThread): Tracking: tracking
2021-11-26 16:04:27.417000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff272a27fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff272a36b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff272a07c10>]}
2021-11-26 16:04:27.425316 (MainThread): Partial parsing not enabled
2021-11-26 16:04:27.434563 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:04:27.437192 (MainThread): Parsing macros/relations.sql
2021-11-26 16:04:27.438296 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:04:27.455700 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:04:27.456908 (MainThread): Parsing macros/core.sql
2021-11-26 16:04:27.459512 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:04:27.464561 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:04:27.471655 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:04:27.472809 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:04:27.485225 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:04:27.514902 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:04:27.532617 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:04:27.533831 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:04:27.541833 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:04:27.559431 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:04:27.570559 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:04:27.577104 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:04:27.583058 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:04:27.585723 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:04:27.586719 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:04:27.587341 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:04:27.588387 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:04:27.594740 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:04:27.595967 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:04:27.597613 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:04:27.598674 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:04:27.643032 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:04:27.644198 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:04:27.644978 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:04:27.645872 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:04:27.762271 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:27.770698 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:27.772513 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:27.774165 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:27.776439 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:27.778757 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:27.781287 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:27.811905 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff240111c40>]}
2021-11-26 16:04:27.815544 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2400cb610>]}
2021-11-26 16:04:27.815720 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:04:27.816699 (MainThread): 
2021-11-26 16:04:27.816906 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:04:27.817818 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:04:27.824312 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:04:27.824482 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:04:27.824575 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:04:27.861417 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 16:04:27.863003 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:04:27.864045 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:04:27.868256 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:04:27.868383 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:04:27.868487 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:04:27.873407 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:27.873543 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:04:27.873638 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:04:27.880272 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:04:27.881245 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:04:27.881557 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:04:27.885162 (MainThread): Using postgres connection "master".
2021-11-26 16:04:27.885285 (MainThread): On master: BEGIN
2021-11-26 16:04:27.885394 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:04:27.890438 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:04:27.890562 (MainThread): Using postgres connection "master".
2021-11-26 16:04:27.890656 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:04:27.953407 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:04:27.954818 (MainThread): On master: ROLLBACK
2021-11-26 16:04:27.955231 (MainThread): Using postgres connection "master".
2021-11-26 16:04:27.955387 (MainThread): On master: BEGIN
2021-11-26 16:04:27.956139 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:27.956304 (MainThread): On master: COMMIT
2021-11-26 16:04:27.956449 (MainThread): Using postgres connection "master".
2021-11-26 16:04:27.956584 (MainThread): On master: COMMIT
2021-11-26 16:04:27.957100 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:27.957265 (MainThread): On master: Close
2021-11-26 16:04:27.957605 (MainThread): 17:04:27 | Concurrency: 10 threads (target='dev')
2021-11-26 16:04:27.957797 (MainThread): 17:04:27 | 
2021-11-26 16:04:27.961815 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:04:27.962059 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:04:27.962223 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:04:27.962461 (Thread-1): 17:04:27 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:04:27.962594 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:04:27.962825 (Thread-2): 17:04:27 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:04:27.963019 (Thread-3): 17:04:27 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:04:27.963342 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:27.963575 (Thread-4): 17:04:27 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:04:27.963885 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:27.964181 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:27.964349 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:04:27.964723 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:27.964888 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:04:27.965047 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:04:27.967413 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:04:27.967595 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:04:27.968685 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:04:27.969697 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:04:27.970920 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:04:27.971363 (Thread-1): finished collecting timing info
2021-11-26 16:04:27.971682 (Thread-2): finished collecting timing info
2021-11-26 16:04:27.990767 (Thread-3): finished collecting timing info
2021-11-26 16:04:27.998861 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:04:28.005364 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:04:28.007429 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:04:28.007545 (Thread-4): finished collecting timing info
2021-11-26 16:04:28.009096 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:04:28.009333 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:28.009455 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:28.009558 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:28.009636 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:04:28.009747 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:04:28.009858 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:28.009941 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:04:28.010033 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:04:28.010115 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:04:28.010197 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:04:28.010286 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:04:28.010533 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:04:28.014921 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:28.015079 (Thread-2): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:04:28.015179 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:04:28.015266 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:28.015360 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:28.015453 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:28.015552 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:28.015643 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:28.015734 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:04:28.015822 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:04:28.015910 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:04:28.016003 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:04:28.017658 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:04:28.022022 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:28.022165 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:04:28.022265 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:04:28.022470 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:04:28.022556 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:04:28.023834 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:28.025131 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:28.026295 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:28.026431 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:04:28.026523 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:04:28.026602 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:04:28.026776 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.028026 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:28.028135 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.028219 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:04:28.028292 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.028377 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.029465 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:28.030655 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:28.030778 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.031951 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:28.032062 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:04:28.032154 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:04:28.038748 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:04:28.038858 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:04:28.038999 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:28.039139 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:04:28.039341 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.039938 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:04:28.040034 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.040116 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:28.040185 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.040271 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:28.040840 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:04:28.040934 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:04:28.041476 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:04:28.044093 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:28.044202 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:28.044319 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:28.044403 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:04:28.044481 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:04:28.044562 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:04:28.044660 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:28.045530 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:28.045619 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:04:28.045716 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:28.046481 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:28.046577 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:04:28.046669 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:28.047426 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:28.047525 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:04:28.047605 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:04:28.048206 (Thread-1): finished collecting timing info
2021-11-26 16:04:28.048310 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:04:28.048431 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:04:28.048964 (Thread-2): finished collecting timing info
2021-11-26 16:04:28.049080 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:04:28.049336 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff272c27730>]}
2021-11-26 16:04:28.049431 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:04:28.050003 (Thread-3): finished collecting timing info
2021-11-26 16:04:28.050107 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:04:28.050328 (Thread-1): 17:04:28 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 16:04:28.050542 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff272c271c0>]}
2021-11-26 16:04:28.050630 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:04:28.051207 (Thread-4): finished collecting timing info
2021-11-26 16:04:28.051482 (Thread-2): 17:04:28 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:04:28.051611 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:04:28.051758 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:04:28.051963 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff272c3b0a0>]}
2021-11-26 16:04:28.052107 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:04:28.052408 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:04:28.052631 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2400a3d00>]}
2021-11-26 16:04:28.052831 (Thread-3): 17:04:28 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:04:28.053047 (Thread-6): 17:04:28 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:04:28.053263 (Thread-4): 17:04:28 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:04:28.053430 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:04:28.053668 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:28.053765 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:04:28.053920 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:04:28.054119 (Thread-4): Began running node model.demo_dbt.dim_customers
2021-11-26 16:04:28.055855 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:04:28.056033 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 16:04:28.056207 (Thread-4): 17:04:28 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:04:28.056447 (Thread-9): 17:04:28 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:04:28.056850 (Thread-4): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:28.057159 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:28.057317 (Thread-4): Compiling model.demo_dbt.dim_customers
2021-11-26 16:04:28.058810 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 16:04:28.060359 (Thread-4): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:04:28.061765 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:04:28.061899 (Thread-6): finished collecting timing info
2021-11-26 16:04:28.063146 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:04:28.063360 (Thread-9): finished collecting timing info
2021-11-26 16:04:28.064496 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:04:28.064623 (Thread-4): finished collecting timing info
2021-11-26 16:04:28.065691 (Thread-4): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:04:28.065841 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:28.065956 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:04:28.066057 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:04:28.066258 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:28.066335 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:04:28.066427 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:04:28.066638 (Thread-4): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:28.066715 (Thread-4): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:04:28.066794 (Thread-4): Opening a new connection, currently in state closed
2021-11-26 16:04:28.070682 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:28.070842 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:28.070934 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:28.071023 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:28.071109 (Thread-4): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:28.071197 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:28.071302 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    orders.customer_id,
    orders.customer_id
    from orders
)
select * from order_payments
  );
2021-11-26 16:04:28.071402 (Thread-4): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:04:28.071490 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:04:28.074298 (Thread-9): Postgres error: column "customer_id" specified more than once

2021-11-26 16:04:28.074406 (Thread-9): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 16:04:28.074639 (Thread-9): finished collecting timing info
2021-11-26 16:04:28.074747 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 16:04:28.075835 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:04:28.077080 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:28.077186 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:04:28.077897 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.078499 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:04:28.078591 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:28.078694 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:04:28.079510 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:28.079613 (Thread-4): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 16:04:28.080473 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:28.081700 (Thread-4): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:28.081815 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:04:28.081928 (Thread-4): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:04:28.082362 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:04:28.082928 (Thread-6): finished collecting timing info
2021-11-26 16:04:28.083036 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:04:28.083158 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.084217 (Thread-4): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:28.084308 (Thread-4): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:04:28.084512 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2600f41c0>]}
2021-11-26 16:04:28.084792 (Thread-6): 17:04:28 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:04:28.084914 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:04:28.074965 (Thread-9): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  column "customer_id" specified more than once
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DuplicateColumn: column "customer_id" specified more than once


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  column "customer_id" specified more than once
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:04:28.085289 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2400efeb0>]}
2021-11-26 16:04:28.085476 (Thread-9): 17:04:28 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.03s]
2021-11-26 16:04:28.085579 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:04:28.085680 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:28.086528 (Thread-4): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:04:28.086628 (Thread-4): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:28.086709 (Thread-4): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:04:28.087243 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:28.088456 (Thread-4): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:28.088553 (Thread-4): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:04:28.091116 (Thread-4): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:04:28.091764 (Thread-4): finished collecting timing info
2021-11-26 16:04:28.091879 (Thread-4): On model.demo_dbt.dim_customers: Close
2021-11-26 16:04:28.092101 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e3a947a-b0cc-4d3e-93e8-a1b2a1e0d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2508b3f40>]}
2021-11-26 16:04:28.092312 (Thread-4): 17:04:28 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 16:04:28.092419 (Thread-4): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:04:28.093301 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:04:28.093434 (MainThread): Using postgres connection "master".
2021-11-26 16:04:28.093519 (MainThread): On master: BEGIN
2021-11-26 16:04:28.093604 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:04:28.098502 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:28.098616 (MainThread): On master: COMMIT
2021-11-26 16:04:28.098706 (MainThread): Using postgres connection "master".
2021-11-26 16:04:28.098793 (MainThread): On master: COMMIT
2021-11-26 16:04:28.099035 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:28.099135 (MainThread): On master: Close
2021-11-26 16:04:28.099363 (MainThread): 17:04:28 | 
2021-11-26 16:04:28.099475 (MainThread): 17:04:28 | Finished running 3 table models, 4 view models in 0.28s.
2021-11-26 16:04:28.099574 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:04:28.099658 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:04:28.099739 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:04:28.099818 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:04:28.099898 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:04:28.099978 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:04:28.100058 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:04:28.103054 (MainThread): 
2021-11-26 16:04:28.103192 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 16:04:28.103292 (MainThread): 
2021-11-26 16:04:28.103384 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 16:04:28.103470 (MainThread):   column "customer_id" specified more than once
2021-11-26 16:04:28.103552 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:04:28.103647 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 16:04:28.103796 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2400ec8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff272a36b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff270e0f8b0>]}
2021-11-26 16:04:28.103953 (MainThread): Flushing usage events
2021-11-26 16:04:47.122292 (MainThread): Running with dbt=0.21.0
2021-11-26 16:04:47.188745 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:04:47.190673 (MainThread): Tracking: tracking
2021-11-26 16:04:47.217691 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34acb7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34acc6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ac98790>]}
2021-11-26 16:04:47.226269 (MainThread): Partial parsing not enabled
2021-11-26 16:04:47.237589 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:04:47.240222 (MainThread): Parsing macros/relations.sql
2021-11-26 16:04:47.241323 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:04:47.258377 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:04:47.259569 (MainThread): Parsing macros/core.sql
2021-11-26 16:04:47.262190 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:04:47.267268 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:04:47.274364 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:04:47.275648 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:04:47.288110 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:04:47.315622 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:04:47.332953 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:04:47.334149 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:04:47.341730 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:04:47.357508 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:04:47.368298 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:04:47.374390 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:04:47.380026 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:04:47.382670 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:04:47.383656 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:04:47.384281 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:04:47.385318 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:04:47.391632 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:04:47.392823 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:04:47.394475 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:04:47.395526 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:04:47.438662 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:04:47.439796 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:04:47.440557 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:04:47.441448 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:04:47.555299 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:47.563082 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:47.564782 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:47.566437 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:47.568661 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:47.570827 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:47.573338 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:47.604595 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ae29b80>]}
2021-11-26 16:04:47.608182 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34adcf9d0>]}
2021-11-26 16:04:47.608355 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:04:47.609356 (MainThread): 
2021-11-26 16:04:47.609559 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:04:47.610481 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:04:47.617020 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:04:47.617185 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:04:47.617275 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:04:47.663996 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 16:04:47.665597 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:04:47.666641 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:04:47.671153 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:04:47.671290 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:04:47.671403 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:04:47.676216 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.676333 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:04:47.676426 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:04:47.683074 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:04:47.684000 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:04:47.684397 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:04:47.687976 (MainThread): Using postgres connection "master".
2021-11-26 16:04:47.688110 (MainThread): On master: BEGIN
2021-11-26 16:04:47.688226 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:04:47.692968 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.693094 (MainThread): Using postgres connection "master".
2021-11-26 16:04:47.693192 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:04:47.756989 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:04:47.758270 (MainThread): On master: ROLLBACK
2021-11-26 16:04:47.758730 (MainThread): Using postgres connection "master".
2021-11-26 16:04:47.758871 (MainThread): On master: BEGIN
2021-11-26 16:04:47.759490 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.759619 (MainThread): On master: COMMIT
2021-11-26 16:04:47.759735 (MainThread): Using postgres connection "master".
2021-11-26 16:04:47.759841 (MainThread): On master: COMMIT
2021-11-26 16:04:47.760271 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.760401 (MainThread): On master: Close
2021-11-26 16:04:47.760687 (MainThread): 17:04:47 | Concurrency: 10 threads (target='dev')
2021-11-26 16:04:47.760841 (MainThread): 17:04:47 | 
2021-11-26 16:04:47.763753 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:04:47.763966 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:04:47.764142 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:04:47.764275 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:04:47.764507 (Thread-1): 17:04:47 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:04:47.764710 (Thread-2): 17:04:47 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:04:47.765085 (Thread-3): 17:04:47 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:04:47.765351 (Thread-4): 17:04:47 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:04:47.765842 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:47.766242 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:47.766424 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:04:47.766686 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:47.766801 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:04:47.767029 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:47.769317 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:04:47.769513 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:04:47.770602 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:04:47.770804 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:04:47.771925 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:04:47.773257 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:04:47.773548 (Thread-1): finished collecting timing info
2021-11-26 16:04:47.773855 (Thread-2): finished collecting timing info
2021-11-26 16:04:47.786348 (Thread-3): finished collecting timing info
2021-11-26 16:04:47.792804 (Thread-4): finished collecting timing info
2021-11-26 16:04:47.801012 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:04:47.811024 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:04:47.811221 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:04:47.812512 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:04:47.813002 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:47.813124 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:47.813208 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:04:47.813295 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:47.813377 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:47.813459 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:04:47.813548 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:04:47.813627 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:04:47.813718 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:04:47.813816 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:04:47.813985 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:04:47.814071 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:04:47.817486 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.817626 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.817720 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.817800 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.817879 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:47.817968 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:47.818057 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:47.818137 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:47.818219 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:04:47.818301 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:04:47.818380 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:04:47.818460 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:04:47.819877 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:04:47.823993 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:47.824237 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:04:47.824332 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:04:47.824421 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:04:47.824502 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:04:47.825714 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:47.826989 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:47.827091 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.828289 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:47.828395 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:04:47.828481 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:04:47.829596 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:47.829698 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:04:47.829833 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:04:47.830141 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.831249 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:47.831348 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.831432 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:04:47.831502 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.831591 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.832713 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:47.833874 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:47.833973 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.840448 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:04:47.840548 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:04:47.840636 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:04:47.841181 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:04:47.841271 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:47.841408 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:47.841526 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:04:47.841622 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:04:47.841716 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.841797 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.842482 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:04:47.842576 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.842653 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.843197 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:04:47.843290 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:47.845841 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:04:47.846696 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:04:47.846798 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:47.846891 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:04:47.846973 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:04:47.847050 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:04:47.847127 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:04:47.847435 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.847528 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.848348 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:04:47.848454 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:04:47.848532 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:04:47.849325 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:04:47.849420 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:04:47.850086 (Thread-1): finished collecting timing info
2021-11-26 16:04:47.850676 (Thread-4): finished collecting timing info
2021-11-26 16:04:47.850775 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:04:47.850905 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:04:47.851009 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:04:47.851281 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35813faf0>]}
2021-11-26 16:04:47.851470 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34add0730>]}
2021-11-26 16:04:47.851733 (Thread-1): 17:04:47 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 16:04:47.851846 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:04:47.851952 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:04:47.852139 (Thread-4): 17:04:47 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.08s]
2021-11-26 16:04:47.852270 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:04:47.852926 (Thread-3): finished collecting timing info
2021-11-26 16:04:47.853491 (Thread-2): finished collecting timing info
2021-11-26 16:04:47.853664 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:04:47.853865 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:04:47.854019 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:04:47.854120 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:04:47.854452 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34adbd460>]}
2021-11-26 16:04:47.854605 (Thread-6): 17:04:47 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:04:47.854799 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe328544430>]}
2021-11-26 16:04:47.855070 (Thread-2): 17:04:47 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:04:47.855256 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:47.855461 (Thread-3): 17:04:47 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:04:47.855578 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:04:47.855677 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:04:47.855931 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:04:47.857792 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:04:47.858295 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:04:47.858437 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 16:04:47.858609 (Thread-8): 17:04:47 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:04:47.858785 (Thread-9): 17:04:47 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:04:47.859062 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:47.859172 (Thread-6): finished collecting timing info
2021-11-26 16:04:47.859289 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:04:47.859472 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:47.861884 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:04:47.863378 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:04:47.863486 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 16:04:47.864909 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:04:47.865190 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:47.865292 (Thread-9): finished collecting timing info
2021-11-26 16:04:47.865389 (Thread-8): finished collecting timing info
2021-11-26 16:04:47.865486 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:04:47.866619 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:04:47.867640 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:04:47.867756 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:04:47.868086 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:47.868195 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:47.868276 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:04:47.868364 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:04:47.868454 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:04:47.868544 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:04:47.871845 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.872061 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.872179 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.872273 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:47.872365 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:47.872449 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:47.872534 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:04:47.872621 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    orders.order_id,
    orders.customer_id
    from orders
)
select * from order_payments
  );
2021-11-26 16:04:47.872701 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:04:47.874884 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:04:47.876425 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:47.876537 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:04:47.876643 (Thread-9): SQL status: SELECT 99 in 0.00 seconds
2021-11-26 16:04:47.876762 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:04:47.877996 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:47.878099 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.879277 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:47.879391 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2021-11-26 16:04:47.879965 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:04:47.880057 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:04:47.880172 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:47.880270 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:04:47.880451 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.880539 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.881594 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:47.881677 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.882812 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:47.882907 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 16:04:47.883670 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:04:47.883764 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:04:47.883871 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:04:47.884119 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:04:47.884211 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.884297 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:04:47.884859 (Thread-6): finished collecting timing info
2021-11-26 16:04:47.885478 (Thread-9): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:04:47.886096 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:04:47.886211 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:04:47.886307 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:47.886389 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:47.886490 (Thread-9): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:04:47.886709 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35813f070>]}
2021-11-26 16:04:47.886802 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:04:47.887165 (Thread-6): 17:04:47 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:04:47.887295 (Thread-9): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.887460 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:04:47.888700 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:04:47.888845 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.889026 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 16:04:47.889859 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:04:47.889988 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:04:47.891008 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:04:47.891207 (Thread-9): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:04:47.891854 (Thread-8): finished collecting timing info
2021-11-26 16:04:47.892406 (Thread-9): finished collecting timing info
2021-11-26 16:04:47.892517 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:04:47.892613 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 16:04:47.892858 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34adbd4f0>]}
2021-11-26 16:04:47.893080 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00200cec-6ec8-489b-9214-fe4a4e41c354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ad5a940>]}
2021-11-26 16:04:47.893305 (Thread-8): 17:04:47 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:04:47.893491 (Thread-9): 17:04:47 | 7 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.03s]
2021-11-26 16:04:47.893597 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:04:47.893710 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:04:47.894553 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:04:47.894669 (MainThread): Using postgres connection "master".
2021-11-26 16:04:47.894750 (MainThread): On master: BEGIN
2021-11-26 16:04:47.894834 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:04:47.897827 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:04:47.897950 (MainThread): On master: COMMIT
2021-11-26 16:04:47.898032 (MainThread): Using postgres connection "master".
2021-11-26 16:04:47.898113 (MainThread): On master: COMMIT
2021-11-26 16:04:47.898287 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:04:47.898376 (MainThread): On master: Close
2021-11-26 16:04:47.898609 (MainThread): 17:04:47 | 
2021-11-26 16:04:47.898725 (MainThread): 17:04:47 | Finished running 3 table models, 4 view models in 0.29s.
2021-11-26 16:04:47.898825 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:04:47.898906 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:04:47.898982 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:04:47.899059 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:04:47.899134 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:04:47.899208 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:04:47.899281 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:04:47.899353 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:04:47.902278 (MainThread): 
2021-11-26 16:04:47.902409 (MainThread): Completed successfully
2021-11-26 16:04:47.902522 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 16:04:47.902690 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ae027f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33814cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34acc6430>]}
2021-11-26 16:04:47.902851 (MainThread): Flushing usage events
2021-11-26 16:05:38.126177 (MainThread): Running with dbt=0.21.0
2021-11-26 16:05:38.191025 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:05:38.192816 (MainThread): Tracking: tracking
2021-11-26 16:05:38.218961 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02c87dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02c96b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02c67a30>]}
2021-11-26 16:05:38.227432 (MainThread): Partial parsing not enabled
2021-11-26 16:05:38.236653 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:05:38.239756 (MainThread): Parsing macros/relations.sql
2021-11-26 16:05:38.240816 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:05:38.257539 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:05:38.258706 (MainThread): Parsing macros/core.sql
2021-11-26 16:05:38.261253 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:05:38.266162 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:05:38.273037 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:05:38.274169 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:05:38.286257 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:05:38.313355 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:05:38.330840 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:05:38.332112 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:05:38.339690 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:05:38.355324 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:05:38.366481 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:05:38.372580 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:05:38.378210 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:05:38.380870 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:05:38.381857 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:05:38.382483 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:05:38.383513 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:05:38.389714 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:05:38.390907 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:05:38.392553 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:05:38.393598 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:05:38.436179 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:05:38.437312 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:05:38.438077 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:05:38.438959 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:05:38.553670 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:05:38.561545 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:05:38.563252 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:05:38.564962 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:05:38.567210 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:05:38.569397 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:05:38.571941 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:05:38.603169 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f00ccc70>]}
2021-11-26 16:05:38.606999 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f0070dc0>]}
2021-11-26 16:05:38.607180 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:05:38.608196 (MainThread): 
2021-11-26 16:05:38.608424 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:05:38.609341 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:05:38.615849 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:05:38.616009 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:05:38.616103 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:05:38.654329 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 16:05:38.655925 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:05:38.656978 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:05:38.661397 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:05:38.661521 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:05:38.661625 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:05:38.667647 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:05:38.667772 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:05:38.667869 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:05:38.674756 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:05:38.675721 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:05:38.676077 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:05:38.679629 (MainThread): Using postgres connection "master".
2021-11-26 16:05:38.679760 (MainThread): On master: BEGIN
2021-11-26 16:05:38.679875 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:05:38.684885 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:05:38.685002 (MainThread): Using postgres connection "master".
2021-11-26 16:05:38.685106 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:05:38.749318 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:05:38.750637 (MainThread): On master: ROLLBACK
2021-11-26 16:05:38.751020 (MainThread): Using postgres connection "master".
2021-11-26 16:05:38.751159 (MainThread): On master: BEGIN
2021-11-26 16:05:38.751567 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:05:38.751712 (MainThread): On master: COMMIT
2021-11-26 16:05:38.751836 (MainThread): Using postgres connection "master".
2021-11-26 16:05:38.751951 (MainThread): On master: COMMIT
2021-11-26 16:05:38.752251 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:05:38.752395 (MainThread): On master: Close
2021-11-26 16:05:38.752705 (MainThread): 17:05:38 | Concurrency: 10 threads (target='dev')
2021-11-26 16:05:38.752869 (MainThread): 17:05:38 | 
2021-11-26 16:05:38.756748 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:05:38.757030 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:05:38.757272 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:05:38.757426 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:05:38.757707 (Thread-1): 17:05:38 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:05:38.758000 (Thread-2): 17:05:38 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:05:38.758237 (Thread-3): 17:05:38 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:05:38.758447 (Thread-4): 17:05:38 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:05:38.758974 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:05:38.759375 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:05:38.759751 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:05:38.760104 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:05:38.760306 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:05:38.760470 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:05:38.760602 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:05:38.760726 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:05:38.763011 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:05:38.764043 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:05:38.764947 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:05:38.765938 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:05:38.766465 (Thread-1): finished collecting timing info
2021-11-26 16:05:38.766629 (Thread-2): finished collecting timing info
2021-11-26 16:05:38.773189 (Thread-3): finished collecting timing info
2021-11-26 16:05:38.773451 (Thread-4): finished collecting timing info
2021-11-26 16:05:38.794369 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:05:38.800412 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:05:38.802499 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:05:38.803780 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:05:38.804343 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:05:38.804449 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:05:38.804550 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:05:38.804749 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:05:38.804851 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:05:38.804939 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:05:38.805128 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:05:38.805231 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:05:38.805324 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:05:38.805582 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:05:38.805681 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:05:38.805765 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:05:38.807844 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:05:38.807980 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:05:38.808115 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:05:38.808216 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:05:38.808313 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:05:38.808399 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:05:38.808483 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:05:38.808559 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:05:38.808643 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:05:38.808731 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:05:38.808810 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:05:38.808945 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:05:38.810474 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:05:38.814441 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:05:38.814556 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:05:38.814644 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:05:38.814819 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:05:38.814908 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:05:38.816062 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:05:38.817287 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:05:38.818477 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:05:38.818643 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:05:38.818733 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:05:38.818837 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:05:38.819092 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.820346 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:05:38.820450 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.820538 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:05:38.820610 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.820696 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.821757 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:05:38.823004 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:05:38.823113 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.824224 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:05:38.824319 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:05:38.824405 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:05:38.830904 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:05:38.830996 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:05:38.831131 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:05:38.831244 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:05:38.831376 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.832026 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:05:38.832125 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.832206 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:05:38.832274 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.832358 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:05:38.832922 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:05:38.833015 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:05:38.833545 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:05:38.836105 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:05:38.836210 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:05:38.836322 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:05:38.836406 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:05:38.836488 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:05:38.836570 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:05:38.836743 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:05:38.836830 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:05:38.837777 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:05:38.837873 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:05:38.837950 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:05:38.838770 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:05:38.838876 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:05:38.839688 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:05:38.840339 (Thread-1): finished collecting timing info
2021-11-26 16:05:38.840449 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:05:38.840569 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:05:38.840677 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:05:38.840972 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea206d6b80>]}
2021-11-26 16:05:38.841203 (Thread-1): 17:05:38 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2021-11-26 16:05:38.841318 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:05:38.841623 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:05:38.841826 (Thread-6): 17:05:38 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:05:38.841928 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:05:38.842013 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:05:38.842100 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:05:38.842310 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:05:38.842935 (Thread-2): finished collecting timing info
2021-11-26 16:05:38.843524 (Thread-4): finished collecting timing info
2021-11-26 16:05:38.844087 (Thread-3): finished collecting timing info
2021-11-26 16:05:38.844201 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:05:38.844301 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:05:38.844401 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:05:38.844512 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:05:38.845811 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:05:38.846082 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea206ea8b0>]}
2021-11-26 16:05:38.846247 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2071bd60>]}
2021-11-26 16:05:38.846533 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea206d6670>]}
2021-11-26 16:05:38.846783 (Thread-4): 17:05:38 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:05:38.846993 (Thread-2): 17:05:38 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:05:38.847196 (Thread-3): 17:05:38 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:05:38.847319 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:05:38.847429 (Thread-6): finished collecting timing info
2021-11-26 16:05:38.848638 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:05:38.848759 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:05:38.849995 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:05:38.850340 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:05:38.850462 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 16:05:38.850624 (Thread-8): 17:05:38 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:05:38.850785 (Thread-9): 17:05:38 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:05:38.851020 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:05:38.851139 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:05:38.851246 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:05:38.851406 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:05:38.851491 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:05:38.853147 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:05:38.853275 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 16:05:38.853382 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:05:38.854965 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:05:38.855467 (Thread-8): finished collecting timing info
2021-11-26 16:05:38.855594 (Thread-9): finished collecting timing info
2021-11-26 16:05:38.857247 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:05:38.858454 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:05:38.858812 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:05:38.858926 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:05:38.859025 (Thread-6): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:05:38.859116 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:05:38.859202 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:05:38.859286 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:05:38.859372 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:05:38.859450 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:05:38.859525 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:05:38.861533 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:05:38.862830 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:05:38.862973 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:05:38.863153 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:05:38.863248 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:05:38.863333 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:05:38.863414 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.863517 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:05:38.863600 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    orders.order_id,
    orders.customer_id,
    payments.amount

    from orders
    group by 1
)
select * from order_payments
  );
2021-11-26 16:05:38.864340 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:05:38.864436 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:05:38.864559 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:05:38.864674 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:05:38.864950 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:05:38.865054 (Thread-9): Postgres error: missing FROM-clause entry for table "payments"
LINE 19:     payments.amount
             ^

2021-11-26 16:05:38.865809 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:05:38.865913 (Thread-9): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 16:05:38.865996 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:05:38.866202 (Thread-9): finished collecting timing info
2021-11-26 16:05:38.866303 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:05:38.866396 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 16:05:38.866996 (Thread-6): finished collecting timing info
2021-11-26 16:05:38.867104 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:05:38.867219 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:05:38.868781 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:05:38.869062 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2070dd00>]}
2021-11-26 16:05:38.869151 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:05:38.869546 (Thread-6): 17:05:38 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:05:38.869693 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.871313 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:05:38.871469 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:05:38.871592 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:05:38.872234 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:05:38.873093 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:05:38.873225 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:05:38.873322 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:05:38.873657 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:05:38.874444 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:05:38.874538 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:05:38.875561 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:05:38.876336 (Thread-8): finished collecting timing info
2021-11-26 16:05:38.876453 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:05:38.876686 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02da4670>]}
2021-11-26 16:05:38.876923 (Thread-8): 17:05:38 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:05:38.877096 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:05:38.867400 (Thread-9): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  missing FROM-clause entry for table "payments"
  LINE 19:     payments.amount
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: missing FROM-clause entry for table "payments"
LINE 19:     payments.amount
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  missing FROM-clause entry for table "payments"
  LINE 19:     payments.amount
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:05:38.877597 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f4d2f00-982a-4275-a0f3-ae417152c60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea206f4bb0>]}
2021-11-26 16:05:38.877784 (Thread-9): 17:05:38 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.03s]
2021-11-26 16:05:38.877888 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:05:38.878726 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:05:38.878853 (MainThread): Using postgres connection "master".
2021-11-26 16:05:38.878935 (MainThread): On master: BEGIN
2021-11-26 16:05:38.879017 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:05:38.882087 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:05:38.882202 (MainThread): On master: COMMIT
2021-11-26 16:05:38.882281 (MainThread): Using postgres connection "master".
2021-11-26 16:05:38.882356 (MainThread): On master: COMMIT
2021-11-26 16:05:38.882500 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:05:38.882587 (MainThread): On master: Close
2021-11-26 16:05:38.882826 (MainThread): 17:05:38 | 
2021-11-26 16:05:38.882933 (MainThread): 17:05:38 | Finished running 3 table models, 4 view models in 0.27s.
2021-11-26 16:05:38.883030 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:05:38.883109 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:05:38.883185 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:05:38.883262 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:05:38.883337 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:05:38.883412 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:05:38.883483 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:05:38.883553 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:05:38.886648 (MainThread): 
2021-11-26 16:05:38.886825 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 16:05:38.886926 (MainThread): 
2021-11-26 16:05:38.887021 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 16:05:38.887107 (MainThread):   missing FROM-clause entry for table "payments"
2021-11-26 16:05:38.887191 (MainThread):   LINE 19:     payments.amount
2021-11-26 16:05:38.887275 (MainThread):                ^
2021-11-26 16:05:38.887359 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:05:38.887460 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 16:05:38.887632 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f00ab910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea02c96b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea00e6f8e0>]}
2021-11-26 16:05:38.887803 (MainThread): Flushing usage events
2021-11-26 16:06:44.983006 (MainThread): Running with dbt=0.21.0
2021-11-26 16:06:45.037836 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:06:45.042341 (MainThread): Tracking: tracking
2021-11-26 16:06:45.065040 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a877f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a886400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a858790>]}
2021-11-26 16:06:45.073269 (MainThread): Partial parsing not enabled
2021-11-26 16:06:45.080276 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:06:45.082566 (MainThread): Parsing macros/relations.sql
2021-11-26 16:06:45.083592 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:06:45.099824 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:06:45.100976 (MainThread): Parsing macros/core.sql
2021-11-26 16:06:45.103510 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:06:45.108425 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:06:45.115238 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:06:45.116355 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:06:45.128262 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:06:45.154410 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:06:45.171001 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:06:45.172170 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:06:45.179517 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:06:45.194528 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:06:45.204771 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:06:45.210639 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:06:45.216082 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:06:45.218665 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:06:45.219631 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:06:45.220241 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:06:45.221251 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:06:45.227262 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:06:45.228419 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:06:45.230028 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:06:45.231056 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:06:45.271861 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:06:45.272963 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:06:45.273714 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:06:45.274577 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:06:45.387587 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:06:45.395443 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:06:45.397129 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:06:45.398765 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:06:45.400969 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:06:45.403145 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:06:45.405647 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:06:45.436149 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8b70b50>]}
2021-11-26 16:06:45.440100 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8b28490>]}
2021-11-26 16:06:45.440277 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:06:45.441253 (MainThread): 
2021-11-26 16:06:45.441461 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:06:45.442318 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:06:45.448698 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:06:45.448851 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:06:45.448943 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:06:45.489007 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 16:06:45.490619 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:06:45.491677 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:06:45.496143 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:06:45.496276 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:06:45.496386 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:06:45.501434 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:06:45.501551 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:06:45.501641 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:06:45.508270 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:06:45.509241 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:06:45.509491 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:06:45.513004 (MainThread): Using postgres connection "master".
2021-11-26 16:06:45.513138 (MainThread): On master: BEGIN
2021-11-26 16:06:45.513245 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:06:45.518339 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:06:45.518458 (MainThread): Using postgres connection "master".
2021-11-26 16:06:45.518553 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:06:45.577175 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:06:45.578386 (MainThread): On master: ROLLBACK
2021-11-26 16:06:45.578914 (MainThread): Using postgres connection "master".
2021-11-26 16:06:45.579050 (MainThread): On master: BEGIN
2021-11-26 16:06:45.579740 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:06:45.579883 (MainThread): On master: COMMIT
2021-11-26 16:06:45.580011 (MainThread): Using postgres connection "master".
2021-11-26 16:06:45.580128 (MainThread): On master: COMMIT
2021-11-26 16:06:45.580610 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:06:45.580753 (MainThread): On master: Close
2021-11-26 16:06:45.581042 (MainThread): 17:06:45 | Concurrency: 10 threads (target='dev')
2021-11-26 16:06:45.581204 (MainThread): 17:06:45 | 
2021-11-26 16:06:45.584447 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:06:45.584695 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:06:45.584879 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:06:45.585151 (Thread-1): 17:06:45 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:06:45.585299 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:06:45.585614 (Thread-2): 17:06:45 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:06:45.585874 (Thread-3): 17:06:45 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:06:45.586328 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:06:45.586552 (Thread-4): 17:06:45 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:06:45.586904 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:06:45.587243 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:06:45.587449 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:06:45.587808 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:06:45.587993 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:06:45.588167 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:06:45.590628 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:06:45.590816 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:06:45.591908 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:06:45.592890 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:06:45.594144 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:06:45.594725 (Thread-1): finished collecting timing info
2021-11-26 16:06:45.594931 (Thread-3): finished collecting timing info
2021-11-26 16:06:45.600745 (Thread-4): finished collecting timing info
2021-11-26 16:06:45.600889 (Thread-2): finished collecting timing info
2021-11-26 16:06:45.628193 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:06:45.631381 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:06:45.631540 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:06:45.632766 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:06:45.633215 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:06:45.633337 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:06:45.633420 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:06:45.633567 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:06:45.633665 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:06:45.633785 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:06:45.633900 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:06:45.633977 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:06:45.634059 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:06:45.634240 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:06:45.634415 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:06:45.634502 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:06:45.638203 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:06:45.638393 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:06:45.638489 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:06:45.638576 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:06:45.638675 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:06:45.638764 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:06:45.638844 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:06:45.638925 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:06:45.639005 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:06:45.639085 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:06:45.639164 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:06:45.639242 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:06:45.640889 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:06:45.645036 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:06:45.645170 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:06:45.645263 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:06:45.645349 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:06:45.645422 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:06:45.646627 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:06:45.647823 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:06:45.649097 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:06:45.649207 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:06:45.649291 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.649385 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:06:45.649468 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:06:45.650601 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:06:45.650697 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.650826 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:06:45.651936 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:06:45.652036 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.652120 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.652221 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:06:45.653631 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:06:45.653750 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.654887 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:06:45.655009 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:06:45.661454 (Thread-4): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 16:06:45.661625 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:06:45.661719 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:06:45.662340 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:06:45.662438 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.662518 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:06:45.662625 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:06:45.663180 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:06:45.663276 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.663358 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:06:45.663443 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:06:45.663525 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:06:45.664089 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:06:45.664241 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:06:45.664332 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:06:45.664437 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:06:45.664679 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:06:45.664801 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:06:45.667384 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:06:45.667470 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:06:45.667560 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:06:45.668402 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:06:45.668508 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:06:45.669307 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:06:45.670093 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:06:45.670188 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:06:45.670304 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:06:45.670390 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:06:45.672593 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:06:45.673225 (Thread-4): finished collecting timing info
2021-11-26 16:06:45.673331 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:06:45.673427 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:06:45.673501 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:06:45.673589 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:06:45.674131 (Thread-3): finished collecting timing info
2021-11-26 16:06:45.674755 (Thread-2): finished collecting timing info
2021-11-26 16:06:45.674980 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8b9bd90>]}
2021-11-26 16:06:45.675550 (Thread-1): finished collecting timing info
2021-11-26 16:06:45.675664 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:06:45.675758 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:06:45.675997 (Thread-4): 17:06:45 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:06:45.676090 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:06:45.676293 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8b9b4c0>]}
2021-11-26 16:06:45.676463 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8b9bac0>]}
2021-11-26 16:06:45.676565 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:06:45.676784 (Thread-3): 17:06:45 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:06:45.676970 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8b9b880>]}
2021-11-26 16:06:45.677200 (Thread-2): 17:06:45 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:06:45.677364 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:06:45.677556 (Thread-1): 17:06:45 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 16:06:45.677660 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:06:45.677863 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:06:45.678058 (Thread-6): Began running node model.demo_dbt.fct_orders
2021-11-26 16:06:45.678223 (Thread-7): Began running node model.demo_dbt.dim_customers
2021-11-26 16:06:45.678406 (Thread-6): 17:06:45 | 5 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:06:45.678540 (Thread-7): 17:06:45 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:06:45.678912 (Thread-6): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:06:45.679088 (Thread-7): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:06:45.679221 (Thread-9): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:06:45.679402 (Thread-6): Compiling model.demo_dbt.fct_orders
2021-11-26 16:06:45.679504 (Thread-7): Compiling model.demo_dbt.dim_customers
2021-11-26 16:06:45.679655 (Thread-9): 17:06:45 | 7 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:06:45.681380 (Thread-6): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:06:45.684542 (Thread-7): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:06:45.684865 (Thread-9): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:06:45.685167 (Thread-9): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:06:45.686913 (Thread-9): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:06:45.687383 (Thread-6): finished collecting timing info
2021-11-26 16:06:45.687534 (Thread-7): finished collecting timing info
2021-11-26 16:06:45.688987 (Thread-6): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:06:45.690161 (Thread-7): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:06:45.690251 (Thread-9): finished collecting timing info
2021-11-26 16:06:45.691488 (Thread-9): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:06:45.691686 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:06:45.691790 (Thread-6): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:06:45.691891 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:06:45.691980 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:06:45.692073 (Thread-7): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:06:45.692272 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:06:45.692373 (Thread-7): Opening a new connection, currently in state init
2021-11-26 16:06:45.692459 (Thread-9): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:06:45.692619 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:06:45.696652 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:06:45.696763 (Thread-7): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:06:45.696847 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:06:45.696931 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:06:45.697016 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:06:45.697096 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    orders.order_id,
    orders.customer_id,
    payments.amount

    from orders
    group by 1
    left join payments using (customer_id)
)
select * from order_payments
  );
2021-11-26 16:06:45.697178 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:06:45.697255 (Thread-7): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:06:45.697361 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:06:45.697662 (Thread-6): Postgres error: syntax error at or near "left"
LINE 23:     left join payments using (customer_id)
             ^

2021-11-26 16:06:45.697749 (Thread-6): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 16:06:45.697937 (Thread-6): finished collecting timing info
2021-11-26 16:06:45.698036 (Thread-6): On model.demo_dbt.fct_orders: Close
2021-11-26 16:06:45.698235 (Thread-6): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "left"
  LINE 23:     left join payments using (customer_id)
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "left"
LINE 23:     left join payments using (customer_id)
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "left"
  LINE 23:     left join payments using (customer_id)
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:06:45.699570 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a9e9bb0>]}
2021-11-26 16:06:45.699790 (Thread-6): 17:06:45 | 5 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.02s]
2021-11-26 16:06:45.699900 (Thread-6): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:06:45.701821 (Thread-9): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:06:45.703198 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:06:45.703330 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:06:45.704231 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.705045 (Thread-9): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:06:45.705175 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:06:45.705258 (Thread-9): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:06:45.705402 (Thread-7): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 16:06:45.707291 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:06:45.707422 (Thread-9): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:06:45.707514 (Thread-7): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:06:45.708371 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:06:45.708508 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:06:45.708810 (Thread-9): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:06:45.709430 (Thread-9): finished collecting timing info
2021-11-26 16:06:45.709534 (Thread-7): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.709633 (Thread-9): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:06:45.710725 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:06:45.710846 (Thread-7): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:06:45.711065 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a9a3100>]}
2021-11-26 16:06:45.711299 (Thread-9): 17:06:45 | 7 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:06:45.711408 (Thread-9): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:06:45.711826 (Thread-7): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:06:45.712481 (Thread-7): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:06:45.712571 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:06:45.712649 (Thread-7): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:06:45.713213 (Thread-7): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:06:45.714118 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:06:45.714216 (Thread-7): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:06:45.716767 (Thread-7): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:06:45.717457 (Thread-7): finished collecting timing info
2021-11-26 16:06:45.717574 (Thread-7): On model.demo_dbt.dim_customers: Close
2021-11-26 16:06:45.717804 (Thread-7): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f345df97-68c1-483d-ada7-d6eb4a1bea8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8aa3730>]}
2021-11-26 16:06:45.718015 (Thread-7): 17:06:45 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 16:06:45.718120 (Thread-7): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:06:45.719003 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:06:45.719153 (MainThread): Using postgres connection "master".
2021-11-26 16:06:45.719241 (MainThread): On master: BEGIN
2021-11-26 16:06:45.719330 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:06:45.727602 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:06:45.727785 (MainThread): On master: COMMIT
2021-11-26 16:06:45.727877 (MainThread): Using postgres connection "master".
2021-11-26 16:06:45.727963 (MainThread): On master: COMMIT
2021-11-26 16:06:45.728186 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:06:45.728290 (MainThread): On master: Close
2021-11-26 16:06:45.728559 (MainThread): 17:06:45 | 
2021-11-26 16:06:45.728674 (MainThread): 17:06:45 | Finished running 4 view models, 3 table models in 0.29s.
2021-11-26 16:06:45.728773 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:06:45.728857 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:06:45.728940 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:06:45.729020 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:06:45.729098 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:06:45.729179 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:06:45.729259 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:06:45.729338 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:06:45.732560 (MainThread): 
2021-11-26 16:06:45.732690 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 16:06:45.732787 (MainThread): 
2021-11-26 16:06:45.732883 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 16:06:45.732969 (MainThread):   syntax error at or near "left"
2021-11-26 16:06:45.733050 (MainThread):   LINE 23:     left join payments using (customer_id)
2021-11-26 16:06:45.733132 (MainThread):                ^
2021-11-26 16:06:45.733213 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:06:45.733309 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 16:06:45.733454 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8b4c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a858790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8b2e6a0>]}
2021-11-26 16:06:45.733605 (MainThread): Flushing usage events
2021-11-26 16:10:21.187606 (MainThread): Running with dbt=0.21.0
2021-11-26 16:10:21.251664 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:10:21.253556 (MainThread): Tracking: tracking
2021-11-26 16:10:21.280493 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902e77fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902e86af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902e58c10>]}
2021-11-26 16:10:21.289091 (MainThread): Partial parsing not enabled
2021-11-26 16:10:21.298676 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:10:21.301390 (MainThread): Parsing macros/relations.sql
2021-11-26 16:10:21.302551 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:10:21.319697 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:10:21.320894 (MainThread): Parsing macros/core.sql
2021-11-26 16:10:21.323456 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:10:21.328419 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:10:21.335425 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:10:21.336580 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:10:21.348796 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:10:21.376298 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:10:21.393578 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:10:21.394768 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:10:21.402327 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:10:21.418110 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:10:21.428875 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:10:21.434948 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:10:21.440548 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:10:21.443174 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:10:21.444159 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:10:21.444781 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:10:21.445809 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:10:21.452052 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:10:21.453232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:10:21.454873 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:10:21.455914 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:10:21.499225 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:10:21.500356 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:10:21.501117 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:10:21.502000 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:10:21.615186 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:21.623036 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:21.624768 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:21.626508 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:21.628807 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:21.630989 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:21.633487 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:21.664709 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f05d0c10>]}
2021-11-26 16:10:21.668556 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f032faf0>]}
2021-11-26 16:10:21.668730 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:10:21.669757 (MainThread): 
2021-11-26 16:10:21.669987 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:10:21.670884 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:10:21.676789 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:10:21.676894 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:10:21.676991 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:10:21.728807 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 16:10:21.730348 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:10:21.731311 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:10:21.735503 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:10:21.735635 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:10:21.735739 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:10:21.740495 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.740610 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:10:21.740698 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:10:21.747424 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:10:21.748344 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:10:21.748802 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:10:21.752346 (MainThread): Using postgres connection "master".
2021-11-26 16:10:21.752486 (MainThread): On master: BEGIN
2021-11-26 16:10:21.752596 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:10:21.758411 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:10:21.758528 (MainThread): Using postgres connection "master".
2021-11-26 16:10:21.758620 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:10:21.807064 (MainThread): SQL status: SELECT 4 in 0.05 seconds
2021-11-26 16:10:21.808331 (MainThread): On master: ROLLBACK
2021-11-26 16:10:21.808839 (MainThread): Using postgres connection "master".
2021-11-26 16:10:21.808977 (MainThread): On master: BEGIN
2021-11-26 16:10:21.809853 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.810000 (MainThread): On master: COMMIT
2021-11-26 16:10:21.810126 (MainThread): Using postgres connection "master".
2021-11-26 16:10:21.810242 (MainThread): On master: COMMIT
2021-11-26 16:10:21.810721 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:21.810868 (MainThread): On master: Close
2021-11-26 16:10:21.811167 (MainThread): 17:10:21 | Concurrency: 10 threads (target='dev')
2021-11-26 16:10:21.811339 (MainThread): 17:10:21 | 
2021-11-26 16:10:21.814486 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:10:21.814718 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:10:21.814877 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:10:21.815123 (Thread-1): 17:10:21 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:10:21.815253 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:10:21.815588 (Thread-2): 17:10:21 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:10:21.815845 (Thread-3): 17:10:21 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:10:21.816366 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:21.816666 (Thread-4): 17:10:21 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:10:21.817016 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:21.817387 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:21.817627 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:10:21.817931 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:21.818082 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:10:21.818219 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:10:21.820529 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:10:21.820693 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:10:21.821663 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:10:21.822536 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:10:21.823636 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:10:21.824051 (Thread-1): finished collecting timing info
2021-11-26 16:10:21.836566 (Thread-2): finished collecting timing info
2021-11-26 16:10:21.844682 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:10:21.844797 (Thread-4): finished collecting timing info
2021-11-26 16:10:21.844888 (Thread-3): finished collecting timing info
2021-11-26 16:10:21.856804 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:10:21.858843 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:10:21.860064 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:10:21.860305 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:21.860509 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:10:21.860627 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:21.860717 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:10:21.860864 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:10:21.860978 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:21.861088 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:21.861270 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:10:21.861358 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:10:21.861451 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:10:21.861645 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:10:21.861754 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:10:21.864641 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.864809 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.864915 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:21.865021 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:21.865114 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:10:21.865215 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:10:21.865531 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.865649 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:21.865728 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:10:21.865954 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.866040 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:21.866114 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:10:21.869301 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:10:21.869494 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:10:21.873429 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:21.873545 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:10:21.873754 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:10:21.874967 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:21.875075 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:10:21.876274 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:21.877431 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:21.877537 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:10:21.877660 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:10:21.877753 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:10:21.877919 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.879130 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:21.879234 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.879312 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:10:21.879381 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.879467 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.880483 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:21.881657 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:21.882765 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:21.882872 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.882981 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:10:21.883077 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:10:21.883167 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:10:21.889719 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:10:21.889906 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:21.890001 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:10:21.890204 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.890801 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:10:21.890897 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:21.890992 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:21.891075 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.891148 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:10:21.891218 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.893837 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:21.894531 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:10:21.895128 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:10:21.895227 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:10:21.895302 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:21.895386 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:21.895464 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:21.896238 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:21.896336 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:10:21.896420 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:10:21.896497 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:10:21.896899 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:21.897740 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:21.897888 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:21.897979 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:10:21.898056 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:10:21.898127 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:10:21.898937 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:21.899578 (Thread-1): finished collecting timing info
2021-11-26 16:10:21.900176 (Thread-2): finished collecting timing info
2021-11-26 16:10:21.900285 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:10:21.900397 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:10:21.900485 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:10:21.900577 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:10:21.900881 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f0315ac0>]}
2021-11-26 16:10:21.901537 (Thread-4): finished collecting timing info
2021-11-26 16:10:21.901784 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e00d90a0>]}
2021-11-26 16:10:21.901904 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:10:21.902005 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:10:21.902233 (Thread-1): 17:10:21 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2021-11-26 16:10:21.902413 (Thread-2): 17:10:21 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.08s]
2021-11-26 16:10:21.902960 (Thread-3): finished collecting timing info
2021-11-26 16:10:21.903176 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e00de280>]}
2021-11-26 16:10:21.903284 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:10:21.903397 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:10:21.903487 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:10:21.903710 (Thread-4): 17:10:21 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:10:21.904009 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:10:21.904215 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f0315280>]}
2021-11-26 16:10:21.904329 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:10:21.904491 (Thread-6): 17:10:21 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:10:21.904729 (Thread-3): 17:10:21 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:10:21.904995 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:21.905111 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:10:21.905215 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:10:21.906743 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:10:21.906996 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:10:21.907119 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 16:10:21.907280 (Thread-8): 17:10:21 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:10:21.907458 (Thread-9): 17:10:21 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:10:21.907725 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:21.907829 (Thread-6): finished collecting timing info
2021-11-26 16:10:21.909744 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:21.909919 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:10:21.911415 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:10:21.911574 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 16:10:21.913146 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:10:21.914556 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:10:21.914853 (Thread-8): finished collecting timing info
2021-11-26 16:10:21.916080 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:10:21.916214 (Thread-9): finished collecting timing info
2021-11-26 16:10:21.917439 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:10:21.917608 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:21.917797 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:10:21.917898 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:10:21.918230 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:21.918336 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:10:21.918457 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:21.918574 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:10:21.918693 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:10:21.918943 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:10:21.921834 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.921993 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.922096 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:21.922178 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:21.922266 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:21.922347 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:10:21.922443 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:21.922528 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    payments.order_id,
    payments.amount

    from payments
    group by 1
    
)
select * from order_payments
  );
2021-11-26 16:10:21.922633 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:10:21.923291 (Thread-9): Postgres error: column "payments.amount" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18:     payments.amount
             ^

2021-11-26 16:10:21.923388 (Thread-9): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 16:10:21.923581 (Thread-9): finished collecting timing info
2021-11-26 16:10:21.923691 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 16:10:21.924157 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:10:21.925513 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:21.925626 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:10:21.925845 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:10:21.927127 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:21.927227 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:10:21.927319 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.928053 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:10:21.928146 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:21.928234 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.928335 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:10:21.929458 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:21.929592 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:10:21.929877 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:21.929973 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:21.930758 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:21.931421 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:10:21.931541 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:10:21.931637 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:21.931796 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:10:21.931902 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:10:21.932546 (Thread-6): finished collecting timing info
2021-11-26 16:10:21.932673 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:10:21.932788 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:21.933054 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e00e04c0>]}
2021-11-26 16:10:21.933967 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:21.934413 (Thread-6): 17:10:21 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:10:21.934517 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:10:21.934746 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:10:21.936398 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:10:21.937152 (Thread-8): finished collecting timing info
2021-11-26 16:10:21.937270 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:10:21.937510 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f02dd0d0>]}
2021-11-26 16:10:21.923935 (Thread-9): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  column "payments.amount" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 18:     payments.amount
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.GroupingError: column "payments.amount" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18:     payments.amount
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  column "payments.amount" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 18:     payments.amount
               ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:10:21.937917 (Thread-8): 17:10:21 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:10:21.938055 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5c3aef3-2045-4655-948a-d1e7d32632b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e00f9550>]}
2021-11-26 16:10:21.938179 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:10:21.938361 (Thread-9): 17:10:21 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.03s]
2021-11-26 16:10:21.938533 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:10:21.939379 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:10:21.939502 (MainThread): Using postgres connection "master".
2021-11-26 16:10:21.939587 (MainThread): On master: BEGIN
2021-11-26 16:10:21.939673 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:10:21.948273 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:10:21.948511 (MainThread): On master: COMMIT
2021-11-26 16:10:21.948608 (MainThread): Using postgres connection "master".
2021-11-26 16:10:21.948694 (MainThread): On master: COMMIT
2021-11-26 16:10:21.950126 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:21.950302 (MainThread): On master: Close
2021-11-26 16:10:21.950609 (MainThread): 17:10:21 | 
2021-11-26 16:10:21.950730 (MainThread): 17:10:21 | Finished running 3 table models, 4 view models in 0.28s.
2021-11-26 16:10:21.950826 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:10:21.950907 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:10:21.950986 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:10:21.951061 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:10:21.951136 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:10:21.951211 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:10:21.951287 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:10:21.951363 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:10:21.955059 (MainThread): 
2021-11-26 16:10:21.955249 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 16:10:21.955350 (MainThread): 
2021-11-26 16:10:21.955444 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 16:10:21.955532 (MainThread):   column "payments.amount" must appear in the GROUP BY clause or be used in an aggregate function
2021-11-26 16:10:21.955614 (MainThread):   LINE 18:     payments.amount
2021-11-26 16:10:21.955694 (MainThread):                ^
2021-11-26 16:10:21.955774 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:10:21.955870 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 16:10:21.956043 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f05aa8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902e86af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc900fa7880>]}
2021-11-26 16:10:21.956222 (MainThread): Flushing usage events
2021-11-26 16:10:50.610644 (MainThread): Running with dbt=0.21.0
2021-11-26 16:10:50.676331 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:10:50.678182 (MainThread): Tracking: tracking
2021-11-26 16:10:50.705778 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8582927070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8582935430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8582907790>]}
2021-11-26 16:10:50.714339 (MainThread): Partial parsing not enabled
2021-11-26 16:10:50.724213 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:10:50.726805 (MainThread): Parsing macros/relations.sql
2021-11-26 16:10:50.727828 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:10:50.745061 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:10:50.746295 (MainThread): Parsing macros/core.sql
2021-11-26 16:10:50.748853 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:10:50.753724 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:10:50.760513 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:10:50.761647 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:10:50.773904 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:10:50.800355 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:10:50.817156 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:10:50.818344 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:10:50.826007 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:10:50.841412 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:10:50.851911 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:10:50.857889 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:10:50.863430 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:10:50.866056 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:10:50.867043 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:10:50.867687 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:10:50.868739 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:10:50.874830 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:10:50.876029 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:10:50.877679 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:10:50.878734 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:10:50.919894 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:10:50.921011 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:10:50.921777 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:10:50.922657 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:10:51.036981 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:51.044869 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:51.046629 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:51.048273 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:51.050476 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:51.053509 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:51.056126 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:51.086108 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8582b14b80>]}
2021-11-26 16:10:51.089910 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8582abce50>]}
2021-11-26 16:10:51.090088 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:10:51.091089 (MainThread): 
2021-11-26 16:10:51.091287 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:10:51.092199 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:10:51.098699 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:10:51.098850 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:10:51.098941 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:10:51.147862 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 16:10:51.149589 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:10:51.150722 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:10:51.155196 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:10:51.155323 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:10:51.155430 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:10:51.160513 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:10:51.160635 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:10:51.160732 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:10:51.167245 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:10:51.168195 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:10:51.168565 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:10:51.172062 (MainThread): Using postgres connection "master".
2021-11-26 16:10:51.172192 (MainThread): On master: BEGIN
2021-11-26 16:10:51.172302 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:10:51.177709 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:10:51.177843 (MainThread): Using postgres connection "master".
2021-11-26 16:10:51.177942 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:10:51.239329 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:10:51.240581 (MainThread): On master: ROLLBACK
2021-11-26 16:10:51.240955 (MainThread): Using postgres connection "master".
2021-11-26 16:10:51.241086 (MainThread): On master: BEGIN
2021-11-26 16:10:51.241595 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:51.241733 (MainThread): On master: COMMIT
2021-11-26 16:10:51.241862 (MainThread): Using postgres connection "master".
2021-11-26 16:10:51.241975 (MainThread): On master: COMMIT
2021-11-26 16:10:51.242449 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.242593 (MainThread): On master: Close
2021-11-26 16:10:51.242869 (MainThread): 17:10:51 | Concurrency: 10 threads (target='dev')
2021-11-26 16:10:51.243035 (MainThread): 17:10:51 | 
2021-11-26 16:10:51.247211 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:10:51.247490 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:10:51.247710 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:10:51.248000 (Thread-1): 17:10:51 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:10:51.248157 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:10:51.248396 (Thread-2): 17:10:51 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:10:51.248608 (Thread-3): 17:10:51 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:10:51.249210 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:51.249544 (Thread-4): 17:10:51 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:10:51.249922 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:51.250230 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:51.250424 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:10:51.250789 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:51.250955 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:10:51.251125 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:10:51.253757 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:10:51.253987 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:10:51.255150 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:10:51.256168 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:10:51.257394 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:10:51.257984 (Thread-2): finished collecting timing info
2021-11-26 16:10:51.258173 (Thread-3): finished collecting timing info
2021-11-26 16:10:51.258310 (Thread-1): finished collecting timing info
2021-11-26 16:10:51.264454 (Thread-4): finished collecting timing info
2021-11-26 16:10:51.281243 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:10:51.281696 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:10:51.294650 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:10:51.297152 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:10:51.297651 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:51.297777 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:51.297870 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:10:51.297967 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:51.298066 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:10:51.298161 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:51.298253 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:10:51.298336 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:10:51.298421 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:10:51.298496 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:10:51.298676 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:10:51.298866 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:10:51.303463 (Thread-3): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:10:51.303648 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:51.303746 (Thread-4): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:10:51.303829 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:51.303915 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:51.304000 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:51.304094 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:51.304178 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:51.304265 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:10:51.304348 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:10:51.304431 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:10:51.304511 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:10:51.306221 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:10:51.310473 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:51.310608 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 16:10:51.310697 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:10:51.310779 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:10:51.310865 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:10:51.312142 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:51.313310 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:51.314483 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:51.314637 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:10:51.314746 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:10:51.314832 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:10:51.314983 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.316165 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:51.316264 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.316346 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:10:51.316417 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.317604 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:51.317696 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.318822 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:51.318921 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.319013 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:10:51.320140 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:51.320240 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:10:51.324431 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:10:51.324565 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:10:51.324693 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:51.324807 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:10:51.324941 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.325029 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.325119 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.325712 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:10:51.325790 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.328839 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:10:51.329444 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:10:51.329537 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:51.332246 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:10:51.332357 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:51.332438 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:51.332512 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:10:51.332590 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:10:51.332665 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:10:51.332736 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:10:51.333235 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.333953 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:10:51.334040 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:10:51.334128 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.334209 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.335040 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:10:51.335138 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:10:51.335888 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:10:51.335984 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:10:51.336064 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:10:51.336686 (Thread-3): finished collecting timing info
2021-11-26 16:10:51.336787 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:10:51.337332 (Thread-2): finished collecting timing info
2021-11-26 16:10:51.337473 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:10:51.337590 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:10:51.337827 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8578194520>]}
2021-11-26 16:10:51.338041 (Thread-3): 17:10:51 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:10:51.338149 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:10:51.338421 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f858812c250>]}
2021-11-26 16:10:51.338611 (Thread-2): 17:10:51 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:10:51.338710 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:10:51.338916 (Thread-6): Began running node model.demo_dbt.dim_customers
2021-11-26 16:10:51.339062 (Thread-6): 17:10:51 | 5 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:10:51.339155 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:10:51.339339 (Thread-6): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:51.339955 (Thread-4): finished collecting timing info
2021-11-26 16:10:51.340099 (Thread-6): Compiling model.demo_dbt.dim_customers
2021-11-26 16:10:51.340206 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:10:51.340303 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:10:51.343293 (Thread-6): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:10:51.344277 (Thread-1): finished collecting timing info
2021-11-26 16:10:51.344505 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:10:51.344728 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8598874190>]}
2021-11-26 16:10:51.344928 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f859886fd30>]}
2021-11-26 16:10:51.345131 (Thread-4): 17:10:51 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:10:51.345236 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:10:51.345438 (Thread-1): 17:10:51 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.10s]
2021-11-26 16:10:51.345603 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:10:51.345937 (Thread-8): Began running node model.demo_dbt.fct_orders
2021-11-26 16:10:51.346087 (Thread-8): 17:10:51 | 6 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:10:51.346270 (Thread-8): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:51.346367 (Thread-6): finished collecting timing info
2021-11-26 16:10:51.346458 (Thread-8): Compiling model.demo_dbt.fct_orders
2021-11-26 16:10:51.346537 (Thread-9): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:10:51.347903 (Thread-6): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:10:51.349394 (Thread-8): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:10:51.349553 (Thread-9): 17:10:51 | 7 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:10:51.349916 (Thread-9): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:51.350032 (Thread-9): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:10:51.351476 (Thread-9): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:10:51.351641 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:51.351765 (Thread-8): finished collecting timing info
2021-11-26 16:10:51.351932 (Thread-6): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:10:51.353291 (Thread-8): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:10:51.353430 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:10:51.353527 (Thread-9): finished collecting timing info
2021-11-26 16:10:51.354924 (Thread-9): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:10:51.355119 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:51.355222 (Thread-8): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:10:51.355329 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:10:51.355507 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:51.355601 (Thread-9): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:10:51.355685 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:10:51.358323 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:51.358423 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:51.358496 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:10:51.359516 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:51.359606 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:10:51.359702 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:51.359781 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:51.359866 (Thread-8): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    payments.order_id,
    sum(payments.amount)

    from payments
    group by 1
    
)
select * from order_payments
  );
2021-11-26 16:10:51.359953 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:10:51.363355 (Thread-9): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:10:51.364634 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:51.364731 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:10:51.365007 (Thread-6): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 16:10:51.366328 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:51.366456 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:10:51.366553 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.366646 (Thread-8): SQL status: SELECT 99 in 0.01 seconds
2021-11-26 16:10:51.367326 (Thread-9): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:10:51.368628 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:51.368784 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.368877 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:51.368967 (Thread-8): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2021-11-26 16:10:51.370318 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:51.370442 (Thread-9): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:10:51.370604 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:10:51.371130 (Thread-9): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.371233 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.372414 (Thread-9): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:10:51.372661 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.374267 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:51.374409 (Thread-9): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:10:51.375266 (Thread-6): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:10:51.375368 (Thread-8): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 16:10:51.375491 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:51.375589 (Thread-6): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:10:51.375912 (Thread-9): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:10:51.376524 (Thread-9): finished collecting timing info
2021-11-26 16:10:51.376631 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.376728 (Thread-9): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:10:51.376805 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:10:51.377679 (Thread-6): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:10:51.377928 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f859886f2e0>]}
2021-11-26 16:10:51.378561 (Thread-8): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:10:51.378652 (Thread-6): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:10:51.378775 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:51.378970 (Thread-9): 17:10:51 | 7 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:10:51.379085 (Thread-8): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:10:51.379203 (Thread-9): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:10:51.379664 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.380491 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:10:51.380580 (Thread-8): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 16:10:51.381620 (Thread-6): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:10:51.382217 (Thread-6): finished collecting timing info
2021-11-26 16:10:51.382336 (Thread-6): On model.demo_dbt.dim_customers: Close
2021-11-26 16:10:51.382572 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8578194a90>]}
2021-11-26 16:10:51.382802 (Thread-6): 17:10:51 | 5 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 16:10:51.382913 (Thread-6): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:10:51.383105 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:10:51.383809 (Thread-8): finished collecting timing info
2021-11-26 16:10:51.383946 (Thread-8): On model.demo_dbt.fct_orders: Close
2021-11-26 16:10:51.384192 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c1c7e2-cb1c-4784-810a-47dde26ca482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f859886f820>]}
2021-11-26 16:10:51.384412 (Thread-8): 17:10:51 | 6 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.04s]
2021-11-26 16:10:51.384520 (Thread-8): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:10:51.385611 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:10:51.385801 (MainThread): Using postgres connection "master".
2021-11-26 16:10:51.385888 (MainThread): On master: BEGIN
2021-11-26 16:10:51.385975 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:10:51.391107 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:10:51.391219 (MainThread): On master: COMMIT
2021-11-26 16:10:51.391302 (MainThread): Using postgres connection "master".
2021-11-26 16:10:51.391380 (MainThread): On master: COMMIT
2021-11-26 16:10:51.391712 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:10:51.391807 (MainThread): On master: Close
2021-11-26 16:10:51.392039 (MainThread): 17:10:51 | 
2021-11-26 16:10:51.392146 (MainThread): 17:10:51 | Finished running 4 view models, 3 table models in 0.30s.
2021-11-26 16:10:51.392241 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:10:51.392319 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:10:51.392396 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:10:51.392470 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:10:51.392543 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:10:51.392617 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:10:51.392691 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:10:51.392763 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:10:51.395785 (MainThread): 
2021-11-26 16:10:51.395909 (MainThread): Completed successfully
2021-11-26 16:10:51.396016 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 16:10:51.396162 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8582af27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85829e2ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8582935430>]}
2021-11-26 16:10:51.396312 (MainThread): Flushing usage events
2021-11-26 16:13:06.074412 (MainThread): Running with dbt=0.21.0
2021-11-26 16:13:06.138970 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:13:06.140796 (MainThread): Tracking: tracking
2021-11-26 16:13:06.167853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe962cc7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe962cd6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe962ca8c10>]}
2021-11-26 16:13:06.176692 (MainThread): Partial parsing not enabled
2021-11-26 16:13:06.186651 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:13:06.189217 (MainThread): Parsing macros/relations.sql
2021-11-26 16:13:06.190293 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:13:06.207101 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:13:06.208272 (MainThread): Parsing macros/core.sql
2021-11-26 16:13:06.210813 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:13:06.215718 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:13:06.222562 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:13:06.223706 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:13:06.235784 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:13:06.263210 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:13:06.280688 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:13:06.281936 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:13:06.289457 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:13:06.305017 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:13:06.315645 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:13:06.321740 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:13:06.327350 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:13:06.329976 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:13:06.330949 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:13:06.331568 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:13:06.332594 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:13:06.338752 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:13:06.339921 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:13:06.341538 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:13:06.342571 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:13:06.385202 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:13:06.386338 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:13:06.387096 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:13:06.387969 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:13:06.501165 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:06.508970 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:06.510676 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:06.512328 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:06.514553 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:06.516743 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:06.519280 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:06.550090 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe94010cc10>]}
2021-11-26 16:13:06.554425 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9400b7550>]}
2021-11-26 16:13:06.554696 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:13:06.555793 (MainThread): 
2021-11-26 16:13:06.556032 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:13:06.557037 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:13:06.563589 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:13:06.563745 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:13:06.563841 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:13:06.613036 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 16:13:06.614633 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:13:06.615645 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:13:06.620150 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:13:06.620287 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:13:06.620399 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:13:06.625221 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:06.625346 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:13:06.625445 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:13:06.631817 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:13:06.632737 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:13:06.633037 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:13:06.636573 (MainThread): Using postgres connection "master".
2021-11-26 16:13:06.636704 (MainThread): On master: BEGIN
2021-11-26 16:13:06.636817 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:13:06.641667 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:06.641785 (MainThread): Using postgres connection "master".
2021-11-26 16:13:06.641880 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:13:06.702832 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:13:06.704044 (MainThread): On master: ROLLBACK
2021-11-26 16:13:06.704588 (MainThread): Using postgres connection "master".
2021-11-26 16:13:06.704724 (MainThread): On master: BEGIN
2021-11-26 16:13:06.705400 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:06.705542 (MainThread): On master: COMMIT
2021-11-26 16:13:06.705667 (MainThread): Using postgres connection "master".
2021-11-26 16:13:06.705784 (MainThread): On master: COMMIT
2021-11-26 16:13:06.706215 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:06.706354 (MainThread): On master: Close
2021-11-26 16:13:06.706634 (MainThread): 17:13:06 | Concurrency: 10 threads (target='dev')
2021-11-26 16:13:06.706799 (MainThread): 17:13:06 | 
2021-11-26 16:13:06.710069 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:13:06.710316 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:13:06.710512 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:13:06.710666 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:13:06.710941 (Thread-1): 17:13:06 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:13:06.711217 (Thread-2): 17:13:06 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:13:06.711481 (Thread-3): 17:13:06 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:13:06.711716 (Thread-4): 17:13:06 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:13:06.712220 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:06.712613 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:06.712932 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:06.713182 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:06.713367 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:13:06.713506 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:13:06.713632 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:13:06.713805 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:13:06.716248 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:13:06.717459 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:13:06.718622 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:13:06.719795 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:13:06.720472 (Thread-2): finished collecting timing info
2021-11-26 16:13:06.720646 (Thread-1): finished collecting timing info
2021-11-26 16:13:06.720771 (Thread-3): finished collecting timing info
2021-11-26 16:13:06.720877 (Thread-4): finished collecting timing info
2021-11-26 16:13:06.756664 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:13:06.756793 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:13:06.758819 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:13:06.759960 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:13:06.760433 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:06.760560 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:06.760643 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:13:06.760757 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:06.760865 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:06.760964 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:13:06.761157 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:13:06.761243 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:13:06.761324 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:13:06.761412 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:13:06.761587 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:13:06.761675 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:13:06.767640 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:13:06.767798 (Thread-4): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:13:06.767901 (Thread-2): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:13:06.768010 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:06.768099 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:06.768181 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:06.768263 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:13:06.768378 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:13:06.768476 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:13:06.768571 (Thread-3): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:13:06.768739 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:06.768826 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:13:06.771306 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:13:06.775531 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:06.775659 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:13:06.775753 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:13:06.775841 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:13:06.775925 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:13:06.777317 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:06.778608 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:06.779795 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:06.779929 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:13:06.780023 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:13:06.780105 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:13:06.780248 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.781489 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:06.781591 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.781673 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:13:06.781743 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.781831 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.782920 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:06.784153 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:06.784256 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.785373 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:06.785475 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:13:06.785563 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:13:06.792071 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:13:06.792157 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:13:06.792301 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:06.792419 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:13:06.792581 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.792679 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.792763 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.793339 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:13:06.793421 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:06.793975 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:13:06.794519 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:13:06.794617 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:06.797290 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:06.797393 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:06.797476 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:06.797553 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:13:06.797636 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:13:06.797720 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:13:06.797794 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:13:06.798076 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:06.798169 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:06.798257 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:06.799106 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:06.799913 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:06.800007 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:13:06.800769 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:06.800871 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:13:06.800957 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:13:06.801569 (Thread-1): finished collecting timing info
2021-11-26 16:13:06.801671 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:13:06.801823 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:13:06.802121 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe970696c70>]}
2021-11-26 16:13:06.802354 (Thread-1): 17:13:06 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 16:13:06.802478 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:13:06.802614 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:13:06.802795 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:13:06.802878 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:13:06.803546 (Thread-2): finished collecting timing info
2021-11-26 16:13:06.803656 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:13:06.804259 (Thread-3): finished collecting timing info
2021-11-26 16:13:06.804839 (Thread-4): finished collecting timing info
2021-11-26 16:13:06.804963 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:13:06.805115 (Thread-6): 17:13:06 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:13:06.805225 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:13:06.805327 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:13:06.805574 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:06.805826 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe97068d400>]}
2021-11-26 16:13:06.806006 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe962e24670>]}
2021-11-26 16:13:06.806263 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe950182d00>]}
2021-11-26 16:13:06.806372 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:13:06.806733 (Thread-2): 17:13:06 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:13:06.806976 (Thread-3): 17:13:06 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:13:06.807180 (Thread-4): 17:13:06 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:13:06.809022 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:13:06.809224 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:13:06.809355 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:13:06.809484 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:13:06.809871 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:13:06.810093 (Thread-8): 17:13:06 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:13:06.810202 (Thread-10): Began running node model.demo_dbt.fct_orders
2021-11-26 16:13:06.810308 (Thread-6): finished collecting timing info
2021-11-26 16:13:06.810548 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:06.810676 (Thread-10): 17:13:06 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:13:06.812971 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:13:06.813083 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:13:06.813332 (Thread-10): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:06.814932 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:13:06.815049 (Thread-10): Compiling model.demo_dbt.fct_orders
2021-11-26 16:13:06.816712 (Thread-10): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:13:06.816931 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:06.817210 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:13:06.817311 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:13:06.817413 (Thread-8): finished collecting timing info
2021-11-26 16:13:06.819179 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:13:06.819388 (Thread-10): finished collecting timing info
2021-11-26 16:13:06.820803 (Thread-10): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:13:06.821100 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:06.821219 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:06.821310 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:06.821393 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:13:06.821472 (Thread-10): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:13:06.821551 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:06.821629 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:13:06.821705 (Thread-10): Opening a new connection, currently in state init
2021-11-26 16:13:06.821778 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:13:06.823319 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:13:06.824930 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:06.825057 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:13:06.825361 (Thread-10): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:06.825478 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:06.825574 (Thread-10): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:06.825653 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.825737 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:06.825820 (Thread-10): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    payments.order_id,
    sum(payments.amount) as amount

    from payments
    group by 1
    
)final as (
    select 
    orders.order_id,
    orders.customer_id,
    order_payments.amount

    from orders
    left join order_payments using (order_id)
)
select * from order_payments
  );
2021-11-26 16:13:06.826467 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:13:06.826562 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:13:06.826683 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:06.826797 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:13:06.826906 (Thread-10): Postgres error: syntax error at or near "final"
LINE 23: )final as (
          ^

2021-11-26 16:13:06.827011 (Thread-10): On model.demo_dbt.fct_orders: ROLLBACK
2021-11-26 16:13:06.827166 (Thread-10): finished collecting timing info
2021-11-26 16:13:06.827277 (Thread-10): On model.demo_dbt.fct_orders: Close
2021-11-26 16:13:06.827362 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:06.828346 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:06.828452 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:13:06.828970 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:13:06.829615 (Thread-6): finished collecting timing info
2021-11-26 16:13:06.829725 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:13:06.829818 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:13:06.830173 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9706d4ee0>]}
2021-11-26 16:13:06.831536 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:06.831839 (Thread-6): 17:13:06 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 16:13:06.831978 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:13:06.832243 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:13:06.832728 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.834222 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:06.834440 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:13:06.835072 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:06.835837 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:13:06.835925 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:06.836015 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:13:06.836438 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:06.837454 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:06.837555 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:13:06.838631 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:13:06.839259 (Thread-8): finished collecting timing info
2021-11-26 16:13:06.839371 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:13:06.839603 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9400837f0>]}
2021-11-26 16:13:06.839886 (Thread-8): 17:13:06 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:13:06.840062 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:13:06.828658 (Thread-10): Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "final"
  LINE 23: )final as (
            ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "final"
LINE 23: )final as (
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fct_orders (models/Marts/fct_orders.sql)
  syntax error at or near "final"
  LINE 23: )final as (
            ^
  compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:13:06.840619 (Thread-10): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21002d64-96d7-4544-8813-f62121c234e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9706d47c0>]}
2021-11-26 16:13:06.840794 (Thread-10): 17:13:06 | 7 of 7 ERROR creating table model public.fct_orders.................. [ERROR in 0.03s]
2021-11-26 16:13:06.840892 (Thread-10): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:13:06.841745 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:13:06.841874 (MainThread): Using postgres connection "master".
2021-11-26 16:13:06.841956 (MainThread): On master: BEGIN
2021-11-26 16:13:06.842035 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:13:06.845029 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:06.845134 (MainThread): On master: COMMIT
2021-11-26 16:13:06.845214 (MainThread): Using postgres connection "master".
2021-11-26 16:13:06.845288 (MainThread): On master: COMMIT
2021-11-26 16:13:06.845624 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:06.845707 (MainThread): On master: Close
2021-11-26 16:13:06.845914 (MainThread): 17:13:06 | 
2021-11-26 16:13:06.846024 (MainThread): 17:13:06 | Finished running 3 table models, 4 view models in 0.29s.
2021-11-26 16:13:06.846114 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:13:06.846195 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:13:06.846274 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:13:06.846349 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:13:06.846423 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:13:06.846496 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:13:06.846566 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:13:06.846635 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:13:06.849615 (MainThread): 
2021-11-26 16:13:06.849762 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 16:13:06.849862 (MainThread): 
2021-11-26 16:13:06.849959 (MainThread): Database Error in model fct_orders (models/Marts/fct_orders.sql)
2021-11-26 16:13:06.850048 (MainThread):   syntax error at or near "final"
2021-11-26 16:13:06.850131 (MainThread):   LINE 23: )final as (
2021-11-26 16:13:06.850211 (MainThread):             ^
2021-11-26 16:13:06.850292 (MainThread):   compiled SQL at target/run/demo_dbt/models/Marts/fct_orders.sql
2021-11-26 16:13:06.850389 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-11-26 16:13:06.850550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9400eb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe962cd6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe960f2f880>]}
2021-11-26 16:13:06.850719 (MainThread): Flushing usage events
2021-11-26 16:13:29.140285 (MainThread): Running with dbt=0.21.0
2021-11-26 16:13:29.204323 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:13:29.205945 (MainThread): Tracking: tracking
2021-11-26 16:13:29.230466 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faae77d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faae86460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa826ca30>]}
2021-11-26 16:13:29.238995 (MainThread): Partial parsing not enabled
2021-11-26 16:13:29.248943 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:13:29.251506 (MainThread): Parsing macros/relations.sql
2021-11-26 16:13:29.252558 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:13:29.269297 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:13:29.270491 (MainThread): Parsing macros/core.sql
2021-11-26 16:13:29.273056 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:13:29.277998 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:13:29.284909 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:13:29.286047 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:13:29.298223 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:13:29.325696 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:13:29.342808 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:13:29.343991 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:13:29.351715 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:13:29.367438 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:13:29.378128 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:13:29.384262 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:13:29.389939 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:13:29.392558 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:13:29.393543 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:13:29.394165 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:13:29.395193 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:13:29.401384 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:13:29.402567 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:13:29.404214 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:13:29.405314 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:13:29.447534 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:13:29.448653 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:13:29.449421 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:13:29.450295 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:13:29.564024 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:29.571915 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:29.573615 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:29.575308 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:29.577534 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:29.579757 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:29.582315 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:29.612528 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f88567bb0>]}
2021-11-26 16:13:29.616167 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f884cec10>]}
2021-11-26 16:13:29.616342 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:13:29.617315 (MainThread): 
2021-11-26 16:13:29.617514 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:13:29.618403 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:13:29.624722 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:13:29.624883 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:13:29.624975 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:13:29.668768 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 16:13:29.670304 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:13:29.671513 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:13:29.675605 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:13:29.675722 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:13:29.675818 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:13:29.681238 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:13:29.681356 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:13:29.681448 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:13:29.688036 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:13:29.688907 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:13:29.689212 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:13:29.692452 (MainThread): Using postgres connection "master".
2021-11-26 16:13:29.692575 (MainThread): On master: BEGIN
2021-11-26 16:13:29.692680 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:13:29.697902 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:13:29.698018 (MainThread): Using postgres connection "master".
2021-11-26 16:13:29.698116 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:13:29.764859 (MainThread): SQL status: SELECT 4 in 0.07 seconds
2021-11-26 16:13:29.766257 (MainThread): On master: ROLLBACK
2021-11-26 16:13:29.766691 (MainThread): Using postgres connection "master".
2021-11-26 16:13:29.766836 (MainThread): On master: BEGIN
2021-11-26 16:13:29.767452 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.767595 (MainThread): On master: COMMIT
2021-11-26 16:13:29.767721 (MainThread): Using postgres connection "master".
2021-11-26 16:13:29.767838 (MainThread): On master: COMMIT
2021-11-26 16:13:29.768162 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.768298 (MainThread): On master: Close
2021-11-26 16:13:29.768620 (MainThread): 17:13:29 | Concurrency: 10 threads (target='dev')
2021-11-26 16:13:29.768791 (MainThread): 17:13:29 | 
2021-11-26 16:13:29.771777 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:13:29.771974 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:13:29.772244 (Thread-1): 17:13:29 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:13:29.772384 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:13:29.772545 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:13:29.772742 (Thread-2): 17:13:29 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:13:29.773086 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:29.773290 (Thread-3): 17:13:29 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:13:29.773507 (Thread-4): 17:13:29 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:13:29.773835 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:29.774012 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:13:29.774305 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:29.774546 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:29.774671 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:13:29.776983 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:13:29.777164 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:13:29.777302 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:13:29.778366 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:13:29.779475 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:13:29.780572 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:13:29.780942 (Thread-1): finished collecting timing info
2021-11-26 16:13:29.793998 (Thread-2): finished collecting timing info
2021-11-26 16:13:29.794168 (Thread-4): finished collecting timing info
2021-11-26 16:13:29.794291 (Thread-3): finished collecting timing info
2021-11-26 16:13:29.803368 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:13:29.818133 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:13:29.816010 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:13:29.819469 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:13:29.819986 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:29.820108 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:29.820193 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:13:29.820281 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:29.820362 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:29.820446 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:13:29.820534 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:13:29.820614 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:13:29.820691 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:13:29.820771 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:13:29.820951 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:13:29.821040 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:13:29.824534 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.824695 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.824789 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.824873 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:29.824946 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.825039 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:29.825132 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:29.825217 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:13:29.825301 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:29.825380 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:13:29.825462 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:13:29.825567 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:13:29.827005 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:13:29.831209 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:29.831371 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-11-26 16:13:29.831484 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:13:29.831569 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:13:29.832987 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:29.833076 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:13:29.834331 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:29.834446 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.834534 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:13:29.835748 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:29.835848 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:13:29.836973 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:29.837103 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:13:29.837223 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:13:29.837410 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.837511 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.838658 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:29.838752 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.839921 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:29.840006 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.840103 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:13:29.844341 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:13:29.844455 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:13:29.845538 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:29.845680 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:29.845795 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:13:29.845887 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:13:29.846137 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.846754 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:13:29.846860 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.846947 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.847027 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:29.847095 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.850303 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:13:29.850887 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:13:29.850985 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:13:29.853535 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:13:29.853644 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:29.853729 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:29.853842 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:13:29.853926 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:13:29.854007 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:13:29.854131 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.855080 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:13:29.855196 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:13:29.855278 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.855354 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.855434 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:13:29.856076 (Thread-4): finished collecting timing info
2021-11-26 16:13:29.856889 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:13:29.857683 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:13:29.857821 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:13:29.857913 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:13:29.857993 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:13:29.858254 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faafd93a0>]}
2021-11-26 16:13:29.858564 (Thread-4): 17:13:29 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.08s]
2021-11-26 16:13:29.858721 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:13:29.858859 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:13:29.858950 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:13:29.859593 (Thread-3): finished collecting timing info
2021-11-26 16:13:29.860277 (Thread-2): finished collecting timing info
2021-11-26 16:13:29.860391 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:13:29.860497 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:13:29.860596 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:13:29.861139 (Thread-1): finished collecting timing info
2021-11-26 16:13:29.861365 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8853b1c0>]}
2021-11-26 16:13:29.861546 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f88594ac0>]}
2021-11-26 16:13:29.861646 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:13:29.861885 (Thread-3): 17:13:29 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:13:29.862097 (Thread-2): 17:13:29 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:13:29.862289 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f88594670>]}
2021-11-26 16:13:29.862402 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:13:29.862539 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:13:29.862760 (Thread-1): 17:13:29 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 16:13:29.863051 (Thread-6): Began running node model.demo_dbt.fct_orders
2021-11-26 16:13:29.863252 (Thread-6): 17:13:29 | 5 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:13:29.863350 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:13:29.863445 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:13:29.863715 (Thread-6): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:29.863899 (Thread-8): 17:13:29 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:13:29.864045 (Thread-10): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:13:29.864147 (Thread-6): Compiling model.demo_dbt.fct_orders
2021-11-26 16:13:29.864351 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:29.864507 (Thread-10): 17:13:29 | 7 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:13:29.866463 (Thread-6): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:13:29.866720 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:13:29.866980 (Thread-10): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:29.869636 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:13:29.869762 (Thread-10): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:13:29.870989 (Thread-10): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:13:29.871202 (Thread-6): finished collecting timing info
2021-11-26 16:13:29.872401 (Thread-6): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:13:29.872544 (Thread-8): finished collecting timing info
2021-11-26 16:13:29.873678 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:13:29.873813 (Thread-10): finished collecting timing info
2021-11-26 16:13:29.874834 (Thread-10): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:13:29.875044 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:29.875169 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:29.875255 (Thread-6): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:13:29.875356 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:13:29.875457 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:13:29.875553 (Thread-10): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:29.875632 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:13:29.875800 (Thread-10): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:13:29.875944 (Thread-10): Opening a new connection, currently in state init
2021-11-26 16:13:29.879510 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.879639 (Thread-10): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.879732 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:29.879805 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.879892 (Thread-10): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:29.879976 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:13:29.880060 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:29.880138 (Thread-10): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:13:29.880247 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    payments.order_id,
    sum(payments.amount) as amount

    from payments
    group by 1
    
),

final as (
    select 
    orders.order_id,
    orders.customer_id,
    order_payments.amount

    from orders
    left join order_payments using (order_id)
)
select * from order_payments
  );
2021-11-26 16:13:29.882613 (Thread-6): SQL status: SELECT 99 in 0.00 seconds
2021-11-26 16:13:29.882840 (Thread-10): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:13:29.884625 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:29.884838 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:13:29.886205 (Thread-10): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:29.886321 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2021-11-26 16:13:29.887540 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:29.887645 (Thread-10): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:13:29.887760 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:13:29.888184 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.888276 (Thread-10): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.888358 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.889398 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:29.890058 (Thread-10): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:13:29.891041 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:29.891135 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 16:13:29.891221 (Thread-10): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:29.891296 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:13:29.891399 (Thread-10): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:13:29.892086 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.892167 (Thread-10): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.892770 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:13:29.892848 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:13:29.893646 (Thread-10): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:13:29.893744 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:29.894328 (Thread-6): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:13:29.894419 (Thread-10): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:13:29.894501 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:13:29.894580 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:29.894701 (Thread-6): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:13:29.895054 (Thread-10): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:13:29.895623 (Thread-10): finished collecting timing info
2021-11-26 16:13:29.895736 (Thread-10): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:13:29.895829 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.896628 (Thread-6): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:13:29.896720 (Thread-6): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 16:13:29.896816 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.897030 (Thread-10): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9faafa1040>]}
2021-11-26 16:13:29.897754 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:13:29.898020 (Thread-10): 17:13:29 | 7 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2021-11-26 16:13:29.898114 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:13:29.898259 (Thread-10): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:13:29.899212 (Thread-6): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:13:29.900022 (Thread-6): finished collecting timing info
2021-11-26 16:13:29.900146 (Thread-6): On model.demo_dbt.fct_orders: Close
2021-11-26 16:13:29.900390 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8853b1c0>]}
2021-11-26 16:13:29.900595 (Thread-6): 17:13:29 | 5 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.04s]
2021-11-26 16:13:29.900699 (Thread-6): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:13:29.900894 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:13:29.901500 (Thread-8): finished collecting timing info
2021-11-26 16:13:29.901608 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:13:29.901801 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc44673-1fe9-402a-baf6-2c8f9bc9ec3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9810c820>]}
2021-11-26 16:13:29.901978 (Thread-8): 17:13:29 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 16:13:29.902077 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:13:29.903022 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:13:29.903163 (MainThread): Using postgres connection "master".
2021-11-26 16:13:29.903243 (MainThread): On master: BEGIN
2021-11-26 16:13:29.903325 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:13:29.906743 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:13:29.906863 (MainThread): On master: COMMIT
2021-11-26 16:13:29.906947 (MainThread): Using postgres connection "master".
2021-11-26 16:13:29.907026 (MainThread): On master: COMMIT
2021-11-26 16:13:29.907263 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:13:29.907351 (MainThread): On master: Close
2021-11-26 16:13:29.907572 (MainThread): 17:13:29 | 
2021-11-26 16:13:29.907678 (MainThread): 17:13:29 | Finished running 4 view models, 3 table models in 0.29s.
2021-11-26 16:13:29.907770 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:13:29.907852 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:13:29.907931 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:13:29.908006 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:13:29.908082 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:13:29.908160 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:13:29.908235 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:13:29.908309 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:13:29.911387 (MainThread): 
2021-11-26 16:13:29.911516 (MainThread): Completed successfully
2021-11-26 16:13:29.911628 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 16:13:29.911780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa826c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f88538e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f88567d60>]}
2021-11-26 16:13:29.911933 (MainThread): Flushing usage events
2021-11-26 16:14:12.269988 (MainThread): Running with dbt=0.21.0
2021-11-26 16:14:12.335966 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:14:12.337869 (MainThread): Tracking: tracking
2021-11-26 16:14:12.366657 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e293ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e294e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e2920790>]}
2021-11-26 16:14:12.375333 (MainThread): Partial parsing not enabled
2021-11-26 16:14:12.385557 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:14:12.388320 (MainThread): Parsing macros/relations.sql
2021-11-26 16:14:12.389416 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:14:12.407065 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:14:12.408272 (MainThread): Parsing macros/core.sql
2021-11-26 16:14:12.410881 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:14:12.415978 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:14:12.423137 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:14:12.424325 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:14:12.436791 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:14:12.467155 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:14:12.484973 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:14:12.486179 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:14:12.494163 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:14:12.510719 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:14:12.521929 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:14:12.528554 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:14:12.534570 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:14:12.537247 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:14:12.538244 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:14:12.538866 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:14:12.539911 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:14:12.546277 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:14:12.547472 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:14:12.549112 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:14:12.550165 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:14:12.595156 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:14:12.596291 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:14:12.597055 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:14:12.597944 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:14:12.712336 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:14:12.720118 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:14:12.721805 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:14:12.723431 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:14:12.725638 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:14:12.727819 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:14:12.730353 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:14:12.761003 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f0ae9b80>]}
2021-11-26 16:14:12.765181 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f0a8b190>]}
2021-11-26 16:14:12.765362 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:14:12.766358 (MainThread): 
2021-11-26 16:14:12.766561 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:14:12.767499 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:14:12.774248 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:14:12.774423 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:14:12.774524 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:14:12.819957 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2021-11-26 16:14:12.821547 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:14:12.822594 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:14:12.827072 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:14:12.827203 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:14:12.827315 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:14:12.832426 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:14:12.832542 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:14:12.832633 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:14:12.839664 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:14:12.840608 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:14:12.840932 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:14:12.844427 (MainThread): Using postgres connection "master".
2021-11-26 16:14:12.844558 (MainThread): On master: BEGIN
2021-11-26 16:14:12.844669 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:14:12.849697 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:14:12.849846 (MainThread): Using postgres connection "master".
2021-11-26 16:14:12.849944 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:14:12.916316 (MainThread): SQL status: SELECT 4 in 0.07 seconds
2021-11-26 16:14:12.917563 (MainThread): On master: ROLLBACK
2021-11-26 16:14:12.918131 (MainThread): Using postgres connection "master".
2021-11-26 16:14:12.918267 (MainThread): On master: BEGIN
2021-11-26 16:14:12.918907 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:14:12.919053 (MainThread): On master: COMMIT
2021-11-26 16:14:12.919180 (MainThread): Using postgres connection "master".
2021-11-26 16:14:12.919295 (MainThread): On master: COMMIT
2021-11-26 16:14:12.919946 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:12.920085 (MainThread): On master: Close
2021-11-26 16:14:12.920371 (MainThread): 17:14:12 | Concurrency: 10 threads (target='dev')
2021-11-26 16:14:12.920542 (MainThread): 17:14:12 | 
2021-11-26 16:14:12.923888 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:14:12.924125 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:14:12.924296 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:14:12.924556 (Thread-1): 17:14:12 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:14:12.924698 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:14:12.924947 (Thread-2): 17:14:12 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:14:12.925178 (Thread-3): 17:14:12 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:14:12.925568 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:14:12.925842 (Thread-4): 17:14:12 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:14:12.926241 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:14:12.926538 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:14:12.926774 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:14:12.926982 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:14:12.927241 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:14:12.927396 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:14:12.929938 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:14:12.931040 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:14:12.931195 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:14:12.932195 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:14:12.933414 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:14:12.933813 (Thread-2): finished collecting timing info
2021-11-26 16:14:12.939965 (Thread-1): finished collecting timing info
2021-11-26 16:14:12.954942 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:14:12.961422 (Thread-4): finished collecting timing info
2021-11-26 16:14:12.967905 (Thread-3): finished collecting timing info
2021-11-26 16:14:12.969200 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:14:12.970652 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:14:12.972758 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:14:12.973112 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:14:12.973332 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:14:12.973446 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:14:12.973552 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:14:12.973661 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:14:12.973762 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:14:12.973841 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:14:12.973930 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:14:12.974107 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:14:12.974196 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:14:12.974280 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:14:12.974364 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:14:12.979962 (Thread-4): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:14:12.980213 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:14:12.980378 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:14:12.980520 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:14:12.980612 (Thread-3): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:14:12.980735 (Thread-2): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:14:12.980835 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:14:12.980937 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:14:12.981033 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:14:12.981121 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:14:12.981258 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:14:12.981352 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:14:12.983642 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:14:12.988035 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:14:12.988166 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:14:12.988268 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:14:12.988364 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:14:12.988460 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:14:12.989756 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:14:12.991167 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:14:12.991279 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:12.992543 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:14:12.992653 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:14:12.992744 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:14:12.993927 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:14:12.994031 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:14:12.994175 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:14:12.994450 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:12.995573 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:14:12.995668 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:12.995746 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:14:12.995816 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:12.995903 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:12.996928 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:14:12.998102 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:14:12.998199 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:13.004888 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:14:13.004982 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:14:13.005068 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:14:13.005644 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:14:13.005738 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:14:13.005870 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:14:13.005954 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:14:13.006031 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:14:13.006203 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:13.006759 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:14:13.006857 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:13.006949 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:14:13.007024 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:13.007110 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:13.007635 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:14:13.007721 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:14:13.010353 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:14:13.011203 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:14:13.011300 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:14:13.011408 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:14:13.011491 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:14:13.011576 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:14:13.011662 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:13.012601 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:14:13.012720 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:14:13.012821 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:13.012918 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:14:13.013002 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:14:13.013876 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:14:13.013990 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:14:13.014688 (Thread-2): finished collecting timing info
2021-11-26 16:14:13.015309 (Thread-1): finished collecting timing info
2021-11-26 16:14:13.015425 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:14:13.016004 (Thread-3): finished collecting timing info
2021-11-26 16:14:13.016127 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:14:13.016220 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:14:13.016334 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:14:13.016619 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d0172f10>]}
2021-11-26 16:14:13.016880 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0007e190>]}
2021-11-26 16:14:13.017269 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e299b4c0>]}
2021-11-26 16:14:13.017368 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:14:13.017633 (Thread-2): 17:14:13 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:14:13.017793 (Thread-1): 17:14:13 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2021-11-26 16:14:13.017985 (Thread-3): 17:14:13 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:14:13.018589 (Thread-4): finished collecting timing info
2021-11-26 16:14:13.018723 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:14:13.018819 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:14:13.018920 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:14:13.019017 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:14:13.019412 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:14:13.019534 (Thread-7): Began running node model.demo_dbt.dim_customers
2021-11-26 16:14:13.019752 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e299bd30>]}
2021-11-26 16:14:13.019901 (Thread-6): 17:14:13 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:14:13.020042 (Thread-7): 17:14:13 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:14:13.020258 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:14:13.020487 (Thread-4): 17:14:13 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:14:13.020588 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:14:13.020762 (Thread-7): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:14:13.020893 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:14:13.022361 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:14:13.022498 (Thread-7): Compiling model.demo_dbt.dim_customers
2021-11-26 16:14:13.024966 (Thread-7): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:14:13.025190 (Thread-9): Began running node model.demo_dbt.fct_orders
2021-11-26 16:14:13.025385 (Thread-9): 17:14:13 | 7 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:14:13.025678 (Thread-9): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:14:13.025814 (Thread-9): Compiling model.demo_dbt.fct_orders
2021-11-26 16:14:13.025920 (Thread-7): finished collecting timing info
2021-11-26 16:14:13.026018 (Thread-6): finished collecting timing info
2021-11-26 16:14:13.028456 (Thread-9): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:14:13.029654 (Thread-7): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:14:13.030676 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:14:13.031007 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:14:13.031107 (Thread-9): finished collecting timing info
2021-11-26 16:14:13.031200 (Thread-7): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:14:13.031298 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:14:13.032371 (Thread-9): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:14:13.032467 (Thread-7): Opening a new connection, currently in state init
2021-11-26 16:14:13.032555 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:14:13.032764 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:14:13.032974 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:14:13.033056 (Thread-9): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:14:13.033137 (Thread-9): Opening a new connection, currently in state init
2021-11-26 16:14:13.037851 (Thread-7): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:14:13.037963 (Thread-9): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:14:13.038039 (Thread-6): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:14:13.038115 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:14:13.038197 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:14:13.038275 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:14:13.038353 (Thread-7): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:14:13.038433 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    payments.order_id,
    sum(payments.amount) as amount

    from payments
    group by 1
    
),

final as (
    select 
    orders.order_id,
    orders.customer_id,
    order_payments.amount

    from orders
    left join order_payments using (order_id)
)
select * from final
  );
2021-11-26 16:14:13.038512 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:14:13.042529 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:14:13.044428 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:14:13.044559 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:14:13.045075 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:13.045854 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:14:13.045962 (Thread-9): SQL status: SELECT 99 in 0.01 seconds
2021-11-26 16:14:13.046066 (Thread-7): SQL status: SELECT 100 in 0.01 seconds
2021-11-26 16:14:13.046170 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:14:13.047442 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:14:13.048708 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:14:13.048815 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:14:13.048902 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2021-11-26 16:14:13.048985 (Thread-7): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:14:13.049486 (Thread-7): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:13.049583 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:13.050673 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:14:13.050762 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:13.051891 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:14:13.051987 (Thread-7): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:14:13.052777 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:14:13.052881 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 16:14:13.053007 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:14:13.053328 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:14:13.053987 (Thread-6): finished collecting timing info
2021-11-26 16:14:13.054101 (Thread-9): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:13.054181 (Thread-7): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:14:13.054279 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:14:13.054927 (Thread-9): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:14:13.055653 (Thread-7): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:14:13.055807 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:14:13.056063 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d01618b0>]}
2021-11-26 16:14:13.056230 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:14:13.056358 (Thread-9): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:14:13.056504 (Thread-7): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:14:13.056759 (Thread-6): 17:14:13 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.04s]
2021-11-26 16:14:13.056963 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:14:13.057457 (Thread-9): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:13.057560 (Thread-7): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:13.058729 (Thread-9): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:14:13.059574 (Thread-7): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:14:13.059685 (Thread-9): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 16:14:13.059773 (Thread-7): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:14:13.062272 (Thread-9): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:14:13.062938 (Thread-9): finished collecting timing info
2021-11-26 16:14:13.063053 (Thread-9): On model.demo_dbt.fct_orders: Close
2021-11-26 16:14:13.063138 (Thread-7): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:14:13.063717 (Thread-7): finished collecting timing info
2021-11-26 16:14:13.063941 (Thread-9): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f0a032b0>]}
2021-11-26 16:14:13.064035 (Thread-7): On model.demo_dbt.dim_customers: Close
2021-11-26 16:14:13.064277 (Thread-9): 17:14:13 | 7 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.04s]
2021-11-26 16:14:13.064452 (Thread-7): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9220204-cfc1-4bd6-b8b1-512e9a50dd4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f0c88310>]}
2021-11-26 16:14:13.064557 (Thread-9): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:14:13.064781 (Thread-7): 17:14:13 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.04s]
2021-11-26 16:14:13.064961 (Thread-7): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:14:13.065746 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:14:13.065862 (MainThread): Using postgres connection "master".
2021-11-26 16:14:13.065945 (MainThread): On master: BEGIN
2021-11-26 16:14:13.066029 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:14:13.070716 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:14:13.070822 (MainThread): On master: COMMIT
2021-11-26 16:14:13.070901 (MainThread): Using postgres connection "master".
2021-11-26 16:14:13.070977 (MainThread): On master: COMMIT
2021-11-26 16:14:13.071213 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:14:13.071332 (MainThread): On master: Close
2021-11-26 16:14:13.071587 (MainThread): 17:14:13 | 
2021-11-26 16:14:13.071703 (MainThread): 17:14:13 | Finished running 4 view models, 3 table models in 0.31s.
2021-11-26 16:14:13.071805 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:14:13.071889 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:14:13.071970 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:14:13.072050 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:14:13.072132 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:14:13.072211 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:14:13.072290 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:14:13.072372 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:14:13.075969 (MainThread): 
2021-11-26 16:14:13.076129 (MainThread): Completed successfully
2021-11-26 16:14:13.076240 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 16:14:13.076401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f0ac27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e2920790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f0aa46d0>]}
2021-11-26 16:14:13.076560 (MainThread): Flushing usage events
2021-11-26 16:16:43.933109 (MainThread): Running with dbt=0.21.0
2021-11-26 16:16:43.997971 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:16:43.999173 (MainThread): Tracking: tracking
2021-11-26 16:16:44.025046 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcab9f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcabaeaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb85a0c10>]}
2021-11-26 16:16:44.033154 (MainThread): Partial parsing not enabled
2021-11-26 16:16:44.042399 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:16:44.044910 (MainThread): Parsing macros/relations.sql
2021-11-26 16:16:44.045981 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:16:44.063326 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:16:44.064533 (MainThread): Parsing macros/core.sql
2021-11-26 16:16:44.067147 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:16:44.072180 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:16:44.079282 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:16:44.080473 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:16:44.092936 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:16:44.121103 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:16:44.138696 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:16:44.139903 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:16:44.147651 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:16:44.163769 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:16:44.174743 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:16:44.180960 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:16:44.186648 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:16:44.189300 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:16:44.190293 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:16:44.190921 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:16:44.191962 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:16:44.198309 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:16:44.199510 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:16:44.201203 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:16:44.202266 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:16:44.245982 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:16:44.247122 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:16:44.247887 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:16:44.248771 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:16:44.362199 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:44.369915 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:44.371622 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:44.373285 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:44.375500 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:44.377646 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:44.380118 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:44.410043 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad75a9e3-2b31-4f67-a355-fc3765edbd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcad4cc10>]}
2021-11-26 16:16:44.413589 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad75a9e3-2b31-4f67-a355-fc3765edbd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcad03550>]}
2021-11-26 16:16:44.413764 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:16:44.414696 (MainThread): 
2021-11-26 16:16:44.414893 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:16:44.415788 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:16:44.422609 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:16:44.422788 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:16:44.422882 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:16:44.463029 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.04 seconds
2021-11-26 16:16:44.464632 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:16:44.465661 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:16:44.469919 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:16:44.470060 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:16:44.470164 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:16:44.475419 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-11-26 16:16:44.475538 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:16:44.475629 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:16:44.482856 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:16:44.483799 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:16:44.484116 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:16:44.487698 (MainThread): Using postgres connection "master".
2021-11-26 16:16:44.487833 (MainThread): On master: BEGIN
2021-11-26 16:16:44.487948 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:16:44.492537 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.492661 (MainThread): Using postgres connection "master".
2021-11-26 16:16:44.492754 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:16:44.557091 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:16:44.558379 (MainThread): On master: ROLLBACK
2021-11-26 16:16:44.558794 (MainThread): Using postgres connection "master".
2021-11-26 16:16:44.558931 (MainThread): On master: BEGIN
2021-11-26 16:16:44.559657 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.559804 (MainThread): On master: COMMIT
2021-11-26 16:16:44.559930 (MainThread): Using postgres connection "master".
2021-11-26 16:16:44.560052 (MainThread): On master: COMMIT
2021-11-26 16:16:44.560377 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:44.560521 (MainThread): On master: Close
2021-11-26 16:16:44.560816 (MainThread): 17:16:44 | Concurrency: 10 threads (target='dev')
2021-11-26 16:16:44.560984 (MainThread): 17:16:44 | 
2021-11-26 16:16:44.564689 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:16:44.564986 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:16:44.565287 (Thread-1): 17:16:44 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:16:44.565465 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:16:44.565682 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:16:44.565901 (Thread-2): 17:16:44 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:16:44.566255 (Thread-3): 17:16:44 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:16:44.566719 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:44.567011 (Thread-4): 17:16:44 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:16:44.567449 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:44.567830 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:44.568028 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:16:44.568310 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:44.568453 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:16:44.568583 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:16:44.571145 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:16:44.571363 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:16:44.572475 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:16:44.573476 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:16:44.574717 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:16:44.575125 (Thread-1): finished collecting timing info
2021-11-26 16:16:44.575331 (Thread-2): finished collecting timing info
2021-11-26 16:16:44.575543 (Thread-3): finished collecting timing info
2021-11-26 16:16:44.608848 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:16:44.608997 (Thread-4): finished collecting timing info
2021-11-26 16:16:44.609844 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:16:44.611903 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:16:44.613215 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:16:44.613581 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:44.613689 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:16:44.613797 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:16:44.613917 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:44.614123 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:44.614215 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:16:44.614309 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:16:44.614395 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:44.614478 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:16:44.614557 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:16:44.614636 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:16:44.614903 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:16:44.617323 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.617451 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:44.617534 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:16:44.618450 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.618706 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:44.618803 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:16:44.618961 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.619094 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.619240 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:44.619435 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:16:44.619530 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:44.619622 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    payment_method,
    amount / 100 as amount,
    status

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:16:44.623683 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:44.623808 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:16:44.623917 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:16:44.624054 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:16:44.625348 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:44.625477 (Thread-4): Postgres error: column "status" does not exist
LINE 10:     status
             ^

2021-11-26 16:16:44.625614 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:16:44.625723 (Thread-4): On model.demo_dbt.stg_payments: ROLLBACK
2021-11-26 16:16:44.625853 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:44.625980 (Thread-4): finished collecting timing info
2021-11-26 16:16:44.627170 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:44.627275 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:44.627383 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:16:44.627463 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:16:44.627554 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:16:44.628710 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:44.629910 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:44.630368 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:16:44.630468 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:16:44.630680 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:44.637064 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 16:16:44.637175 (Thread-3): SQL status: ALTER TABLE in 0.01 seconds
2021-11-26 16:16:44.637347 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:16:44.638699 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:44.639290 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:16:44.639401 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:44.639489 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:16:44.639622 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:44.639701 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:16:44.639860 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:16:44.640141 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:44.640264 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:44.640346 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:44.640946 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:16:44.643670 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:44.644477 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:44.644580 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:44.644681 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:16:44.644774 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:16:44.644867 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:16:44.645212 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:44.646121 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:44.646223 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:16:44.646313 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:16:44.646981 (Thread-3): finished collecting timing info
2021-11-26 16:16:44.647119 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:16:44.647262 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:16:44.647874 (Thread-1): finished collecting timing info
2021-11-26 16:16:44.648038 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:16:44.648314 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad75a9e3-2b31-4f67-a355-fc3765edbd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcacde640>]}
2021-11-26 16:16:44.648464 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:16:44.649088 (Thread-2): finished collecting timing info
2021-11-26 16:16:44.649368 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad75a9e3-2b31-4f67-a355-fc3765edbd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcacdefa0>]}
2021-11-26 16:16:44.649625 (Thread-3): 17:16:44 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.08s]
2021-11-26 16:16:44.649720 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:16:44.649933 (Thread-1): 17:16:44 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2021-11-26 16:16:44.650071 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:16:44.650298 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad75a9e3-2b31-4f67-a355-fc3765edbd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcacdeb80>]}
2021-11-26 16:16:44.650427 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:16:44.650921 (Thread-2): 17:16:44 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.08s]
2021-11-26 16:16:44.651042 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:16:44.651209 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:16:44.651378 (Thread-6): 17:16:44 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:16:44.651701 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:44.651867 (Thread-8): Began running node model.demo_dbt.dim_customers
2021-11-26 16:16:44.630097 (Thread-4): Database Error in model stg_payments (models/Staging/stg_payments.sql)
  column "status" does not exist
  LINE 10:     status
               ^
  compiled SQL at target/run/demo_dbt/models/Staging/stg_payments.sql
Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "status" does not exist
LINE 10:     status
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/pedbadiee/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_payments (models/Staging/stg_payments.sql)
  column "status" does not exist
  LINE 10:     status
               ^
  compiled SQL at target/run/demo_dbt/models/Staging/stg_payments.sql
2021-11-26 16:16:44.652097 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:16:44.652243 (Thread-8): 17:16:44 | 6 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:16:44.652405 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad75a9e3-2b31-4f67-a355-fc3765edbd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcade0a00>]}
2021-11-26 16:16:44.653873 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:16:44.654107 (Thread-8): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:44.654309 (Thread-4): 17:16:44 | 4 of 7 ERROR creating view model public.stg_payments................. [ERROR in 0.08s]
2021-11-26 16:16:44.654439 (Thread-8): Compiling model.demo_dbt.dim_customers
2021-11-26 16:16:44.655914 (Thread-8): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:16:44.656037 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:16:44.656192 (Thread-6): finished collecting timing info
2021-11-26 16:16:44.657663 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:16:44.657845 (Thread-10): Began running node model.demo_dbt.fct_orders
2021-11-26 16:16:44.657971 (Thread-8): finished collecting timing info
2021-11-26 16:16:44.658078 (Thread-10): 17:16:44 | 7 of 7 SKIP relation public.fct_orders............................... [SKIP]
2021-11-26 16:16:44.659281 (Thread-8): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:16:44.659470 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:44.659576 (Thread-10): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:16:44.659740 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:16:44.659945 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:16:44.660058 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:44.660241 (Thread-8): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:16:44.660324 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:16:44.663390 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.663539 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.663639 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:44.663730 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:44.663813 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:16:44.663900 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:16:44.665631 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:16:44.668065 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:44.668196 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:16:44.668296 (Thread-8): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:16:44.669577 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:44.669792 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:44.669894 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:16:44.670582 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:16:44.670734 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:44.670823 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:16:44.671052 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:44.672336 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:44.672464 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:44.672560 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:16:44.673468 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:44.673624 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:16:44.673877 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:16:44.674742 (Thread-6): finished collecting timing info
2021-11-26 16:16:44.674877 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:44.675005 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:16:44.675759 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:16:44.675884 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:44.675965 (Thread-8): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:16:44.676189 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad75a9e3-2b31-4f67-a355-fc3765edbd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcace4df0>]}
2021-11-26 16:16:44.676466 (Thread-6): 17:16:44 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 16:16:44.676560 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:44.676668 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:16:44.677613 (Thread-8): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:44.677794 (Thread-8): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:16:44.678820 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:16:44.679490 (Thread-8): finished collecting timing info
2021-11-26 16:16:44.679602 (Thread-8): On model.demo_dbt.dim_customers: Close
2021-11-26 16:16:44.679819 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad75a9e3-2b31-4f67-a355-fc3765edbd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab982742b0>]}
2021-11-26 16:16:44.680025 (Thread-8): 17:16:44 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:16:44.680137 (Thread-8): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:16:44.680916 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:16:44.681035 (MainThread): Using postgres connection "master".
2021-11-26 16:16:44.681117 (MainThread): On master: BEGIN
2021-11-26 16:16:44.681202 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:16:44.684015 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:44.684159 (MainThread): On master: COMMIT
2021-11-26 16:16:44.684245 (MainThread): Using postgres connection "master".
2021-11-26 16:16:44.684326 (MainThread): On master: COMMIT
2021-11-26 16:16:44.685519 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:44.685685 (MainThread): On master: Close
2021-11-26 16:16:44.685993 (MainThread): 17:16:44 | 
2021-11-26 16:16:44.686113 (MainThread): 17:16:44 | Finished running 4 view models, 3 table models in 0.27s.
2021-11-26 16:16:44.686211 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:16:44.686292 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:16:44.686370 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:16:44.686448 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:16:44.686524 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:16:44.686599 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:16:44.686673 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:16:44.689836 (MainThread): 
2021-11-26 16:16:44.689968 (MainThread): Completed with 1 error and 0 warnings:
2021-11-26 16:16:44.690065 (MainThread): 
2021-11-26 16:16:44.690160 (MainThread): Database Error in model stg_payments (models/Staging/stg_payments.sql)
2021-11-26 16:16:44.690249 (MainThread):   column "status" does not exist
2021-11-26 16:16:44.690330 (MainThread):   LINE 10:     status
2021-11-26 16:16:44.690412 (MainThread):                ^
2021-11-26 16:16:44.690493 (MainThread):   compiled SQL at target/run/demo_dbt/models/Staging/stg_payments.sql
2021-11-26 16:16:44.690593 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
2021-11-26 16:16:44.690741 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcad2c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcabaeaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc8f47880>]}
2021-11-26 16:16:44.690896 (MainThread): Flushing usage events
2021-11-26 16:16:56.109947 (MainThread): Running with dbt=0.21.0
2021-11-26 16:16:56.162880 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/pedbadiee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 16:16:56.163795 (MainThread): Tracking: tracking
2021-11-26 16:16:56.185869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34b0275e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34b037ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34b008be0>]}
2021-11-26 16:16:56.194235 (MainThread): Partial parsing not enabled
2021-11-26 16:16:56.201735 (MainThread): Parsing macros/catalog.sql
2021-11-26 16:16:56.204101 (MainThread): Parsing macros/relations.sql
2021-11-26 16:16:56.205144 (MainThread): Parsing macros/adapters.sql
2021-11-26 16:16:56.221853 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-11-26 16:16:56.223020 (MainThread): Parsing macros/core.sql
2021-11-26 16:16:56.225556 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 16:16:56.230464 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 16:16:56.237287 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 16:16:56.238419 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 16:16:56.250650 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 16:16:56.277750 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 16:16:56.294761 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 16:16:56.295948 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 16:16:56.303433 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 16:16:56.318922 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 16:16:56.329508 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 16:16:56.335505 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 16:16:56.341063 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 16:16:56.343673 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 16:16:56.344652 (MainThread): Parsing macros/etc/query.sql
2021-11-26 16:16:56.345273 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 16:16:56.346295 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 16:16:56.352442 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 16:16:56.353619 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 16:16:56.355228 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 16:16:56.356264 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 16:16:56.398540 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 16:16:56.399654 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 16:16:56.400407 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 16:16:56.401274 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 16:16:56.513907 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:56.521725 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:56.523436 (MainThread): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:56.525095 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:56.527380 (MainThread): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:56.529591 (MainThread): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:56.532163 (MainThread): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:56.562520 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32834dbe0>]}
2021-11-26 16:16:56.566113 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3282f6640>]}
2021-11-26 16:16:56.566291 (MainThread): Found 7 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-26 16:16:56.567370 (MainThread): 
2021-11-26 16:16:56.567593 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:16:56.568450 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_demo_dbt".
2021-11-26 16:16:56.575010 (ThreadPoolExecutor-0_0): Using postgres connection "list_demo_dbt".
2021-11-26 16:16:56.575191 (ThreadPoolExecutor-0_0): On list_demo_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt"} */

    select distinct nspname from pg_namespace
  
2021-11-26 16:16:56.575289 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 16:16:56.584351 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.01 seconds
2021-11-26 16:16:56.586041 (ThreadPoolExecutor-0_0): On list_demo_dbt: Close
2021-11-26 16:16:56.587231 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_demo_dbt_public".
2021-11-26 16:16:56.591163 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:16:56.591300 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: BEGIN
2021-11-26 16:16:56.591388 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-11-26 16:16:56.595799 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.595902 (ThreadPoolExecutor-1_0): Using postgres connection "list_demo_dbt_public".
2021-11-26 16:16:56.595982 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "list_demo_dbt_public"} */
select
      'demo_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-11-26 16:16:56.603661 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2021-11-26 16:16:56.604687 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: ROLLBACK
2021-11-26 16:16:56.605019 (ThreadPoolExecutor-1_0): On list_demo_dbt_public: Close
2021-11-26 16:16:56.608420 (MainThread): Using postgres connection "master".
2021-11-26 16:16:56.608554 (MainThread): On master: BEGIN
2021-11-26 16:16:56.608662 (MainThread): Opening a new connection, currently in state init
2021-11-26 16:16:56.613247 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.613378 (MainThread): Using postgres connection "master".
2021-11-26 16:16:56.613469 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-11-26 16:16:56.673729 (MainThread): SQL status: SELECT 4 in 0.06 seconds
2021-11-26 16:16:56.674990 (MainThread): On master: ROLLBACK
2021-11-26 16:16:56.675423 (MainThread): Using postgres connection "master".
2021-11-26 16:16:56.675561 (MainThread): On master: BEGIN
2021-11-26 16:16:56.676201 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.676344 (MainThread): On master: COMMIT
2021-11-26 16:16:56.676469 (MainThread): Using postgres connection "master".
2021-11-26 16:16:56.676588 (MainThread): On master: COMMIT
2021-11-26 16:16:56.676958 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.677100 (MainThread): On master: Close
2021-11-26 16:16:56.677402 (MainThread): 17:16:56 | Concurrency: 10 threads (target='dev')
2021-11-26 16:16:56.677567 (MainThread): 17:16:56 | 
2021-11-26 16:16:56.680383 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:16:56.680628 (Thread-2): Began running node model.demo_dbt.stg_customers
2021-11-26 16:16:56.680831 (Thread-3): Began running node model.demo_dbt.stg_orders
2021-11-26 16:16:56.681107 (Thread-1): 17:16:56 | 1 of 7 START table model public.my_first_dbt_model................... [RUN]
2021-11-26 16:16:56.681247 (Thread-4): Began running node model.demo_dbt.stg_payments
2021-11-26 16:16:56.681524 (Thread-2): 17:16:56 | 2 of 7 START view model public.stg_customers......................... [RUN]
2021-11-26 16:16:56.681741 (Thread-3): 17:16:56 | 3 of 7 START view model public.stg_orders............................ [RUN]
2021-11-26 16:16:56.681986 (Thread-4): 17:16:56 | 4 of 7 START view model public.stg_payments.......................... [RUN]
2021-11-26 16:16:56.682313 (Thread-1): Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:56.682682 (Thread-2): Acquiring new postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:56.682985 (Thread-3): Acquiring new postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:56.683352 (Thread-4): Acquiring new postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:56.683603 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-11-26 16:16:56.683761 (Thread-2): Compiling model.demo_dbt.stg_customers
2021-11-26 16:16:56.683897 (Thread-3): Compiling model.demo_dbt.stg_orders
2021-11-26 16:16:56.684025 (Thread-4): Compiling model.demo_dbt.stg_payments
2021-11-26 16:16:56.686287 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:16:56.687321 (Thread-2): Writing injected SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:16:56.688242 (Thread-3): Writing injected SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:16:56.689228 (Thread-4): Writing injected SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:16:56.690060 (Thread-3): finished collecting timing info
2021-11-26 16:16:56.696225 (Thread-2): finished collecting timing info
2021-11-26 16:16:56.696434 (Thread-4): finished collecting timing info
2021-11-26 16:16:56.696575 (Thread-1): finished collecting timing info
2021-11-26 16:16:56.712057 (Thread-2): Writing runtime SQL for node "model.demo_dbt.stg_customers"
2021-11-26 16:16:56.713310 (Thread-3): Writing runtime SQL for node "model.demo_dbt.stg_orders"
2021-11-26 16:16:56.714923 (Thread-4): Writing runtime SQL for node "model.demo_dbt.stg_payments"
2021-11-26 16:16:56.729660 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-11-26 16:16:56.730145 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:56.730257 (Thread-2): On model.demo_dbt.stg_customers: BEGIN
2021-11-26 16:16:56.730362 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:56.730466 (Thread-2): Opening a new connection, currently in state init
2021-11-26 16:16:56.730574 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:56.730682 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:56.730762 (Thread-3): On model.demo_dbt.stg_orders: BEGIN
2021-11-26 16:16:56.730939 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-11-26 16:16:56.731021 (Thread-4): On model.demo_dbt.stg_payments: BEGIN
2021-11-26 16:16:56.731117 (Thread-3): Opening a new connection, currently in state init
2021-11-26 16:16:56.731216 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 16:16:56.731300 (Thread-4): Opening a new connection, currently in state init
2021-11-26 16:16:56.734212 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.734373 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.734472 (Thread-4): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.734561 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:56.734640 (Thread-3): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.734730 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:56.734821 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:56.734906 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */

  create view "demo_dbt"."public"."stg_customers__dbt_tmp" as (
    with customers as (
	select
	id as customer_id,
	first_name,
	last_name
	from raw.raw_customers
)

select * from customers
  );

2021-11-26 16:16:56.734991 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:56.735070 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


  create  table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-11-26 16:16:56.735152 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */

  create view "demo_dbt"."public"."stg_payments__dbt_tmp" as (
    with payments as (
    select 
    id as payment_id,
    order_id,
    payment_method,
    amount / 100 as amount

    from raw.raw_payments
)

select * from payments
  );

2021-11-26 16:16:56.735265 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */

  create view "demo_dbt"."public"."stg_orders__dbt_tmp" as (
    with orders as (
	select 
	id as order_id,
	user_id as customer_id,
	order_date,
	status
	
	from raw.raw_orders
)

select * from orders
  );

2021-11-26 16:16:56.736850 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-11-26 16:16:56.740905 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:56.741023 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:16:56.741115 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:16:56.741201 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2021-11-26 16:16:56.741281 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-11-26 16:16:56.742544 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:56.743754 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:56.744873 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:56.745010 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-11-26 16:16:56.745118 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2021-11-26 16:16:56.745228 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-11-26 16:16:56.745334 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.746633 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:56.746737 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.746824 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "demo_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-11-26 16:16:56.746897 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.746983 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.748149 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:56.749328 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:56.749430 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.750479 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:56.750580 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
alter table "demo_dbt"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-11-26 16:16:56.750664 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
alter table "demo_dbt"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-11-26 16:16:56.757131 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:16:56.757235 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
alter table "demo_dbt"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-11-26 16:16:56.757384 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:56.757517 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-11-26 16:16:56.757704 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.757817 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.758421 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:16:56.758509 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.758594 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.759173 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:16:56.759265 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:56.759832 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:16:56.762519 (Thread-1): Using postgres connection "model.demo_dbt.my_first_dbt_model".
2021-11-26 16:16:56.762622 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:56.762707 (Thread-3): On model.demo_dbt.stg_orders: COMMIT
2021-11-26 16:16:56.762788 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:56.762865 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "demo_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
2021-11-26 16:16:56.762943 (Thread-2): On model.demo_dbt.stg_customers: COMMIT
2021-11-26 16:16:56.763052 (Thread-4): On model.demo_dbt.stg_payments: COMMIT
2021-11-26 16:16:56.763264 (Thread-3): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.764040 (Thread-3): Using postgres connection "model.demo_dbt.stg_orders".
2021-11-26 16:16:56.764139 (Thread-3): On model.demo_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_orders"} */
drop view if exists "demo_dbt"."public"."stg_orders__dbt_backup" cascade
2021-11-26 16:16:56.764315 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:16:56.764919 (Thread-1): finished collecting timing info
2021-11-26 16:16:56.765038 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-11-26 16:16:56.765143 (Thread-4): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.765383 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3180298e0>]}
2021-11-26 16:16:56.766158 (Thread-4): Using postgres connection "model.demo_dbt.stg_payments".
2021-11-26 16:16:56.766248 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.766352 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:16:56.766595 (Thread-1): 17:16:56 | 1 of 7 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2021-11-26 16:16:56.766670 (Thread-4): On model.demo_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_payments"} */
drop view if exists "demo_dbt"."public"."stg_payments__dbt_backup" cascade
2021-11-26 16:16:56.767483 (Thread-2): Using postgres connection "model.demo_dbt.stg_customers".
2021-11-26 16:16:56.768062 (Thread-3): finished collecting timing info
2021-11-26 16:16:56.768215 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-11-26 16:16:56.768333 (Thread-2): On model.demo_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.stg_customers"} */
drop view if exists "demo_dbt"."public"."stg_customers__dbt_backup" cascade
2021-11-26 16:16:56.768440 (Thread-3): On model.demo_dbt.stg_orders: Close
2021-11-26 16:16:56.768717 (Thread-6): Began running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:16:56.768954 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff318029610>]}
2021-11-26 16:16:56.769101 (Thread-6): 17:16:56 | 5 of 7 START view model public.my_second_dbt_model................... [RUN]
2021-11-26 16:16:56.769207 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:16:56.769443 (Thread-3): 17:16:56 | 3 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.09s]
2021-11-26 16:16:56.769635 (Thread-6): Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:56.769712 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:16:56.770383 (Thread-4): finished collecting timing info
2021-11-26 16:16:56.770544 (Thread-6): Compiling model.demo_dbt.my_second_dbt_model
2021-11-26 16:16:56.770631 (Thread-3): Finished running node model.demo_dbt.stg_orders
2021-11-26 16:16:56.771210 (Thread-2): finished collecting timing info
2021-11-26 16:16:56.771333 (Thread-4): On model.demo_dbt.stg_payments: Close
2021-11-26 16:16:56.772798 (Thread-6): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:16:56.772976 (Thread-2): On model.demo_dbt.stg_customers: Close
2021-11-26 16:16:56.773287 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33816a0d0>]}
2021-11-26 16:16:56.773525 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33815ca00>]}
2021-11-26 16:16:56.773763 (Thread-4): 17:16:56 | 4 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-11-26 16:16:56.773867 (Thread-6): finished collecting timing info
2021-11-26 16:16:56.774061 (Thread-2): 17:16:56 | 2 of 7 OK created view model public.stg_customers.................... [CREATE VIEW in 0.09s]
2021-11-26 16:16:56.774180 (Thread-4): Finished running node model.demo_dbt.stg_payments
2021-11-26 16:16:56.776436 (Thread-6): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-11-26 16:16:56.776789 (Thread-2): Finished running node model.demo_dbt.stg_customers
2021-11-26 16:16:56.776925 (Thread-8): Began running node model.demo_dbt.fct_orders
2021-11-26 16:16:56.777164 (Thread-8): 17:16:56 | 6 of 7 START table model public.fct_orders........................... [RUN]
2021-11-26 16:16:56.777382 (Thread-8): Acquiring new postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:56.777502 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:56.777640 (Thread-8): Compiling model.demo_dbt.fct_orders
2021-11-26 16:16:56.777735 (Thread-10): Began running node model.demo_dbt.dim_customers
2021-11-26 16:16:56.777832 (Thread-6): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-11-26 16:16:56.779360 (Thread-8): Writing injected SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:16:56.779510 (Thread-10): 17:16:56 | 7 of 7 START table model public.dim_customers........................ [RUN]
2021-11-26 16:16:56.779609 (Thread-6): Opening a new connection, currently in state init
2021-11-26 16:16:56.779834 (Thread-10): Acquiring new postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:56.780042 (Thread-10): Compiling model.demo_dbt.dim_customers
2021-11-26 16:16:56.780138 (Thread-8): finished collecting timing info
2021-11-26 16:16:56.781726 (Thread-10): Writing injected SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:16:56.782955 (Thread-8): Writing runtime SQL for node "model.demo_dbt.fct_orders"
2021-11-26 16:16:56.783291 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:56.783396 (Thread-10): finished collecting timing info
2021-11-26 16:16:56.783508 (Thread-6): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.783594 (Thread-8): On model.demo_dbt.fct_orders: BEGIN
2021-11-26 16:16:56.784808 (Thread-10): Writing runtime SQL for node "model.demo_dbt.dim_customers"
2021-11-26 16:16:56.784923 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:56.785013 (Thread-8): Opening a new connection, currently in state init
2021-11-26 16:16:56.785140 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "demo_dbt"."public"."my_first_dbt_model"
where id = 1
  );

2021-11-26 16:16:56.785434 (Thread-10): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:56.785521 (Thread-10): On model.demo_dbt.dim_customers: BEGIN
2021-11-26 16:16:56.785604 (Thread-10): Opening a new connection, currently in state init
2021-11-26 16:16:56.787331 (Thread-6): SQL status: CREATE VIEW in 0.00 seconds
2021-11-26 16:16:56.788696 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:56.788800 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "demo_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-11-26 16:16:56.789081 (Thread-8): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.789283 (Thread-10): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.789373 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:56.789465 (Thread-6): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.789587 (Thread-10): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:56.789679 (Thread-8): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */


  create  table "demo_dbt"."public"."fct_orders__dbt_tmp"
  as (
    with orders as(
    select * from "demo_dbt"."public"."stg_orders"

),

payments as (
    select * from "demo_dbt"."public"."stg_payments"
),

order_payments as (
    select
    payments.order_id,
    sum(payments.amount) as amount

    from payments
    group by 1
    
),

final as (
    select 
    orders.order_id,
    orders.customer_id,
    order_payments.amount

    from orders
    left join order_payments using (order_id)
)
select * from final
  );
2021-11-26 16:16:56.790290 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:16:56.790388 (Thread-10): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */


  create  table "demo_dbt"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select * from "demo_dbt"."public"."stg_customers"
),

orders as (
    select * from "demo_dbt"."public"."stg_orders"
),


customer_orders as (
	
	select 
	customer_id,
	min(order_date) as first_order_date,
	max(order_date) as most_recent_order_date,
	count(order_id) as number_of_orders
	
	from orders
	group by 1
),

final as (
	
	select
	customers.customer_id,
	customers.first_name,
	customers.last_name,
	customer_orders.first_order_date,
	customer_orders.most_recent_order_date,
	coalesce(customer_orders.number_of_orders,0) as number_of_orders

	
	from customers
	left join customer_orders using (customer_id )
)
select * from final
  );
2021-11-26 16:16:56.790512 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:56.790620 (Thread-6): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-11-26 16:16:56.790876 (Thread-6): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.791668 (Thread-6): Using postgres connection "model.demo_dbt.my_second_dbt_model".
2021-11-26 16:16:56.791768 (Thread-6): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "demo_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
2021-11-26 16:16:56.791987 (Thread-6): SQL status: DROP VIEW in 0.00 seconds
2021-11-26 16:16:56.792660 (Thread-6): finished collecting timing info
2021-11-26 16:16:56.792783 (Thread-6): On model.demo_dbt.my_second_dbt_model: Close
2021-11-26 16:16:56.793033 (Thread-6): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34b206070>]}
2021-11-26 16:16:56.793134 (Thread-8): SQL status: SELECT 99 in 0.00 seconds
2021-11-26 16:16:56.794574 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:56.794682 (Thread-8): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2021-11-26 16:16:56.794897 (Thread-6): 17:16:56 | 5 of 7 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2021-11-26 16:16:56.794980 (Thread-10): SQL status: SELECT 100 in 0.00 seconds
2021-11-26 16:16:56.795129 (Thread-6): Finished running node model.demo_dbt.my_second_dbt_model
2021-11-26 16:16:56.796391 (Thread-10): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:56.796525 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.796669 (Thread-10): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2021-11-26 16:16:56.797770 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:56.797899 (Thread-8): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
alter table "demo_dbt"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-11-26 16:16:56.798182 (Thread-10): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.799299 (Thread-10): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:56.799393 (Thread-10): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
alter table "demo_dbt"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-11-26 16:16:56.799479 (Thread-8): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.800122 (Thread-8): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:16:56.800210 (Thread-10): SQL status: ALTER TABLE in 0.00 seconds
2021-11-26 16:16:56.800294 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:56.800878 (Thread-10): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:16:56.800969 (Thread-8): On model.demo_dbt.fct_orders: COMMIT
2021-11-26 16:16:56.801055 (Thread-10): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:56.801160 (Thread-10): On model.demo_dbt.dim_customers: COMMIT
2021-11-26 16:16:56.801597 (Thread-8): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.801690 (Thread-10): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.802650 (Thread-8): Using postgres connection "model.demo_dbt.fct_orders".
2021-11-26 16:16:56.803746 (Thread-10): Using postgres connection "model.demo_dbt.dim_customers".
2021-11-26 16:16:56.803872 (Thread-8): On model.demo_dbt.fct_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.fct_orders"} */
drop table if exists "demo_dbt"."public"."fct_orders__dbt_backup" cascade
2021-11-26 16:16:56.803976 (Thread-10): On model.demo_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "pedram", "target_name": "dev", "node_id": "model.demo_dbt.dim_customers"} */
drop table if exists "demo_dbt"."public"."dim_customers__dbt_backup" cascade
2021-11-26 16:16:56.805037 (Thread-10): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:16:56.805134 (Thread-8): SQL status: DROP TABLE in 0.00 seconds
2021-11-26 16:16:56.805823 (Thread-10): finished collecting timing info
2021-11-26 16:16:56.806391 (Thread-8): finished collecting timing info
2021-11-26 16:16:56.806507 (Thread-10): On model.demo_dbt.dim_customers: Close
2021-11-26 16:16:56.806608 (Thread-8): On model.demo_dbt.fct_orders: Close
2021-11-26 16:16:56.806853 (Thread-10): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff33815cac0>]}
2021-11-26 16:16:56.807047 (Thread-8): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8044508c-2ab5-475c-8465-48375c4c22a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34b1f3700>]}
2021-11-26 16:16:56.807303 (Thread-10): 17:16:56 | 7 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.03s]
2021-11-26 16:16:56.807510 (Thread-8): 17:16:56 | 6 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.03s]
2021-11-26 16:16:56.807646 (Thread-10): Finished running node model.demo_dbt.dim_customers
2021-11-26 16:16:56.807749 (Thread-8): Finished running node model.demo_dbt.fct_orders
2021-11-26 16:16:56.808567 (MainThread): Acquiring new postgres connection "master".
2021-11-26 16:16:56.808686 (MainThread): Using postgres connection "master".
2021-11-26 16:16:56.808767 (MainThread): On master: BEGIN
2021-11-26 16:16:56.808849 (MainThread): Opening a new connection, currently in state closed
2021-11-26 16:16:56.811976 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-11-26 16:16:56.812093 (MainThread): On master: COMMIT
2021-11-26 16:16:56.812175 (MainThread): Using postgres connection "master".
2021-11-26 16:16:56.812251 (MainThread): On master: COMMIT
2021-11-26 16:16:56.812644 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-11-26 16:16:56.812737 (MainThread): On master: Close
2021-11-26 16:16:56.812960 (MainThread): 17:16:56 | 
2021-11-26 16:16:56.813068 (MainThread): 17:16:56 | Finished running 3 table models, 4 view models in 0.25s.
2021-11-26 16:16:56.813164 (MainThread): Connection 'master' was properly closed.
2021-11-26 16:16:56.813251 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-11-26 16:16:56.813330 (MainThread): Connection 'model.demo_dbt.stg_customers' was properly closed.
2021-11-26 16:16:56.813409 (MainThread): Connection 'model.demo_dbt.stg_orders' was properly closed.
2021-11-26 16:16:56.813484 (MainThread): Connection 'model.demo_dbt.stg_payments' was properly closed.
2021-11-26 16:16:56.813558 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-11-26 16:16:56.813630 (MainThread): Connection 'model.demo_dbt.fct_orders' was properly closed.
2021-11-26 16:16:56.813701 (MainThread): Connection 'model.demo_dbt.dim_customers' was properly closed.
2021-11-26 16:16:56.816680 (MainThread): 
2021-11-26 16:16:56.816809 (MainThread): Completed successfully
2021-11-26 16:16:56.816920 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-11-26 16:16:56.817075 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32832b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34b122b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32834dfa0>]}
2021-11-26 16:16:56.817228 (MainThread): Flushing usage events
